{"version":3,"file":"bundle.js","sources":["../node_modules/browserify/node_modules/browser-pack/_prelude.js","../lib/index.js","../lib/connectors/core/HandshakeConnector.js","../lib/WebP2P.js","../node_modules/browserify/node_modules/process/browser.js","../lib/managers/HandshakeManager.js","../lib/managers/PeersManager.js","../lib/packer.js","../lib/connectors/core/Connector.js","../node_modules/browserify/node_modules/events/events.js","../lib/managers/Manager.js","../lib/errors.js","../lib/connectors/PubNub.js","../lib/connectors/core/DataChannel.js","../node_modules/inherits/inherits_browser.js","../node_modules/freeice/index.js","../node_modules/uuid/uuid.js","../node_modules/wrtc/lib/browser.js","../node_modules/process-events-shim/lib/process-events-shim.js","../node_modules/rpc-builder/lib/index.js","../shim/pubnub.js","../node_modules/freeice/servers.js","../node_modules/uuid/rng-browser.js","../node_modules/browserify/node_modules/buffer/index.js","../node_modules/rpc-builder/lib/Mapper.js","../node_modules/rpc-builder/lib/packers/index.js","../node_modules/rpc-builder/lib/packers/JsonRPC.js","../node_modules/rpc-builder/lib/packers/XmlRPC.js","../node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","../node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js"],"names":["HandshakeConnector","require","WebP2P","module","exports","max_connections","Connector","call","this","self","undefined","Math","min","shouldConnect","connections","increaseConnections","close","inherits","prototype","Number","POSITIVE_INFINITY","noop","error","console","options","onerror","emit","Error","createPeerConnection","sessionID","callbackType","callback","pc","RTCPeerConnection","iceServers","optional","DtlsSrtpKeyAgreement","addEventListener","event","candidate","type","localDescription","sdp","signalingState","channels","_channels","peersManager","add","offer","offers","Object","defineProperty","value","forward","message","connector","dest","from","ttl","warn","pack","peer","i","_connectors","send","handshakeManager","connectionProcessed","get","log","code","MAX_TTL_DEFAULT","rpcBuilder","cancel","peerConnection","debug","onpresence","generateOffer","onoffer","request","processed","reply","answer","response","setRemoteDescription","RTCSessionDescription","createAnswer","setLocalDescription","channel","push","labels","encode","result","processAnswer","Array","forEach","c","routingLabel","concat","commonLabels","label","createDataChannel","splice","indexOf","mediaConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","createOffer","initManagerEvents","manager","on","status","handshake_servers","freeice","uuid","v4","max_retries","peerID","RpcBuilder","packer","HandshakeManager","PeersManager","__defineGetter__","peers","connectTo","Function","SyntaxError","process","EventEmitter","wrtc","nextTick","canSetImmediate","window","setImmediate","canPost","postMessage","f","queue","ev","source","data","stopPropagation","length","fn","shift","setTimeout","title","browser","env","argv","addListener","once","off","removeListener","removeAllListeners","binding","cwd","chdir","createConnector","config","config_init","config_mess","connectorConstructor","handshakeConnectorConstructors","_initConnector","_messageUnpacked","method","params","handshake","configs","index","Manager","registerConnectorConstructor","constructor","Connector_PubNub","configs_infinity","addConfigs_byObject","addConfigs","errors","configuration","addConfigs_byUri","addConfigs_byArray","json_uri","dispatchError","http_request","XMLHttpRequest","open","onload","JSON","parse","ERROR_REQUEST_EMPTY","ERROR_REQUEST_FAILURE","navigator","onLine","ERROR_NETWORK_UNKNOWN","ERROR_NETWORK_OFFLINE","Connector_DataChannel","initDataChannel","initDataChannel_listener","target","removeEventListener","_close","id","ERROR","PRESENCE","OFFER","ANSWER","stringify","unpack","ack","responseMethods","presence","_open","_message","_error","TypeError","_events","_maxListeners","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","er","handler","len","args","listeners","arguments","apply","slice","listener","m","newListener","warned","trace","g","fired","list","position","key","ret","listenerCount","emitter","decode","stored","incomingConnector","msg","ERROR_NO_PEERS","pubnub","PUBNUB","init","subscribe","restore","backfill","connect","disconnect","unsubscribe","publish","datachannel","create","ctor","superCtor","super_","enumerable","writable","configurable","TempCtor","opts","getServers","count","idx","out","input","servers","random","map","url","selected","stunCount","stun","turnCount","turn","s","buf","offset","ii","toLowerCase","replace","oct","_hexToByte","unparse","bth","_byteToHex","v1","b","clockseq","_clockseq","msecs","Date","getTime","nsecs","_lastNSecs","dt","_lastMSecs","tl","tmh","node","_nodeId","BufferClass","rnds","rng","_rng","Buffer","toString","substr","_seedBytes","RTCIceCandidate","mozRTCIceCandidate","webkitRTCIceCandidate","mozRTCPeerConnection","webkitRTCPeerConnection","mozRTCSessionDescription","webkitRTCSessionDescription","name","processLacksEventFunctions","_ref","document","global","err","line","unifyResponseMethods","checkValidTransport","transport","RpcNotification","storeResponse","timeout","responses","remove","response_timeout","set","storeProcessedResponse","processedResponses","duplicates_timeout","RpcRequest","Boolean","responseMethod","clearTimeout","message2Key","requests","pop","request_timeout","BASE_TIMEOUT","requestID","Mapper","dispatchCallback","sendRequest","pow","retried","encode_transport","retry","processRequest","idAck","processResponse","duplicatedResponse","RpcError","packers","unique","NOW","rnow","build_url","url_components","url_params","join","URLBIT","each","value_str","PARAMSBIT","updater","fun","rate","last","runnit","grep","fin","l","supplant","str","values","REPL","_","match","wait","u","r","v","isArray","o","old_logic","hasOwnProperty","k","path","encodeURIComponent","generate_channel_list","nopresence","search","subscribed","sort","ready","READY","READY_BUFFER","SECOND","PN_API","setup","validate_presence_heartbeat","heartbeat","cur_heartbeat","PRESENCE_HB_THRESHOLD","PRESENCE_HB_DEFAULT","encrypt","crypto_obj","CIPHER_KEY","decrypt","_presence_heartbeat","PRESENCE_HB_TIMEOUT","PRESENCE_HB_INTERVAL","CHANNELS","PRESENCE_HB_RUNNING","SELF","e","start_presence_heartbeat","next","NO_WAIT_FOR_PENDING","PUB_QUEUE","sending","xdr","each_channel","chan","_invoke_callback","payload","_invoke_error","_poll_online","_is_online","_reset_offline","_poll_online2","success","detect_time_detla","KEEPALIVE","SUB_RECEIVER","detect_latency","tt","adjusted_time","TIME_DRIFT","cb","time","calculate","ptime","latency","stime","SUB_WINDOWING","DEF_WINDOWING","SUB_TIMEOUT","DEF_SUB_TIMEOUT","DEF_KEEPALIVE","NOLEAVE","PUBLISH_KEY","SUBSCRIBE_KEY","AUTH_KEY","SECRET_KEY","PNSDK","hmac_SHA256","SSL","ORIGIN","STD_ORIGIN","nextorigin","SUB_ORIGIN","CONNECT","SUB_CALLBACK","SUB_CHANNEL","SUB_RESTORE","TIMETOKEN","RESUMED","STATE","PRESENCE_HB","COMPATIBLE_35","jsonp_cb","db","UUID","a","LEAVE","blocking","auth","origin","jsonp","PRESENCE_SUFFIX","fail","set_resumed","resumed","get_cipher_key","set_cipher_key","raw_encrypt","raw_decrypt","get_heartbeat","set_heartbeat","get_heartbeat_interval","set_heartbeat_interval","heartbeat_interval","get_version","SDK_VER","history","reverse","auth_key","cipher_key","start","end","include_token","messages","decrypted_messages","new_message","replay","destination","stop","limit","add_msg","split","CB_CALLED","action","_test_connection","disconnected","reconnect","_connect","st","sub_timeout","errcb","idlecb","connected","windowing","next_callback","decrypted_msg","noheresync","timetoken","state","settings","here","uid","timestamp","occupancy","here_now","uuids","where_now","grant","w","floor","sign_input","signature","audit","revoke","set_uuid","get_uuid","presence_heartbeat","each-channel","offline","now","SHA256","safe_add","x","y","lsw","msw","S","X","R","Ch","z","Maj","Sigma0256","Sigma1256","Gamma0256","Gamma1256","core_sha256","d","h","j","T1","T2","K","HASH","W","str2binb","bin","mask","chrsz","charCodeAt","Utf8Encode","string","utftext","String","fromCharCode","binb2hex","binarray","hex_tab","hexcase","charAt","crypto","CRYPTO","iv","hex_message","encryptedHexArray","base_64_encrypted","binary_enc","json_plain","plaintext","DEF_TIMEOUT","max","ori","failover","Nr","Nk","Decrypt","enc_utf8","unescape","dec_utf8","decodeURIComponent","escape","padBlock","byteArr","cpad","array","block2s","block","lastBlock","padding","a2h","numArr","h2a","parseInt","s2a","binary","size","newsize","randArr","num","openSSLKey","passwordArr","saltArr","rounds","md5_hash","data00","GibberishAES","Hash","MD5","rawEncrypt","expandKey","numBlocks","ceil","blocks","cipherBlocks","xorBlocks","encryptBlock","rawDecrypt","cryptArr","plainBlocks","decryptBlock","words","round","addRoundKey","subBytes","shiftRows","mixColumns","SBoxInv","SBox","temp","shiftBy","t","GEX","GBX","GDX","G9X","G2X","G3X","block1","block2","flat","subWord","rotWord","Rcon","tmp","strhex","invertArr","arr","Gxx","Gx","enc","pass","salt","pbe","saltBlock","Base64","dec","rotateLeft","lValue","iShiftBits","addUnsigned","lX","lY","lX4","lY4","lX8","lY8","lResult","funcI","ff","ac","gg","hh","convertToWordArray","lWordCount","lMessageLength","lNumberOfWords_temp1","lNumberOfWords_temp2","lNumberOfWords","lWordArray","lBytePosition","lByteCount","wordToHex","lByte","lCount","wordToHexArr","AA","BB","CC","DD","rnd","_chars","chars","broken_b64","flatArr","b64","xhr","finished","loaded","timer","responseText","done","complete","XHRTME","async","failed","abort","XDomainRequest","onabort","onloadend","onreadystatechange","readyState","eee","bind","el","etype","rapfun","cancelBubble","returnValue","preventDefault","attachEvent","attr","attribute","setAttribute","getAttribute","$","getElementById","elements","getElementsByTagName","css","element","styles","style","createElement","get_hmac_SHA256","hash","CryptoJS","CREATE_PUBNUB","PN","prop","ch","ls","localStorage","getItem","cookie","RegExp","setItem","WS","protocols","bits","protocol","ssl","publish_key","subscribe_key","reason","wasClean","getRandomValues","_rnds8","Uint8Array","_rnds","subject","encoding","noZero","stringtrim","coerce","byteLength","_useTypedArrays","_augment","_isBuffer","_set","isArrayish","isBuffer","readUInt8","write","hexWrite","remaining","strLen","assert","byte","utf8Write","charsWritten","blitBuffer","utf8ToBytes","asciiWrite","asciiToBytes","binaryWrite","base64Write","base64ToBytes","utf16leWrite","utf16leToBytes","base64Slice","base64","fromByteArray","utf8Slice","res","decodeUtf8Char","asciiSlice","binarySlice","hexSlice","toHex","utf16leSlice","bytes","readUInt16","littleEndian","noAssert","val","readUInt32","readInt16","neg","readInt32","readFloat","ieee754","read","readDouble","writeUInt16","verifuint","writeUInt32","writeInt16","verifsint","writeInt32","writeFloat","verifIEEE754","writeDouble","trim","clamp","defaultValue","byteArray","hi","lo","toByteArray","src","dst","test","SlowBuffer","INSPECT_MAX_BYTES","poolSize","ArrayBuffer","foo","subarray","isEncoding","totalLength","pos","item","copy","compare","isFinite","swap","toJSON","_arr","equals","target_start","sliceLen","newBuf","writeUInt8","readUInt16LE","readUInt16BE","readUInt32LE","readUInt32BE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","fill","inspect","toArrayBuffer","buffer","BP","_get","toLocaleString","sources","key2","ids","keys","JsonRPC","XmlRPC","jsonrpc","version","result_defined","error_defined","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","Infinity","rt","abs","LN2","lookup","elt","PLUS","SLASH","NUMBER","UPPER","LOWER","b64ToByteArray","L","placeHolders","Arr","uint8ToBase64","uint8","tripletToBase64","extraBytes","output"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * New node file\n */\nvar HandshakeConnector = require('./connectors/core/HandshakeConnector');\nvar WebP2P             = require('./WebP2P');\n\n\nmodule.exports = WebP2P;\nmodule.exports.HandshakeConnector = HandshakeConnector;","var inherits = require(\"inherits\");\n\nvar Connector = require(\"./Connector\");\n\n\nfunction HandshakeConnector(max_connections)\n{\n  Connector.call(this);\n\n  var self = this;\n\n\n  if(max_connections != undefined)\n    this.max_connections = Math.min(max_connections, this.max_connections);\n\n  /**\n   * Check if we should connect this new peer or ignore it to increase entropy\n   * in the network mesh\n   *\n   * @returns {Boolean}\n   */\n  this.shouldConnect = function()\n  {\n    return true;\n  };\n\n\n  // Count the maximum number of pending connections allowed to be\n  // done with this handshake server (undefined == unlimited)\n  var connections = 0;\n\n  this.increaseConnections = function()\n  {\n    // Increase the number of connections reached throught\n    // this handshake server\n    connections++;\n\n    // Close connection with handshake server if we got its quota of peers\n    if(connections >= self.max_connections)\n       self.close();\n  };\n};\ninherits(HandshakeConnector, Connector);\n\n\n// Class constants\nHandshakeConnector.prototype.max_connections = Number.POSITIVE_INFINITY;\n\n\nmodule.exports = HandshakeConnector;\n","var EventEmitter = require(\"events\").EventEmitter;\n\nvar inherits = require('inherits');\nvar freeice  = require('freeice');\nvar uuid     = require('uuid');\nvar wrtc     = require('wrtc');\n\nvar RTCPeerConnection     = wrtc.RTCPeerConnection;\nvar RTCSessionDescription = wrtc.RTCSessionDescription;\n\nrequire(\"process-events-shim\");\n\nvar RpcBuilder = require('rpc-builder');\n\nvar HandshakeManager = require('./managers/HandshakeManager');\nvar PeersManager     = require('./managers/PeersManager');\n\nvar packer = require('./packer');\n\n\nconst MAX_TTL_DEFAULT = 5;\n\n\nfunction noop(error)\n{\n  if(error) console.error(error);\n};\n\n\n\n/**\n * @classdesc Init and connect to the WebP2P.io network\n *\n * @constructor\n */\nfunction WebP2P(options)\n{\n  var self = this;\n\n\n  options = options || {};\n\n  // Internal options\n  var commonLabels      = options.commonLabels || [];\n  var handshake_servers = options.handshake_servers;\n  var iceServers        = freeice(options.iceServers);\n\n  // Read-only options\n  Object.defineProperty(this, \"routingLabel\",\n  {\n    value: options.routingLabel || \"webp2p\"\n  });\n  Object.defineProperty(this, \"sessionID\",\n  {\n    value: options.sessionID || uuid.v4()\n  });\n\n\n  var options =\n  {\n    max_retries: 3,\n    peerID: this.sessionID\n  };\n\n  var rpcBuilder = new RpcBuilder(packer, options);\n\n  var handshakeManager = new HandshakeManager(rpcBuilder, handshake_servers);\n  var peersManager     = new PeersManager(rpcBuilder, self.routingLabel);\n\n  this.__defineGetter__('status', function()\n  {\n    if(peersManager.status == 'connected')\n      return 'connected';\n\n    return handshakeManager.status;\n  });\n\n  this.__defineGetter__(\"peers\", function()\n  {\n    return peersManager.peers;\n  });\n\n\n  function onerror(error)\n  {\n    self.emit('error', new Error(error));\n  };\n\n\n  var offers = {};\n\n  /**\n   * Create a new RTCPeerConnection\n   * @param {UUID} sessionID Identifier of the other peer so later can be accessed.\n   *\n   * @return {RTCPeerConnection}\n   */\n  function createPeerConnection(sessionID, callbackType, callback)\n  {\n    var pc = new RTCPeerConnection\n    (\n      {iceServers: iceServers},\n      {optional: [{DtlsSrtpKeyAgreement: true}]}\n    );\n\n    pc.addEventListener('icecandidate', function(event)\n    {\n      // There's a candidate, ignore it\n      if(event.candidate) return;\n\n      // There's no candidate, send the full SDP\n      var type = this.localDescription.type;\n      var sdp  = this.localDescription.sdp;\n\n      if(type == callbackType)\n        callback(sdp)\n      else\n        console.error(type+\" SDP type is not equal to \"+callbackType+\" callback type\");\n    });\n\n    pc.addEventListener('signalingstatechange', function(event)\n    {\n      // Add PeerConnection object to available ones when gets open\n      if(pc.signalingState == 'stable')\n      {\n        var channels = pc._channels || [];\n\n        peersManager.add(sessionID, pc, channels);\n\n        var offer = offers[sessionID];\n        if(offer)\n        {\n          delete offers[sessionID];\n\n          offer.callback(null, pc, channels);\n        };\n\n        self.emit('peerconnection', pc, channels);\n      };\n    });\n\n    // Set ID of the PeerConnection\n    Object.defineProperty(pc, \"sessionID\", {value : sessionID});\n\n    return pc;\n  };\n\n\n  //\n  // Connection methods\n  //\n\n  /**\n   * Callback to send the offer. If not defined send it to all connected peers.\n   *\n   * @callback WebP2P~ConnectToCallback\n   * @param {Error} error\n   * @param {RTCPeerConnection} peer - The (newly created) peer\n   */\n\n  /**\n   * Connects to another peer based on its UID. If we are already connected,\n   * it does nothing.\n   *\n   * @param {UUID} sessionID - Identifier of the other peer to be connected.\n   * @param {string[]} [labels] - Per-connection labels\n   * @param {WebP2P~ConnectToCallback} callback\n   */\n  this.connectTo = function(dest, labels, callback)\n  {\n    if(labels instanceof Function)\n    {\n      if(callback)\n        throw new SyntaxError(\"Nothing can be defined after the callback\");\n\n      callback = labels;\n      labels = undefined;\n    };\n\n    // Don't connect to ourself\n    if(dest == self.sessionID)\n      return callback(new Error(\"Connecting to ourself\"));\n\n    // Check if we are already connected to the requested peer\n    var pc = peersManager.get(dest);\n    if(pc)\n    {\n      // We are already connected to that peer, ignore the request\n      var message = \"[\"+self.sessionID+\"] Already connected to \"+dest;\n      console.log(message);\n\n      // [ToDo] AddChannels(pc, labels);\n\n      var channels = pc._channels || [];\n\n      callback(null, pc, channels);\n\n      return;\n    };\n\n    // Check if we are already trying to connect to that peer\n    var offer = offers[dest];\n    if(offer)\n    {\n      // We are already trying to connect to that peer, ignore the request\n      var message = \"[\"+self.sessionID+\"] Already requested connection to \"+dest;\n      console.log(message);\n\n      var pc = offer.peerConnection;\n\n      // [ToDo] AddChannels(pc, labels);\n\n      pc.addEventListener('signalingstatechange', function(event)\n      {\n        if(pc.signalingState == 'stable')\n        {\n          var channels = pc._channels || [];\n\n          callback(null, pc, channels);\n        }\n      });\n\n      return;\n    };\n\n    // Request to connect to a new peer, generate the offer\n    generateOffer(dest, [handshakeManager, peersManager], labels, callback);\n  };\n\n\n  //\n  // Managers\n  //\n\n  function forward(message, connector)\n  {\n    var from = message.from;\n    var dest = message.dest;\n\n    // Message was for us, raise error\n    if(dest == self.sessionID)\n      return console.error('Ignored message send to us', message);\n\n    // Don't forward the message if TTL has been achieved\n    if(--message.ttl <= 0)\n      return console.warn(\"TTL achieved:\",message);\n\n    var dest = message.dest;\n\n    message = message.pack();\n\n    // Search the peer between the ones currently connected so we can send the\n    // message directly to it\n    for(var i=0, peer; peer=peersManager._connectors[i]; i++)\n      if(peer.sessionID == dest)\n        return peer.send(message);\n\n    // Peer was not found, forward message to all the connectors except the one\n    // where we received it\n    peersManager.send(message, connector);\n    handshakeManager.send(message, connector);\n  };\n\n\n  handshakeManager.on('connected', function()\n  {\n    self.emit('handshakeManager.connected', handshakeManager);\n  });\n  handshakeManager.on('disconnected', function()\n  {\n    self.emit('handshakeManager.disconnected', handshakeManager);\n  });\n\n  peersManager.on('connected', function()\n  {\n    self.emit('peersManager.connected', peersManager);\n  });\n  peersManager.on('disconnected', function()\n  {\n    self.emit('peersManager.disconnected', peersManager);\n  });\n\n\n  /**\n   * Check if it's a request from a peer we are already connected or trying to\n   * connect to, so we can prevent to do crossed connections\n   *\n   * @param from - ID of the other peer\n   *\n   * @returns {Boolean} - If we are already connected or trying to connect\n   */\n  function connectionProcessed(from)\n  {\n    // Check if we are already connected to the requester peer\n    var peer = peersManager.get(from);\n    if(peer)\n    {\n      // [ToDo] AddChannels(peer, labels);\n\n      // We are already connected to that peer, send an error to the other end\n      var message = \"[\"+self.sessionID+\"] Already connected to \"+from;\n      console.log(message);\n\n      var error =\n      {\n        code: -1,\n        message: message,\n        ttl: MAX_TTL_DEFAULT\n      };\n      return error;\n    };\n\n    // Check if we are already trying to connect to that peer\n    var offer = offers[from];\n    if(offer)\n    {\n      // [ToDo] AddChannels(offer.peerConnection, labels);\n\n      // We are already trying to connect to that peer, ignore the request\n      var message = \"[\"+self.sessionID+\"] Already requested connection to \"+from;\n      console.log(message);\n\n      // We have higher precedence, send an error to the other end\n      if(self.sessionID < from)\n      {\n        console.log(\"[\"+self.sessionID+\"] Higher precedence than \"+from+\", sending error\");\n\n        var error =\n        {\n          code: -2,\n          message: message,\n          ttl: MAX_TTL_DEFAULT\n        };\n        return error;\n      }\n\n      // We have less precedence, cancel our connection request and prepare to use the\n      // incoming one with the previous callback\n      delete offers[from];\n\n      rpcBuilder.cancel(offer.message);\n      offer.peerConnection.close();\n\n      console.debug(\"[\"+self.sessionID+\"] Lower precedence than \"+from+\", request canceled\");\n\n      return offer.callback;\n    };\n\n    // Connection request is a genuinely new one, process it as usual\n  };\n\n\n    //\n    // Protocol messages\n    //\n\n  function onpresence(from, connector)\n  {\n    // Check if we are already connected to the new peer\n    var peer = peersManager.get(from);\n    if(peer) return;\n\n    // Check if we are already trying to connect to the new peer\n    var offer = offers[from];\n    if(offer) return;\n\n    var pc = generateOffer(from, connector);\n\n    pc.addEventListener('signalingstatechange', function(event)\n    {\n      // If PeerConnection object gets open, increase number of connections\n      // fetch over this connector so it can decide if it could close\n      if(pc.signalingState == 'stable')\n        connector.increaseConnections();\n    });\n  };\n\n  function onoffer(request, connector)\n  {\n    var from = request.from;\n    var dest = request.dest;\n\n    // Message is for us\n    if(dest == self.sessionID)\n    {\n      console.log(\"[\"+dest+\"] Received connection request from \"+from);\n\n      // If connection is already processed, send an error to the other end\n      var processed = connectionProcessed(from);\n      if(processed && processed.code)\n        return request.reply(processed);\n\n      // Search the peer between the list of currently connected ones,\n      // or create it if it's not connected\n      var pc = createPeerConnection(from, \"answer\", function(answer)\n      {\n        var response =\n        {\n          sdp: answer,\n          ttl: MAX_TTL_DEFAULT\n        };\n\n        // Send back the connection request over the same connector, since\n        // this should be the shortest path to connect both peers\n        request.reply(null, response);\n      });\n\n      // Process offer & generate answer\n      pc.setRemoteDescription(new RTCSessionDescription(\n      {\n        sdp:  request.sdp,\n        type: 'offer'\n      }),\n      function()\n      {\n        pc.createAnswer(function(answer)\n        {\n          pc.setLocalDescription(answer, null, onerror);\n        },\n        onerror)\n      },\n      onerror);\n\n      if(processed)\n        pc.addEventListener('signalingstatechange', function(event)\n        {\n          if(pc.signalingState == 'stable')\n          {\n            var channels = pc._channels || [];\n\n            processed(null, pc, channels);\n          }\n        });\n\n      pc.addEventListener('datachannel', function(event)\n      {\n        var channel = event.channel;\n\n        var channels = pc._channels || [];\n\n        channels.push(channel);\n\n        pc._channels = channels;\n      });\n    }\n\n    // Forward message\n    else\n      forward(request, connector);\n  };\n\n\n  function generateOffer(dest, connector, labels, callback)\n  {\n    var pc = createPeerConnection(dest, \"offer\", function(offer)\n    {\n      var message =\n      {\n        sdp: offer,\n        ttl: callback ? MAX_TTL_DEFAULT : 1\n      };\n\n      callback = callback || noop;\n\n      var request = rpcBuilder.encode('offer', message, dest,\n      function(error, result)\n      {\n        if(error) return callback(error);\n\n        processAnswer(result);\n      });\n\n      offers[dest] =\n      {\n        callback: callback,\n        message: request,\n        peerConnection: pc\n      };\n\n      if(connector instanceof Array)\n        connector.forEach(function(c)\n        {\n          c.send(request);\n        });\n\n      // Send back the connection request over the same connector, since this\n      // should be the shortest path to connect both peers\n      else\n        connector.send(request);\n    });\n\n    //\n    // Init PeerConnection\n    //\n\n    // Set channels for this PeerConnection object\n    labels = [self.routingLabel].concat(commonLabels, labels);\n\n    var channels = pc._channels = [];\n\n    for(var i=0, label; label=labels[i]; i++)\n    {\n      var channel = pc.createDataChannel(label);\n\n      channels.push(channel);\n\n      channel.addEventListener('close', function(event)\n      {\n        channels.splice(channels.indexOf(channel), 1);\n      });\n    };\n\n    // Send offer\n    var mediaConstraints =\n    {\n      mandatory:\n      {\n        OfferToReceiveAudio: false,\n        OfferToReceiveVideo: false\n      }\n    };\n\n    pc.createOffer(function(offer)\n    {\n      pc.setLocalDescription(offer, null, onerror);\n    },\n    onerror,\n    mediaConstraints);\n\n    return pc;\n  };\n\n  function processAnswer(response)\n  {\n    var from = response.from;\n\n    console.debug('['+self.sessionID+'] Received answer from '+from);\n\n    var offer = offers[from];\n    if(offer)\n      offer.peerConnection.setRemoteDescription(new RTCSessionDescription(\n      {\n        sdp:  response.sdp,\n        type: 'answer'\n      }),\n      null, onerror);\n    else\n      console.warn(\"[\"+self.sessionID+\"] Connection with peer '\" + from + \"' was not previously requested\");\n  };\n\n\n    //\n    // Manager events\n    //\n\n  function initManagerEvents(manager)\n  {\n    manager.on('connected', function()\n    {\n      if(handshakeManager.status != peersManager.status)\n        self.emit('connected');\n    });\n    manager.on('disconnected', function()\n    {\n      if(handshakeManager.status == peersManager.status)\n        self.emit('disconnected');\n    });\n//    manager.on('error', onerror);\n\n    manager.on('offer',  onoffer);\n    manager.on('answer', forward);\n    manager.on('error',  forward);\n  };\n\n  // Init managers events\n\n  initManagerEvents(handshakeManager);\n  initManagerEvents(peersManager);\n\n  handshakeManager.on('presence', onpresence);\n\n\n  //\n  // Clossing functions\n  //\n\n  this.close = function()\n  {\n    handshakeManager.close();\n    peersManager.close();\n\n    rpcBuilder.cancel();\n  };\n\n  // Close all connections when user goes out of the page or app is clossed\n  process.on('exit', function(code)\n  {\n    self.close();\n  });\n};\ninherits(WebP2P, EventEmitter);\n\n\nmodule.exports = WebP2P;\n","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    if (canPost) {\n        var queue = [];\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n}\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","var inherits = require('inherits');\n\nvar Manager = require('./Manager');\n\nvar errors = require('../errors');\n\n\nvar Connector_PubNub = require('../connectors/PubNub');\n\n\n/**\n * Manage the handshake connectors using several servers\n *\n * @constructor\n * @param {String} json_uri URI of the handshake servers configuration.\n */\nfunction HandshakeManager(rpcBuilder, handshake_servers)\n{\n  Manager.call(this, rpcBuilder);\n\n  var self = this;\n\n\n  var handshakeConnectorConstructors = {};\n\n  this.registerConnectorConstructor = function(type, constructor)\n  {\n    handshakeConnectorConstructors[type] = constructor\n  };\n\n\n  // Default handshake connectors\n  this.registerConnectorConstructor('PubNub', Connector_PubNub);\n\n\n  function createConnector(config)\n  {\n    var type            = config.type;\n    var config_init     = config.config_init;\n    var config_mess     = config.config_mess;\n    var max_connections = config.max_connections;\n\n    // Check if connector constructor is from a valid handshake server\n    var connectorConstructor = handshakeConnectorConstructors[type];\n    if(!connectorConstructor)\n      throw Error(\"Invalid handshake server type '\" + type + \"'\");\n\n    var connector = new connectorConstructor(config_init, config_mess, max_connections);\n\n    self._initConnector(connector);\n\n    connector.on('open', function()\n    {\n      // Notify our presence to the other peers\n      connector.send(rpcBuilder.encode('presence'));\n    });\n\n    var _messageUnpacked = connector._messageUnpacked;\n    connector._messageUnpacked = function(message)\n    {\n      if(message.method == 'presence')\n      {\n        if(connector.shouldConnect())\n          self.emit(\"presence\", message.params.from, connector);\n      }\n      else\n        _messageUnpacked.call(connector, message);\n    };\n\n    return connector;\n  };\n\n\n  var configs = [];\n  var index = 0;\n\n  var configs_infinity = [];\n\n  /**\n   * Get a random handshake connector or test for the next one\n   * @param {Object} configuration Handshake servers configuration.\n   */\n  function handshake()\n  {\n    if(!configs.length)\n      throw Error('No handshake servers defined')\n\n    for(; index < configs.length; index++)\n    {\n      var connector = createConnector(configs[index]);\n          connector.on('close', function()\n      {\n        // Handshake connector has been closed, try to get an alternative one\n        index++;\n        handshake();\n      });\n\n      // Connector successfully created\n      return;\n    };\n\n    // All configured handshake servers has been consumed\n    // Get ready to start again from beginning of handshake servers list\n    index = 0;\n  };\n\n\n  this.addConfigs_byObject = function(config)\n  {\n    // Check if connector constructor is from a valid handshake server\n    var connectorConstructor = handshakeConnectorConstructors[config.type];\n    if(!connectorConstructor)\n      return console.error(\"Invalid handshake server config: \", config);\n\n    if(connectorConstructor.prototype.max_connections == Number.POSITIVE_INFINITY\n    && !config.max_connections)\n    {\n      configs_infinity.push(config)\n\n      // Start handshaking\n      createConnector(config);\n    }\n    else\n    {\n      configs.push(config);\n\n      // Start handshaking\n      if(self.status == 'disconnected')\n        handshake();\n    }\n  };\n\n\n  // Add handshake servers configuration\n  if(handshake_servers)\n    this.addConfigs(handshake_servers)\n};\ninherits(HandshakeManager, Manager);\n\n\nHandshakeManager.prototype.addConfigs = function(configuration)\n{\n  if(typeof configuration == 'string')\n    return this.addConfigs_byUri(configuration);\n\n  if(configuration instanceof Array)\n    return this.addConfigs_byArray(configuration);\n\n  this.addConfigs_byObject(configuration);\n};\n\nHandshakeManager.prototype.addConfigs_byArray = function(configuration)\n{\n  for(var i=0, config; config=configuration[i]; i++)\n    this.addConfigs_byObject(config);\n};\n\nHandshakeManager.prototype.addConfigs_byUri = function(json_uri)\n{\n  var self = this;\n\n  function dispatchError(error)\n  {\n    self.emit('error', error);\n  };\n\n  // Request the handshake servers configuration file\n  var http_request = new XMLHttpRequest();\n\n  http_request.open('GET', json_uri);\n  http_request.onload = function(event)\n  {\n    if(this.status == 200)\n    {\n      var configuration = JSON.parse(http_request.response);\n\n      // We got some config entries\n      if(configuration.length)\n        self.addConfigs_byArray(configuration)\n\n      // Config was empty\n      else\n        dispatchError(errors.ERROR_REQUEST_EMPTY)\n    }\n\n    // Request returned an error\n    else\n      dispatchError(errors.ERROR_REQUEST_FAILURE)\n  };\n\n  // Connection error\n  http_request.onerror = function(event)\n  {\n    dispatchError(navigator.onLine ? errors.ERROR_NETWORK_UNKNOWN\n                                   : errors.ERROR_NETWORK_OFFLINE)\n  };\n\n  http_request.send();\n};\n\n\nmodule.exports = HandshakeManager;\n","var inherits = require('inherits');\n\nvar Manager = require('./Manager');\n\nvar Connector_DataChannel = require('../connectors/core/DataChannel');\n\n\n/**\n * @classdesc Manager of the communications with the other peers\n *\n * @constructor\n */\nfunction PeersManager(rpcBuilder, routingLabel)\n{\n  Manager.call(this, rpcBuilder);\n\n  var self = this;\n\n\n  function createConnector(channel)\n  {\n    var connector = new Connector_DataChannel(channel);\n\n    self._initConnector(connector);\n\n    return connector;\n  };\n\n\n  var peers = {};\n\n  this.__defineGetter__(\"peers\", function()\n  {\n    return peers;\n  });\n\n\n  function initDataChannel(channel, sessionID)\n  {\n    if(channel.label == routingLabel)\n    {\n      var connector = createConnector(channel);\n          connector.sessionID = sessionID;\n\n      return connector;\n    };\n  };\n\n  this.add = function(sessionID, peerConnection, channels)\n  {\n    peerConnection.addEventListener('signalingstatechange', function(event)\n    {\n      // Remove the peer from the list of peers when gets closed\n      if(peerConnection.signalingState == 'closed')\n        delete peers[sessionID];\n    });\n\n    // Connection initiator\n    if(channels.length)\n    {\n      // Only init the routing functionality on the routing channel\n      for(var i=0, channel; channel=channels[i]; i++)\n        if(initDataChannel(channel, sessionID))\n          break;\n    }\n\n    // Connection receiver\n    else\n    {\n      function initDataChannel_listener(event)\n      {\n        var channel = event.channel;\n\n        var connector = initDataChannel(channel, sessionID);\n        if(connector)\n          event.target.removeEventListener('datachannel', initDataChannel_listener);\n      };\n\n      peerConnection.addEventListener('datachannel', initDataChannel_listener);\n    };\n\n    // Add PeerConnection to the list of enabled ones\n    peers[sessionID] = peerConnection;\n  };\n\n  this.get = function(sessionID)\n  {\n    return peers[sessionID];\n  };\n\n  var _close = this.close;\n  this.close = function()\n  {\n    for(var id in peers)\n      peers[id].close();\n\n    _close.call(this);\n  };\n};\ninherits(PeersManager, Manager);\n\n\nmodule.exports = PeersManager;\n","const ERROR    = 0;\nconst PRESENCE = 1;\nconst OFFER    = 2;\nconst ANSWER   = 3;\n\n\nfunction pack(message, id)\n{\n  var result = new Array(6);\n  var params = message.params || {};\n\n  // Method\n  var method = message.method;\n  switch(method)\n  {\n    case \"error\":\n      result[0] = ERROR;\n    break;\n\n    case \"presence\":\n      result[0] = PRESENCE;\n    break;\n\n    case \"offer\":\n      result[0] = OFFER;\n    break;\n\n    case \"answer\":\n      result[0] = ANSWER;\n    break;\n\n    default:\n    {\n      var error = new Error(\"Unknown message method '\"+method+\"'\");\n          error.message = message;\n\n      throw error;\n    };\n  };\n\n  // From\n  result[1] = params.from;\n\n  // Offer & Answer\n\n  if(method != 'presence')\n  {\n    result[2] = params.dest;\n    result[3] = id;\n    result[4] = params.ttl;\n    result[5] = params.sdp || params.message;\n  };\n\n  return JSON.stringify(result);\n};\n\nfunction unpack(message)\n{\n  var result = {};\n  var params = {};\n\n  message = JSON.parse(message);\n\n  // Method\n  var method = message[0];\n  switch(method)\n  {\n    case ERROR:\n      result.method = \"error\";\n    break;\n\n    case PRESENCE:\n      result.method = \"presence\";\n    break;\n\n    case OFFER:\n      result.method = \"offer\";\n    break;\n\n    case ANSWER:\n      result.method = \"answer\";\n    break;\n\n    default:\n    {\n      var error = new Error(\"Unknown message method '\"+method+\"'\");\n          error.message = message;\n\n      throw error;\n    };\n  };\n\n  // From\n  params.from = message[1];\n\n  // Offer & Answer\n\n  if(method != PRESENCE)\n  {\n    params.dest = message[2];\n\n    if(method == ERROR || method == ANSWER)\n      result.ack = message[3];\n    else\n      result.id = message[3];\n\n    params.ttl  = message[4];\n\n    if(method == ERROR)\n      params.message = message[5];\n    else\n      params.sdp = message[5];\n  };\n\n  // Return unpacked message\n  result.params = params;\n\n  return result;\n};\n\n\nvar responseMethods =\n{\n  'presence': 'offer',\n\n  'offer':\n  {\n    error:    'error',\n    response: 'answer'\n  }\n};\n\n\nexports.pack   = pack;\nexports.unpack = unpack;\n\nexports.responseMethods = responseMethods;\n","var inherits = require(\"inherits\");\n\nvar EventEmitter = require(\"events\").EventEmitter;\n\n\nfunction Connector()\n{\n  EventEmitter.call(this);\n\n  var self = this;\n\n\n  /**\n   * Notify that the connection to this handshake server is open\n   */\n  this._open = function()\n  {\n    self.emit('open');\n  };\n\n  this._message = function(message)\n  {\n    self.emit(\"message\", message);\n  };\n\n  this._close = function()\n  {\n    self.emit('close');\n  };\n\n  this._error = function(error)\n  {\n    self.emit('error', error);\n  };\n};\ninherits(Connector, EventEmitter);\n\n\nConnector.prototype.close = function()\n{\n  throw new TypeError(\"Connector.close should be defined in a child class\");\n};\nConnector.prototype.send = function(message)\n{\n  throw new TypeError(\"Connector.send should be defined in a child class\");\n};\n\n\nmodule.exports = Connector;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","var EventEmitter = require(\"events\").EventEmitter;\n\nvar inherits = require('inherits');\n\n\nfunction Manager(rpcBuilder)\n{\n  EventEmitter.call(this);\n\n  var self = this;\n\n\n  this._connectors = [];\n\n  this.__defineGetter__(\"status\", function()\n  {\n    return this._connectors.length ? 'connected' : 'disconnected';\n  });\n\n\n  this._initConnector = function(connector)\n  {\n    connector.on('open', function()\n    {\n//      for(var i=0, conn; conn=self._connectors[i]; i++)\n//        if(conn===connector)\n//          console.error('Duplicate connector',connector);\n\n      self._connectors.push(connector);\n\n      if(self._connectors.length == 1)\n         self.emit('connected');\n    });\n    connector.on('close', function()\n    {\n      self._connectors.splice(self._connectors.indexOf(connector), 1);\n\n      if(self._connectors.length == 0)\n         self.emit('disconnected');\n    });\n    connector.on('error', function(error)\n    {\n      connector.close();\n\n      self.emit('error', error);\n    });\n\n    connector._messageUnpacked = function(message)\n    {\n      var method = message.method;\n      var params = message.params;\n\n      switch(method)\n      {\n        case 'offer':\n          params.reply = function(error, result)\n          {\n            return message.reply(error, result, connector);\n          };\n\n        case 'answer':\n        case 'error':\n          params.pack = function()\n          {\n            return message.pack();\n          };\n\n          self.emit(method, params, connector);\n        break;\n\n        default:\n          // This should never be reached\n          console.error(\"Unknown message method '\"+method+\"'\", message);\n      };\n    };\n\n    connector.on('message', function(message)\n    {\n      message = rpcBuilder.decode(message);\n      if(message)\n      {\n        // Response was previously stored, send it directly\n        if(message.stored)\n          connector.send(message)\n\n        // Normal message, process it\n        else\n          connector._messageUnpacked(message);\n      };\n    });\n  };\n};\ninherits(Manager, EventEmitter);\n\n\n/**\n * Close all the connections\n */\nManager.prototype.close = function()\n{\n  for(var i=0, connector; connector=this._connectors[i]; i++)\n    connector.close();\n};\n\n/**\n * {Object} message - Message to be send\n * {Connector} [incomingConnector] - {Connector} to don't send the message\n */\nManager.prototype.send = function(message, incomingConnector)\n{\n  for(var i=0, connector; connector=this._connectors[i]; i++)\n  {\n    // Don't send the message to the same connector where we received it\n    if(connector === incomingConnector)\n      continue;\n\n    connector.send(message);\n  };\n};\n\n\nmodule.exports = Manager;\n","const ERROR_NETWORK_UNKNOWN = {id: 0, msg: 'Unable to fetch handshake servers configuration'};\nconst ERROR_NETWORK_OFFLINE = {id: 1, msg: \"There's no available network\"};\nconst ERROR_REQUEST_FAILURE = {id: 2, msg: 'Unable to fetch handshake servers configuration'};\nconst ERROR_REQUEST_EMPTY   = {id: 3, msg: 'Handshake servers configuration is empty'};\n\nconst ERROR_NO_PEERS        = {id: 4, msg: 'Not connected to any peer'};\n\n\nexports.ERROR_NETWORK_UNKNOWN = ERROR_NETWORK_UNKNOWN;\nexports.ERROR_NETWORK_OFFLINE = ERROR_NETWORK_OFFLINE;\nexports.ERROR_REQUEST_FAILURE = ERROR_REQUEST_FAILURE;\nexports.ERROR_REQUEST_EMPTY   = ERROR_REQUEST_EMPTY;\nexports.ERROR_NO_PEERS        = ERROR_NO_PEERS;","var inherits = require(\"inherits\");\n\nvar HandshakeConnector = require(\"./core/HandshakeConnector\");\n\nvar PUBNUB = require(\"pubnub\");\n\n\n/**\n * Handshake connector for PubNub\n * @param {Object} configuration Configuration object.\n */\nfunction Connector_PubNub(config_init, config_mess, max_connections)\n{\n  HandshakeConnector.call(this, max_connections);\n\n  var self = this;\n\n  var channel = config_mess.channel;\n\n\n  // Connect a handshake connector to the PubNub server\n  var pubnub = PUBNUB.init(config_init);\n\n  // Configure handshake connector\n  pubnub.subscribe(\n  {\n    channel: channel,\n    restore: false,\n    backfill: false,\n\n    connect:    self._open,\n    message:    self._message,\n    disconnect: self._close,\n\n    error: function(response)\n    {\n      self._error(new Error(response ? response.error : 'Undefined error'))\n    }\n  });\n\n\n  // Define methods\n\n  /**\n   * Close the connection with this handshake server\n   */\n  this.close = function()\n  {\n    pubnub.unsubscribe(\n    {\n      channel: channel\n    });\n\n    // This shouldn't be necesary, but seems 'disconnect' event is not being\n    // dispatched by the PubNub channel, so we close the connector explicitly\n    self._close();\n  }\n\n  /**\n   * Send the message\n   */\n  this.send = function(message)\n  {\n    pubnub.publish(\n    {\n      channel: channel,\n      message: message\n    });\n  };\n}\ninherits(Connector_PubNub, HandshakeConnector);\n\n\n// Class constants\nConnector_PubNub.prototype.max_connections = 50;\nObject.defineProperty(Connector_PubNub.prototype, 'max_chars', {value: 1800});\n\n\nmodule.exports = Connector_PubNub;\n","var inherits = require(\"inherits\");\n\nvar Connector = require(\"./Connector\");\n\n\nfunction Connector_DataChannel(datachannel)\n{\n  Connector.call(this);\n\n  var self = this;\n\n\n  datachannel.addEventListener('open',  self._open);\n  datachannel.addEventListener('message', function(event)\n  {\n    self._message(event.data);\n  });\n  datachannel.addEventListener('close', self._close);\n  datachannel.addEventListener('error', self._error);\n\n\n  // Define methods\n\n  /**\n   * Close the connection with the peer\n   */\n  this.close = function()\n  {\n    datachannel.close();\n  };\n\n  /**\n   * Send the message\n   */\n  this.send = function(message)\n  {\n    datachannel.send(message);\n  };\n};\ninherits(Connector_DataChannel, Connector);\n\n\nmodule.exports = Connector_DataChannel;\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/* jshint node: true */\n'use strict';\n\n/**\n  # freeice\n\n  The `freeice` module is a simple way of getting random STUN or TURN server\n  for your WebRTC application.  The list of servers (just STUN at this stage)\n  were sourced from this [gist](https://gist.github.com/zziuni/3741933).\n\n  ## Example Use\n\n  The following demonstrates how you can use `freeice` with\n  [rtc-quickconnect](https://github.com/rtc-io/rtc-quickconnect):\n\n  <<< examples/quickconnect.js\n\n  As the `freeice` module generates ice servers in a list compliant with the\n  WebRTC spec you will be able to use it with raw `RTCPeerConnection`\n  constructors and other WebRTC libraries. \n\n  ## Hey, don't use my STUN/TURN server!\n\n  If for some reason your free STUN or TURN server ends up in the\n  [list](servers.js) of servers that is used in this module, you can feel\n  free to open an issue on this repository and those servers will be removed\n  within 24 hours (or sooner).  This is the quickest and probably the most\n  polite way to have something removed (and provides us some visibility\n  if someone opens a pull request requesting that a server is added).\n\n  ## Please add my server!\n\n  If you have a server that you wish to add to the list, that's awesome! I'm\n  sure I speak on behalf of a whole pile of WebRTC developers who say thanks.\n  To get it into the list, feel free to either open a pull request or if you\n  find that process a bit daunting then just create an issue requesting\n  the addition of the server (make sure you provide all the details, and if\n  you have a Terms of Service then including that in the PR/issue would be\n  awesome).\n\n  ## I know of a free server, can I add it?\n\n  Sure, if you do your homework and make sure it is ok to use (I'm currently\n  in the process of reviewing the terms of those STUN servers included from\n  the original list).  If it's ok to go, then please see the previous entry\n  for how to add it.\n\n  ## Current List of Servers\n\n  * current as at the time of last `README.md` file generation\n\n  <<< servers.js\n\n**/\n\nvar freeice = module.exports = function(opts) {\n  // if a list of servers has been provided, then use it instead of defaults\n  var servers = (opts || {}).servers || require('./servers');\n\n  var stunCount = (opts || {}).stun || 2;\n  var turnCount = (opts || {}).turn || 0;\n  var selected;\n\n  function getServers(type, count) {\n    var out = [];\n    var input = [].concat(servers[type]);\n    var idx;\n\n    while (input.length && out.length < count) {\n      idx = (Math.random() * input.length) | 0;\n      out = out.concat(input.splice(idx, 1));\n    }\n\n    return out.map(function(url) {\n      return { url: type + ':' + url };\n    });\n  }\n\n  // add stun servers\n  selected = [].concat(getServers('stun', stunCount));\n\n  if (turnCount) {\n    selected = selected.concat(getServers('turn', turnCount));\n  }\n\n  return selected;\n};","//     uuid.js\n//\n//     Copyright (c) 2010-2012 Robert Kieffer\n//     MIT License - http://opensource.org/licenses/mit-license.php\n\n// Unique ID creation requires a high quality random # generator.  We feature\n// detect to determine the best RNG source, normalizing to a function that\n// returns 128-bits of randomness, since that's what's usually required\nvar _rng = require('./rng');\n\n// Buffer class to use\nvar BufferClass = typeof(Buffer) == 'function' ? Buffer : Array;\n\n// Maps for number <-> hex string conversion\nvar _byteToHex = [];\nvar _hexToByte = {};\nfor (var i = 0; i < 256; i++) {\n  _byteToHex[i] = (i + 0x100).toString(16).substr(1);\n  _hexToByte[_byteToHex[i]] = i;\n}\n\n// **`parse()` - Parse a UUID into it's component bytes**\nfunction parse(s, buf, offset) {\n  var i = (buf && offset) || 0, ii = 0;\n\n  buf = buf || [];\n  s.toLowerCase().replace(/[0-9a-f]{2}/g, function(oct) {\n    if (ii < 16) { // Don't overflow!\n      buf[i + ii++] = _hexToByte[oct];\n    }\n  });\n\n  // Zero out remaining bytes if string was short\n  while (ii < 16) {\n    buf[i + ii++] = 0;\n  }\n\n  return buf;\n}\n\n// **`unparse()` - Convert UUID byte array (ala parse()) into a string**\nfunction unparse(buf, offset) {\n  var i = offset || 0, bth = _byteToHex;\n  return  bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] + '-' +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]] +\n          bth[buf[i++]] + bth[buf[i++]];\n}\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\n// random #'s we need to init node and clockseq\nvar _seedBytes = _rng();\n\n// Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\nvar _nodeId = [\n  _seedBytes[0] | 0x01,\n  _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n];\n\n// Per 4.2.2, randomize (14 bit) clockseq\nvar _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n// Previous uuid creation time\nvar _lastMSecs = 0, _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  var node = options.node || _nodeId;\n  for (var n = 0; n < 6; n++) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : unparse(b);\n}\n\n// **`v4()` - Generate random UUID**\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v4(options, buf, offset) {\n  // Deprecated - 'format' argument, as supported in v1.2\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options == 'binary' ? new BufferClass(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || _rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ii++) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || unparse(rnds);\n}\n\n// Export public API\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\nuuid.parse = parse;\nuuid.unparse = unparse;\nuuid.BufferClass = BufferClass;\n\nmodule.exports = uuid;\n","var RTCIceCandidate       = window.mozRTCIceCandidate       || window.webkitRTCIceCandidate       || window.RTCIceCandidate;\nvar RTCPeerConnection     = window.mozRTCPeerConnection     || window.webkitRTCPeerConnection     || window.RTCPeerConnection;\nvar RTCSessionDescription = window.mozRTCSessionDescription || window.webkitRTCSessionDescription || window.RTCSessionDescription;\n\nexports.RTCIceCandidate       = RTCIceCandidate;\nexports.RTCPeerConnection     = RTCPeerConnection;\nexports.RTCSessionDescription = RTCSessionDescription;\n","// Generated by CoffeeScript 1.6.2\n(function() {\n  var EventEmitter, name, processLacksEventFunctions, value, _ref;\n\n  EventEmitter = require(\"events\").EventEmitter;\n\n  processLacksEventFunctions = function() {\n    var name, value, _ref;\n\n    _ref = EventEmitter.prototype;\n    for (name in _ref) {\n      value = _ref[name];\n      if (process[name] != null) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  if (!((typeof window !== \"undefined\" && window !== null) && window.document && window.navigator)) {\n    return;\n  }\n\n  if (!((typeof process !== \"undefined\" && process !== null) && (typeof global !== \"undefined\" && global !== null))) {\n    return;\n  }\n\n  if (window !== global) {\n    return;\n  }\n\n  if (window.onerror !== null) {\n    return;\n  }\n\n  if (!processLacksEventFunctions()) {\n    return;\n  }\n\n  _ref = EventEmitter.prototype;\n  for (name in _ref) {\n    value = _ref[name];\n    process[name] = value;\n  }\n\n  window.onerror = function(err, url, line) {\n    return process.emit(\"uncaughtException\", new Error(\"\" + err + \" (\" + url + \":\" + line + \")\"));\n  };\n\n  window.addEventListener(\"unload\", function(event) {\n    return process.emit(\"exit\");\n  });\n\n}).call(this);\n\n/*\n//@ sourceMappingURL=process-events-shim.map\n*/\n","/*\n * (C) Copyright 2014 Kurento (http://kurento.org/)\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the GNU Lesser General Public License\n * (LGPL) version 2.1 which accompanies this distribution, and is available at\n * http://www.gnu.org/licenses/lgpl-2.1.html\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n */\n\nvar inherits = require('inherits');\n\nvar packers = require('./packers');\nvar Mapper = require('./Mapper');\n\n\nconst BASE_TIMEOUT = 5000;\n\n\nfunction unifyResponseMethods(responseMethods)\n{\n  if(!responseMethods) return {};\n\n  for(var key in responseMethods)\n  {\n    var value = responseMethods[key];\n\n    if(typeof value == 'string')\n      responseMethods[key] =\n      {\n        response: value\n      }\n  };\n\n  return responseMethods;\n};\n\nfunction checkValidTransport(transport)\n{\n  if(!transport) return;\n\n  if(transport instanceof Function || transport.send instanceof Function)\n    return;\n\n  throw new SyntaxError(\"Transport is not a function nor have a send method\");\n};\n\n\n\n/**\n * Representation of a RPC notification\n *\n * @class\n *\n * @constructor\n *\n * @param {String} method -method of the notification\n * @param params - parameters of the notification\n */\nfunction RpcNotification(method, params)\n{\n  Object.defineProperty(this, 'method', {value: method, enumerable: true});\n  Object.defineProperty(this, 'params', {value: params, enumerable: true});\n};\n\n\n/**\n * @class\n *\n * @constructor\n */\nfunction RpcBuilder(packer, options, transport)\n{\n  var self = this;\n\n  if(!packer)\n    throw new SyntaxError('Packer is not defined');\n\n  if(!packer.pack || !packer.unpack)\n    throw new SyntaxError('Packer is invalid');\n\n  var responseMethods = unifyResponseMethods(packer.responseMethods);\n\n\n  if(options instanceof Function || options && options.send instanceof Function)\n  {\n    if(transport)\n      throw new SyntaxError(\"There can't be parameters after callback\");\n\n    transport = options;\n    options = undefined;\n  };\n\n  options = options || {};\n\n\n  Object.defineProperty(this, 'peerID', {value: options.peerID});\n\n  var max_retries = options.max_retries || 0;\n\n\n  checkValidTransport(transport);\n\n  this.transport = transport;\n\n  const request_timeout    = options.request_timeout    || BASE_TIMEOUT;\n  const response_timeout   = options.response_timeout   || BASE_TIMEOUT;\n  const duplicates_timeout = options.duplicates_timeout || BASE_TIMEOUT;\n\n\n  var requestID = 0;\n\n  var requests  = new Mapper();\n  var responses = new Mapper();\n  var processedResponses = new Mapper();\n\n  var message2Key = {};\n\n\n  /**\n   * Store the response to prevent to process duplicate request later\n   */\n  function storeResponse(message, id, dest)\n  {\n    var response =\n    {\n      message: message,\n      /** Timeout to auto-clean old responses */\n      timeout: setTimeout(function()\n      {\n        responses.remove(id, dest);\n      },\n      response_timeout)\n    };\n\n    responses.set(response, id, dest);\n  };\n\n  /**\n   * Store the response to ignore duplicated messages later\n   */\n  function storeProcessedResponse(ack, from)\n  {\n    var timeout = setTimeout(function()\n    {\n      processedResponses.remove(ack, from);\n    },\n    duplicates_timeout);\n\n    processedResponses.set(timeout, ack, from);\n  };\n\n\n  /**\n   * Representation of a RPC request\n   *\n   * @class\n   * @extends RpcNotification\n   *\n   * @constructor\n   *\n   * @param {String} method -method of the notification\n   * @param params - parameters of the notification\n   * @param {Integer} id - identifier of the request\n   * @param [from] - source of the notification\n   */\n  function RpcRequest(method, params, id, from, transport)\n  {\n    RpcNotification.call(this, method, params);\n\n    this.transport = transport;\n\n    var response = responses.get(id, from);\n\n    /**\n     * @constant {Boolean} duplicated\n     */\n    Object.defineProperty(this, 'duplicated',\n    {\n      value: Boolean(response)\n    });\n\n    var responseMethod = responseMethods[method];\n\n    this.pack = function()\n    {\n      return packer.pack(this, id);\n    }\n\n    /**\n     * Generate a response to this request\n     *\n     * @param {Error} [error]\n     * @param {*} [result]\n     *\n     * @returns {string}\n     */\n    this.reply = function(error, result, transport)\n    {\n      // Fix optional parameters\n      if(error instanceof Function || error && error.send instanceof Function)\n      {\n        if(result != undefined)\n          throw new SyntaxError(\"There can't be parameters after callback\");\n\n        transport = error;\n        result = null;\n        error = undefined;\n      }\n\n      else if(result instanceof Function\n      || result && result.send instanceof Function)\n      {\n        if(transport != undefined)\n          throw new SyntaxError(\"There can't be parameters after callback\");\n\n        transport = result;\n        result = null;\n      };\n\n      checkValidTransport(transport);\n\n      // Duplicated request, remove old response timeout\n      if(response)\n        clearTimeout(response.timeout);\n\n      if(from != undefined)\n      {\n        if(error)\n          error.dest = from;\n\n        if(result)\n          result.dest = from;\n      };\n\n      var message;\n\n      // New request or overriden one, create new response with provided data\n      if(error || result != undefined)\n      {\n        if(self.peerID != undefined)\n        {\n          if(error)\n            error.from = self.peerID;\n          else\n            result.from = self.peerID;\n        }\n\n        // Protocol indicates that responses has own request methods\n        if(responseMethod)\n        {\n          if(responseMethod.error == undefined && error)\n            message =\n            {\n              error: error\n            };\n\n          else\n          {\n            var method = error\n                       ? responseMethod.error\n                       : responseMethod.response;\n\n            message =\n            {\n              method: method,\n              params: error || result\n            };\n          }\n        }\n        else\n          message =\n          {\n            error:  error,\n            result: result\n          };\n\n        message = packer.pack(message, id);\n      }\n\n      // Duplicate & not-overriden request, re-send old response\n      else if(response)\n        message = response.message;\n\n      // New empty reply, response null value\n      else\n        message = packer.pack({result: null}, id);\n\n      // Store the response to prevent to process a duplicated request later\n      storeResponse(message, id, from);\n\n      // Return the stored response so it can be directly send back\n      transport = transport || this.transport || self.transport;\n\n      if(transport)\n      {\n        if(transport instanceof Function)\n          return transport(message);\n\n        return transport.send(message);\n      };\n\n      return message;\n    }\n  };\n  inherits(RpcRequest, RpcNotification);\n\n\n  function cancel(message)\n  {\n    var key = message2Key[message];\n    if(!key) return;\n\n    delete message2Key[message];\n\n    var request = requests.pop(key.id, key.dest);\n    if(!request) return;\n\n    clearTimeout(request.timeout);\n\n    // Start duplicated responses timeout\n    storeProcessedResponse(key.id, key.dest);\n  };\n\n  /**\n   * Allow to cancel a request and don't wait for a response\n   *\n   * If `message` is not given, cancel all the request\n   */\n  this.cancel = function(message)\n  {\n    if(message) return cancel(message);\n\n    for(var message in message2Key)\n      cancel(message);\n  };\n\n\n  this.close = function()\n  {\n    // Prevent to receive new messages\n    if(transport && transport.close)\n       transport.close();\n\n    // Request & processed responses\n    this.cancel();\n\n    processedResponses.forEach(function(timeout)\n    {\n      clearTimeout(timeout);\n    });\n\n    // Responses\n    responses.forEach(function(response)\n    {\n      clearTimeout(response.timeout);\n    });\n  };\n\n\n  /**\n   * Generates and encode a JsonRPC 2.0 message\n   *\n   * @param {String} method -method of the notification\n   * @param params - parameters of the notification\n   * @param [dest] - destination of the notification\n   * @param {object} [transport] - transport where to send the message\n   * @param [callback] - function called when a response to this request is\n   *   received. If not defined, a notification will be send instead\n   *\n   * @returns {string} A raw JsonRPC 2.0 request or notification string\n   */\n  this.encode = function(method, params, dest, transport, callback)\n  {\n    // Fix optional parameters\n    if(params instanceof Function)\n    {\n      if(dest != undefined)\n        throw new SyntaxError(\"There can't be parameters after callback\");\n\n      callback  = params;\n      transport = undefined;\n      dest      = undefined;\n      params    = undefined;\n    }\n\n    else if(dest instanceof Function)\n    {\n      if(transport != undefined)\n        throw new SyntaxError(\"There can't be parameters after callback\");\n\n      callback  = dest;\n      transport = undefined;\n      dest      = undefined;\n    }\n\n    else if(transport instanceof Function)\n    {\n      if(callback != undefined)\n        throw new SyntaxError(\"There can't be parameters after callback\");\n\n      callback  = transport;\n      transport = undefined;\n    };\n\n    var encode_transport = transport;\n\n    if(self.peerID != undefined)\n    {\n      params = params || {};\n\n      params.from = self.peerID;\n    };\n\n    if(dest != undefined)\n      params.dest = dest;\n\n    // Encode message\n    var message =\n    {\n      method: method,\n      params: params\n    };\n\n    if(callback)\n    {\n      var id = requestID++;\n      var retried = 0;\n\n      message = packer.pack(message, id);\n\n      var request =\n      {\n        message:         message,\n        callback:        dispatchCallback,\n        responseMethods: responseMethods[method] || {}\n      };\n\n      function dispatchCallback(error, result)\n      {\n        self.cancel(message);\n\n        callback(error, result);\n      };\n\n      function sendRequest(transport)\n      {\n        request.timeout = setTimeout(timeout,\n                                     request_timeout*Math.pow(2, retried++));\n        message2Key[message] = {id: id, dest: dest};\n        requests.set(request, id, dest);\n\n        transport = transport || encode_transport || self.transport;\n        if(transport)\n        {\n          if(transport instanceof Function)\n            return transport(message);\n\n          return transport.send(message);\n        };\n\n        return message;\n      };\n\n      function retry(transport)\n      {\n        console.warn(retried+' retry for request message:',message);\n\n        var timeout = processedResponses.pop(id, dest);\n        clearTimeout(timeout);\n\n        return sendRequest(transport);\n      };\n\n      function timeout()\n      {\n        if(retried < max_retries)\n          return retry(transport);\n\n        var error = new Error('Request has timed out');\n            error.request = message;\n\n        error.retry = retry;\n\n        dispatchCallback(error)\n      };\n\n      return sendRequest(transport);\n    };\n\n    // Return the packed message\n    return packer.pack(message);\n  };\n\n  /**\n   * Decode and process a JsonRPC 2.0 message\n   *\n   * @param {string} message - string with the content of the message\n   *\n   * @returns {RpcNotification|RpcRequest|undefined} - the representation of the\n   *   notification or the request. If a response was processed, it will return\n   *   `undefined` to notify that it was processed\n   *\n   * @throws {TypeError} - Message is not defined\n   */\n  this.decode = function(message, transport)\n  {\n    if(!message)\n      throw new TypeError(\"Message is not defined\");\n\n    message = packer.unpack(message);\n\n    var id     = message.id;\n    var ack    = message.ack;\n    var method = message.method;\n    var params = message.params || {};\n\n    var from = params.from;\n    var dest = params.dest;\n\n    // Ignore messages send by us\n    if(self.peerID != undefined && from == self.peerID) return;\n\n    // Notification\n    if(id == undefined && ack == undefined)\n      return new RpcNotification(method, params);\n\n\n    function processRequest()\n    {\n      checkValidTransport(transport);\n\n      var idAck = (id != undefined) ? id : ack;\n      return new RpcRequest(method, params, idAck, from, transport);\n    };\n\n    function processResponse(request, error, result)\n    {\n      request.callback(error, result);\n    };\n\n    function duplicatedResponse(timeout)\n    {\n      console.warn(\"Response already processed\", message);\n\n      // Update duplicated responses timeout\n      clearTimeout(timeout);\n      storeProcessedResponse(ack, from);\n    };\n\n\n    // Request, or response with own method\n    if(method)\n    {\n      // Check if it's a response with own method\n      if(dest == undefined || dest == self.peerID)\n      {\n        var request = requests.get(ack, from);\n        if(request)\n        {\n          var responseMethods = request.responseMethods;\n\n          if(method == responseMethods.error)\n            return processResponse(request, params);\n\n          if(method == responseMethods.response)\n            return processResponse(request, null, params);\n\n          return processRequest();\n        }\n\n        var processed = processedResponses.get(ack, from);\n        if(processed)\n          return duplicatedResponse(processed);\n      }\n\n      // Request\n      return processRequest();\n    };\n\n    var error  = message.error;\n    var result = message.result;\n\n    // Ignore responses not send to us\n    if(error  && error.dest  && error.dest  != self.sessionID) return;\n    if(result && result.dest && result.dest != self.sessionID) return;\n\n    // Response\n    var request = requests.get(ack, from);\n    if(!request)\n    {\n      var processed = processedResponses.get(ack, from);\n      if(processed)\n        return duplicatedResponse(processed);\n\n      return console.warn(\"No callback was defined for this message\", message);\n    };\n\n    // Process response\n    if(error)\n      error = new RpcError(error, transport);\n\n    processResponse(request, error, result);\n  };\n};\n\n\nRpcBuilder.RpcNotification = RpcNotification;\n\n\nmodule.exports = RpcBuilder;\n\nRpcBuilder.packers = packers;\n","// Version: 3.6.2\nvar NOW             = 1\n,   READY           = false\n,   READY_BUFFER    = []\n,   PRESENCE_SUFFIX = '-pnpres'\n,   DEF_WINDOWING   = 10     // MILLISECONDS.\n,   DEF_TIMEOUT     = 10000  // MILLISECONDS.\n,   DEF_SUB_TIMEOUT = 310    // SECONDS.\n,   DEF_KEEPALIVE   = 60     // SECONDS (FOR TIMESYNC).\n,   SECOND          = 1000   // A THOUSAND MILLISECONDS.\n,   URLBIT          = '/'\n,   PARAMSBIT       = '&'\n,   PRESENCE_HB_THRESHOLD = 5\n,   PRESENCE_HB_DEFAULT  = 30\n,   SDK_VER         = '3.6.2'\n,   REPL            = /{([\\w\\-]+)}/g;\n\n/**\n * UTILITIES\n */\nfunction unique() { return'x'+ ++NOW+''+(+new Date) }\nfunction rnow()   { return+new Date }\n\n/**\n * NEXTORIGIN\n * ==========\n * var next_origin = nextorigin();\n */\nvar nextorigin = (function() {\n    var max = 20\n    ,   ori = Math.floor(Math.random() * max);\n    return function( origin, failover ) {\n        return origin.indexOf('pubsub.') > 0\n            && origin.replace(\n             'pubsub', 'ps' + (\n                failover ? uuid().split('-')[0] :\n                (++ori < max? ori : ori=1)\n            ) ) || origin;\n    }\n})();\n\n\n/**\n * Build Url\n * =======\n *\n */\nfunction build_url( url_components, url_params ) {\n    var url    = url_components.join(URLBIT)\n    ,   params = [];\n\n    if (!url_params) return url;\n\n    each( url_params, function( key, value ) {\n        var value_str = (typeof value == 'object')?JSON['stringify'](value):value;\n        (typeof value != 'undefined' &&\n            value != null && encode(value_str).length > 0\n        ) && params.push(key + \"=\" + encode(value_str));\n    } );\n\n    url += \"?\" + params.join(PARAMSBIT);\n    return url;\n}\n\n/**\n * UPDATER\n * =======\n * var timestamp = unique();\n */\nfunction updater( fun, rate ) {\n    var timeout\n    ,   last   = 0\n    ,   runnit = function() {\n        if (last + rate > rnow()) {\n            clearTimeout(timeout);\n            timeout = setTimeout( runnit, rate );\n        }\n        else {\n            last = rnow();\n            fun();\n        }\n    };\n\n    return runnit;\n}\n\n/**\n * GREP\n * ====\n * var list = grep( [1,2,3], function(item) { return item % 2 } )\n */\nfunction grep( list, fun ) {\n    var fin = [];\n    each( list || [], function(l) { fun(l) && fin.push(l) } );\n    return fin\n}\n\n/**\n * SUPPLANT\n * ========\n * var text = supplant( 'Hello {name}!', { name : 'John' } )\n */\nfunction supplant( str, values ) {\n    return str.replace( REPL, function( _, match ) {\n        return values[match] || _\n    } );\n}\n\n/**\n * timeout\n * =======\n * timeout( function(){}, 100 );\n */\nfunction timeout( fun, wait ) {\n    return setTimeout( fun, wait );\n}\n\n/**\n * uuid\n * ====\n * var my_uuid = uuid();\n */\nfunction uuid(callback) {\n    var u = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,\n    function(c) {\n        var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n        return v.toString(16);\n    });\n    if (callback) callback(u);\n    return u;\n}\nfunction isArray(arg) {\n    var type = Object.prototype.toString.call(arg);\n    return   ( type === \"[object Array]\" || type === \"[object NodeList]\"  || type === \"[object ScriptBridgingArrayProxyObject]\");\n}\n\n/**\n * EACH\n * ====\n * each( [1,2,3], function(item) { } )\n */\nfunction each( o, f, old_logic) {\n    if ( !o || !f ) return;\n\n    if ( isArray(o) || ( old_logic && typeof o[0] != 'undefined' ) )\n        for ( var i = 0, l = o.length; i < l; )\n            f.call( o[i], o[i], i++ );\n    else\n        for ( var i in o )\n            o.hasOwnProperty    &&\n            o.hasOwnProperty(i) &&\n            f.call( o[i], i, o[i] );\n}\n\n/**\n * MAP\n * ===\n * var list = map( [1,2,3], function(item) { return item + 1 } )\n */\nfunction map( list, fun ) {\n    var fin = [];\n    each( list || [], function( k, v ) { fin.push(fun( k, v )) } );\n    return fin;\n}\n\n/**\n * ENCODE\n * ======\n * var encoded_data = encode('path');\n */\nfunction encode(path) { return encodeURIComponent(path) }\n\n/**\n * Generate Subscription Channel List\n * ==================================\n * generate_channel_list(channels_object);\n */\nfunction generate_channel_list(channels, nopresence) {\n    var list = [];\n    each( channels, function( channel, status ) {\n        if (nopresence) {\n            if(channel.search('-pnpres') < 0) { \n                if (status.subscribed) list.push(channel);\n            }    \n        } else {\n            if (status.subscribed) list.push(channel);\n        }  \n    });\n    return list.sort();\n}\n\n\n// PUBNUB READY TO CONNECT\nfunction ready() { timeout( function() {\n    if (READY) return;\n    READY = 1;\n    each( READY_BUFFER, function(connect) { connect() } );\n}, SECOND ); }\n\nfunction PN_API(setup) {\n    var SUB_WINDOWING =  +setup['windowing']   || DEF_WINDOWING\n    ,   SUB_TIMEOUT   = (+setup['timeout']     || DEF_SUB_TIMEOUT) * SECOND\n    ,   KEEPALIVE     = (+setup['keepalive']   || DEF_KEEPALIVE)   * SECOND\n    ,   NOLEAVE       = setup['noleave']       || 0\n    ,   PUBLISH_KEY   = setup['publish_key']   || 'demo'\n    ,   SUBSCRIBE_KEY = setup['subscribe_key'] || 'demo'\n    ,   AUTH_KEY      = setup['auth_key']      || ''\n    ,   SECRET_KEY    = setup['secret_key']    || ''\n    ,   PNSDK         = setup['PNSDK']         || ''\n    ,   hmac_SHA256   = setup['hmac_SHA256']\n    ,   SSL           = setup['ssl']            ? 's' : ''\n    ,   ORIGIN        = 'http'+SSL+'://'+(setup['origin']||'pubsub.pubnub.com')\n    ,   STD_ORIGIN    = nextorigin(ORIGIN)\n    ,   SUB_ORIGIN    = nextorigin(ORIGIN)\n    ,   CONNECT       = function(){}\n    ,   PUB_QUEUE     = []\n    ,   TIME_DRIFT    = 0\n    ,   SUB_CALLBACK  = 0\n    ,   SUB_CHANNEL   = 0\n    ,   SUB_RECEIVER  = 0\n    ,   SUB_RESTORE   = 0\n    ,   SUB_BUFF_WAIT = 0\n    ,   TIMETOKEN     = 0\n    ,   RESUMED       = false\n    ,   CHANNELS      = {}\n    ,   STATE         = {}\n    ,   PRESENCE_HB_TIMEOUT  = null\n    ,   PRESENCE_HB          = validate_presence_heartbeat(setup['heartbeat'] || setup['pnexpires'] || 0, setup['error'])\n    ,   PRESENCE_HB_INTERVAL = setup['heartbeat_interval'] || PRESENCE_HB - 3\n    ,   PRESENCE_HB_RUNNING  = false\n    ,   NO_WAIT_FOR_PENDING  = setup['no_wait_for_pending']\n    ,   COMPATIBLE_35 = setup['compatible_3.5']  || false\n    ,   xdr           = setup['xdr']\n    ,   error         = setup['error']      || function() {}\n    ,   _is_online    = setup['_is_online'] || function() { return 1 }\n    ,   jsonp_cb      = setup['jsonp_cb']   || function() { return 0 }\n    ,   db            = setup['db']         || {'get': function(){}, 'set': function(){}}\n    ,   CIPHER_KEY    = setup['cipher_key']\n    ,   UUID          = setup['uuid'] || ( db && db['get'](SUBSCRIBE_KEY+'uuid') || '');\n\n    var crypto_obj    = setup['crypto_obj'] ||\n        {\n            'encrypt' : function(a,key){ return a},\n            'decrypt' : function(b,key){return b}\n        };\n\n    function validate_presence_heartbeat(heartbeat, cur_heartbeat, error) {\n        var err = false;\n\n        if (typeof heartbeat === 'number') {\n            if (heartbeat > PRESENCE_HB_THRESHOLD || heartbeat == 0)\n                err = false;\n            else\n                err = true;\n        } else if(typeof heartbeat === 'boolean'){\n            if (!heartbeat) {\n                return 0;\n            } else {\n                return PRESENCE_HB_DEFAULT;\n            }\n        } else {\n            err = true;\n        }\n\n        if (err) {\n            error && error(\"Presence Heartbeat value invalid. Valid range ( x > \" + PRESENCE_HB_THRESHOLD + \" or x = 0). Current Value : \" + (cur_heartbeat || PRESENCE_HB_THRESHOLD));\n            return cur_heartbeat || PRESENCE_HB_THRESHOLD;\n        } else return heartbeat;\n    }\n\n    function encrypt(input, key) {\n        return crypto_obj['encrypt'](input, key || CIPHER_KEY) || input;\n    }\n    function decrypt(input, key) {\n        return crypto_obj['decrypt'](input, key || CIPHER_KEY) ||\n               crypto_obj['decrypt'](input, CIPHER_KEY) ||\n               input;\n    }\n\n    function error_common(message, callback) {\n        callback && callback({ 'error' : message || \"error occurred\"});\n        error && error(message);\n    }\n    function _presence_heartbeat() {\n\n        clearTimeout(PRESENCE_HB_TIMEOUT);\n\n        if (!PRESENCE_HB_INTERVAL || PRESENCE_HB_INTERVAL >= 500 || PRESENCE_HB_INTERVAL < 1 || !generate_channel_list(CHANNELS,true).length){\n            PRESENCE_HB_RUNNING = false;\n            return;\n        }\n\n        PRESENCE_HB_RUNNING = true;\n        SELF['presence_heartbeat']({\n            'callback' : function(r) {\n                PRESENCE_HB_TIMEOUT = timeout( _presence_heartbeat, (PRESENCE_HB_INTERVAL) * SECOND );\n            },\n            'error' : function(e) {\n                error && error(\"Presence Heartbeat unable to reach Pubnub servers.\" + JSON.stringify(e));\n                PRESENCE_HB_TIMEOUT = timeout( _presence_heartbeat, (PRESENCE_HB_INTERVAL) * SECOND );\n            }\n        });\n    }\n\n    function start_presence_heartbeat() {\n        !PRESENCE_HB_RUNNING && _presence_heartbeat();\n    }\n\n    function publish(next) {\n\n        if (NO_WAIT_FOR_PENDING) {\n            if (!PUB_QUEUE.length) return;\n        } else {\n            if (next) PUB_QUEUE.sending = 0;\n            if ( PUB_QUEUE.sending || !PUB_QUEUE.length ) return;\n            PUB_QUEUE.sending = 1;\n        }\n\n        xdr(PUB_QUEUE.shift());\n    }\n\n    function each_channel(callback) {\n        var count = 0;\n\n        each( generate_channel_list(CHANNELS), function(channel) {\n            var chan = CHANNELS[channel];\n\n            if (!chan) return;\n\n            count++;\n            (callback||function(){})(chan);\n        } );\n\n        return count;\n    }\n    function _invoke_callback(response, callback, err) {\n        if (typeof response == 'object') {\n            if (response['error'] && response['message'] && response['payload']) {\n                err({'message' : response['message'], 'payload' : response['payload']});\n                return;\n            }\n            if (response['payload']) {\n                callback(response['payload']);\n                return;\n            }\n        }\n        callback(response);\n    }\n\n    function _invoke_error(response,err) {\n        if (typeof response == 'object' && response['error'] &&\n            response['message'] && response['payload']) {\n            err({'message' : response['message'], 'payload' : response['payload']});\n        } else err(response);\n    }\n\n    // Announce Leave Event\n    var SELF = {\n        'LEAVE' : function( channel, blocking, callback, error ) {\n\n            var data   = { 'uuid' : UUID, 'auth' : AUTH_KEY }\n            ,   origin = nextorigin(ORIGIN)\n            ,   callback = callback || function(){}\n            ,   err      = error    || function(){}\n            ,   jsonp  = jsonp_cb();\n\n            // Prevent Leaving a Presence Channel\n            if (channel.indexOf(PRESENCE_SUFFIX) > 0) return true;\n\n            if (COMPATIBLE_35) {\n                if (!SSL)         return false;\n                if (jsonp == '0') return false;\n            }\n            \n            if (NOLEAVE)  return false;\n\n            if (jsonp != '0') data['callback'] = jsonp;\n\n            xdr({\n                blocking : blocking || SSL,\n                timeout  : 2000,\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : [\n                    origin, 'v2', 'presence', 'sub_key',\n                    SUBSCRIBE_KEY, 'channel', encode(channel), 'leave'\n                ]\n            });\n            return true;\n        },\n        'set_resumed' : function(resumed) {\n                RESUMED = resumed;\n        },\n        'get_cipher_key' : function() {\n            return CIPHER_KEY;\n        },\n        'set_cipher_key' : function(key) {\n            CIPHER_KEY = key;\n        },\n        'raw_encrypt' : function(input, key) {\n            return encrypt(input, key);\n        },\n        'raw_decrypt' : function(input, key) {\n            return decrypt(input, key);\n        },\n        'get_heartbeat' : function() {\n            return PRESENCE_HB;\n        },\n        'set_heartbeat' : function(heartbeat) {\n            PRESENCE_HB = validate_presence_heartbeat(heartbeat, PRESENCE_HB_INTERVAL, error);\n            PRESENCE_HB_INTERVAL = (PRESENCE_HB - 3 >= 1)?PRESENCE_HB - 3:1;\n            CONNECT();\n            _presence_heartbeat();\n        },\n        'get_heartbeat_interval' : function() {\n            return PRESENCE_HB_INTERVAL;\n        },\n        'set_heartbeat_interval' : function(heartbeat_interval) {\n            PRESENCE_HB_INTERVAL = heartbeat_interval;\n            _presence_heartbeat();\n        },\n        'get_version' : function() {\n            return SDK_VER;\n        },\n\n        /*\n            PUBNUB.history({\n                channel  : 'my_chat_channel',\n                limit    : 100,\n                callback : function(history) { }\n            });\n        */\n        'history' : function( args, callback ) {\n            var callback         = args['callback'] || callback\n            ,   count            = args['count']    || args['limit'] || 100\n            ,   reverse          = args['reverse']  || \"false\"\n            ,   err              = args['error']    || function(){}\n            ,   auth_key         = args['auth_key'] || AUTH_KEY\n            ,   cipher_key       = args['cipher_key']\n            ,   channel          = args['channel']\n            ,   start            = args['start']\n            ,   end              = args['end']\n            ,   include_token    = args['include_token']\n            ,   params           = {}\n            ,   jsonp            = jsonp_cb();\n\n            // Make sure we have a Channel\n            if (!channel)       return error('Missing Channel');\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            params['stringtoken'] = 'true';\n            params['count']       = count;\n            params['reverse']     = reverse;\n            params['auth']        = auth_key;\n\n            if (jsonp) params['callback']              = jsonp;\n            if (start) params['start']                 = start;\n            if (end)   params['end']                   = end;\n            if (include_token) params['include_token'] = 'true';\n\n            // Send Message\n            xdr({\n                callback : jsonp,\n                data     : params,\n                success  : function(response) {\n                    if (typeof response == 'object' && response['error']) {\n                        err({'message' : response['message'], 'payload' : response['payload']});\n                        return;\n                    }\n                    var messages = response[0];\n                    var decrypted_messages = [];\n                    for (var a = 0; a < messages.length; a++) {\n                        var new_message = decrypt(messages[a],cipher_key);\n                        try {\n                            decrypted_messages['push'](JSON['parse'](new_message));\n                        } catch (e) {\n                            decrypted_messages['push']((new_message));\n                        }\n                    }\n                    callback([decrypted_messages, response[1], response[2]]);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : [\n                    STD_ORIGIN, 'v2', 'history', 'sub-key',\n                    SUBSCRIBE_KEY, 'channel', encode(channel)\n                ]\n            });\n        },\n\n        /*\n            PUBNUB.replay({\n                source      : 'my_channel',\n                destination : 'new_channel'\n            });\n        */\n        'replay' : function(args, callback) {\n            var callback    = callback || args['callback'] || function(){}\n            ,   auth_key    = args['auth_key'] || AUTH_KEY\n            ,   source      = args['source']\n            ,   destination = args['destination']\n            ,   stop        = args['stop']\n            ,   start       = args['start']\n            ,   end         = args['end']\n            ,   reverse     = args['reverse']\n            ,   limit       = args['limit']\n            ,   jsonp       = jsonp_cb()\n            ,   data        = {}\n            ,   url;\n\n            // Check User Input\n            if (!source)        return error('Missing Source Channel');\n            if (!destination)   return error('Missing Destination Channel');\n            if (!PUBLISH_KEY)   return error('Missing Publish Key');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            // Setup URL Params\n            if (jsonp != '0') data['callback'] = jsonp;\n            if (stop)         data['stop']     = 'all';\n            if (reverse)      data['reverse']  = 'true';\n            if (start)        data['start']    = start;\n            if (end)          data['end']      = end;\n            if (limit)        data['count']    = limit;\n\n            data['auth'] = auth_key;\n\n            // Compose URL Parts\n            url = [\n                STD_ORIGIN, 'v1', 'replay',\n                PUBLISH_KEY, SUBSCRIBE_KEY,\n                source, destination\n            ];\n\n            // Start (or Stop) Replay!\n            xdr({\n                callback : jsonp,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function() { callback([ 0, 'Disconnected' ]) },\n                url      : url,\n                data     : data\n            });\n        },\n\n        /*\n            PUBNUB.auth('AJFLKAJSDKLA');\n        */\n        'auth' : function(auth) {\n            AUTH_KEY = auth;\n            CONNECT();\n        },\n\n        /*\n            PUBNUB.time(function(time){ });\n        */\n        'time' : function(callback) {\n            var jsonp = jsonp_cb();\n            xdr({\n                callback : jsonp,\n                data     : { 'uuid' : UUID, 'auth' : AUTH_KEY },\n                timeout  : SECOND * 5,\n                url      : [STD_ORIGIN, 'time', jsonp],\n                success  : function(response) { callback(response[0]) },\n                fail     : function() { callback(0) }\n            });\n        },\n\n        /*\n            PUBNUB.publish({\n                channel : 'my_chat_channel',\n                message : 'hello!'\n            });\n        */\n        'publish' : function( args, callback ) {\n            var callback = callback || args['callback'] || function(){}\n            ,   msg      = args['message']\n            ,   channel  = args['channel']\n            ,   auth_key = args['auth_key'] || AUTH_KEY\n            ,   cipher_key = args['cipher_key']\n            ,   err      = args['error'] || function() {}\n            ,   jsonp    = jsonp_cb()\n            ,   add_msg  = 'push'\n            ,   url;\n\n            if (args['prepend']) add_msg = 'unshift'\n\n            if (!msg)           return error('Missing Message');\n            if (!channel)       return error('Missing Channel');\n            if (!PUBLISH_KEY)   return error('Missing Publish Key');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            // If trying to send Object\n            msg = JSON['stringify'](encrypt(msg, cipher_key));\n\n            // Create URL\n            url = [\n                STD_ORIGIN, 'publish',\n                PUBLISH_KEY, SUBSCRIBE_KEY,\n                0, encode(channel),\n                jsonp, encode(msg)\n            ];\n\n            // Queue Message Send\n            PUB_QUEUE[add_msg]({\n                callback : jsonp,\n                timeout  : SECOND * 5,\n                url      : url,\n                data     : { 'uuid' : UUID, 'auth' : auth_key },\n                fail     : function(response){\n                    _invoke_error(response, err);\n                    publish(1);\n                },\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                    publish(1);\n                }\n            });\n\n            // Send Message\n            publish();\n        },\n\n        /*\n            PUBNUB.unsubscribe({ channel : 'my_chat' });\n        */\n        'unsubscribe' : function(args, callback) {\n            var channel = args['channel']\n            ,   callback      = callback            || args['callback'] || function(){}\n            ,   err           = args['error']       || function(){};\n\n            TIMETOKEN   = 0;\n            SUB_RESTORE = 1;\n\n            // Prepare Channel(s)\n            channel = map( (\n                channel.join ? channel.join(',') : ''+channel\n            ).split(','), function(channel) {\n                if (!CHANNELS[channel]) return;\n                return channel + ',' + channel + PRESENCE_SUFFIX;\n            } ).join(',');\n\n            // Iterate over Channels\n            each( channel.split(','), function(channel) {\n                var CB_CALLED = true;\n                if (!channel) return;\n                if (READY) {\n                    CB_CALLED = SELF['LEAVE']( channel, 0 , callback, err);\n                }\n                if (!CB_CALLED) callback({action : \"leave\"});\n                CHANNELS[channel] = 0;\n                if (channel in STATE) delete STATE[channel];\n            } );\n\n            // Reset Connection if Count Less\n            CONNECT();\n        },\n\n        /*\n            PUBNUB.subscribe({\n                channel  : 'my_chat'\n                callback : function(message) { }\n            });\n        */\n        'subscribe' : function( args, callback ) {\n            var channel       = args['channel']\n            ,   callback      = callback            || args['callback']\n            ,   callback      = callback            || args['message']\n            ,   auth_key      = args['auth_key']    || AUTH_KEY\n            ,   connect       = args['connect']     || function(){}\n            ,   reconnect     = args['reconnect']   || function(){}\n            ,   disconnect    = args['disconnect']  || function(){}\n            ,   errcb         = args['error']       || function(){}\n            ,   idlecb        = args['idle']        || function(){}\n            ,   presence      = args['presence']    || 0\n            ,   noheresync    = args['noheresync']  || 0\n            ,   backfill      = args['backfill']    || 0\n            ,   timetoken     = args['timetoken']   || 0\n            ,   sub_timeout   = args['timeout']     || SUB_TIMEOUT\n            ,   windowing     = args['windowing']   || SUB_WINDOWING\n            ,   state         = args['state']\n            ,   heartbeat     = args['heartbeat'] || args['pnexpires']\n            ,   restore       = args['restore'];\n\n            // Restore Enabled?\n            SUB_RESTORE = restore;\n\n            // Always Reset the TT\n            TIMETOKEN = timetoken;\n\n            // Make sure we have a Channel\n            if (!channel)       return error('Missing Channel');\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            if (heartbeat || heartbeat === 0) {\n                SELF['set_heartbeat'](heartbeat);\n            }\n\n            // Setup Channel(s)\n            each( (channel.join ? channel.join(',') : ''+channel).split(','),\n            function(channel) {\n                var settings = CHANNELS[channel] || {};\n\n                // Store Channel State\n                CHANNELS[SUB_CHANNEL = channel] = {\n                    name         : channel,\n                    connected    : settings.connected,\n                    disconnected : settings.disconnected,\n                    subscribed   : 1,\n                    callback     : SUB_CALLBACK = callback,\n                    'cipher_key' : args['cipher_key'],\n                    connect      : connect,\n                    disconnect   : disconnect,\n                    reconnect    : reconnect\n                };\n                if (state) {\n                    if (channel in state) {\n                        STATE[channel] = state[channel];\n                    } else {\n                        STATE[channel] = state;\n                    }\n                }\n\n                // Presence Enabled?\n                if (!presence) return;\n\n                // Subscribe Presence Channel\n                SELF['subscribe']({\n                    'channel'  : channel + PRESENCE_SUFFIX,\n                    'callback' : presence,\n                    'restore'  : restore\n                });\n\n                // Presence Subscribed?\n                if (settings.subscribed) return;\n\n                // See Who's Here Now?\n                if (noheresync) return;\n                SELF['here_now']({\n                    'channel'  : channel,\n                    'callback' : function(here) {\n                        each( 'uuids' in here ? here['uuids'] : [],\n                        function(uid) { presence( {\n                            'action'    : 'join',\n                            'uuid'      : uid,\n                            'timestamp' : rnow(),\n                            'occupancy' : here['occupancy'] || 1\n                        }, here, channel ); } );\n                    }\n                });\n            } );\n\n            // Test Network Connection\n            function _test_connection(success) {\n                if (success) {\n                    // Begin Next Socket Connection\n                    timeout( CONNECT, SECOND );\n                }\n                else {\n                    // New Origin on Failed Connection\n                    STD_ORIGIN = nextorigin( ORIGIN, 1 );\n                    SUB_ORIGIN = nextorigin( ORIGIN, 1 );\n\n                    // Re-test Connection\n                    timeout( function() {\n                        SELF['time'](_test_connection);\n                    }, SECOND );\n                }\n\n                // Disconnect & Reconnect\n                each_channel(function(channel){\n                    // Reconnect\n                    if (success && channel.disconnected) {\n                        channel.disconnected = 0;\n                        return channel.reconnect(channel.name);\n                    }\n\n                    // Disconnect\n                    if (!success && !channel.disconnected) {\n                        channel.disconnected = 1;\n                        channel.disconnect(channel.name);\n                    }\n                });\n            }\n\n            // Evented Subscribe\n            function _connect() {\n                var jsonp    = jsonp_cb()\n                ,   channels = generate_channel_list(CHANNELS).join(',');\n\n                // Stop Connection\n                if (!channels) return;\n\n                // Connect to PubNub Subscribe Servers\n                _reset_offline();\n\n                var data = { 'uuid' : UUID, 'auth' : auth_key };\n\n                var st = JSON.stringify(STATE);\n                if (st.length > 2) data['state'] = JSON.stringify(STATE);\n\n                if (PRESENCE_HB) data['heartbeat'] = PRESENCE_HB;\n\n                start_presence_heartbeat();\n                SUB_RECEIVER = xdr({\n                    timeout  : sub_timeout,\n                    callback : jsonp,\n                    fail     : function(response) {\n                        _invoke_error(response, errcb);\n                        //SUB_RECEIVER = null;\n                        SELF['time'](_test_connection);\n                    },\n                    data     : data,\n                    url      : [\n                        SUB_ORIGIN, 'subscribe',\n                        SUBSCRIBE_KEY, encode(channels),\n                        jsonp, TIMETOKEN\n                    ],\n                    success : function(messages) {\n\n                        //SUB_RECEIVER = null;\n                        // Check for Errors\n                        if (!messages || (\n                            typeof messages == 'object' &&\n                            'error' in messages         &&\n                            messages['error']\n                        )) {\n                            errcb(messages['error']);\n                            return timeout( CONNECT, SECOND );\n                        }\n\n                        // User Idle Callback\n                        idlecb(messages[1]);\n\n                        // Restore Previous Connection Point if Needed\n                        TIMETOKEN = !TIMETOKEN               &&\n                                    SUB_RESTORE              &&\n                                    db['get'](SUBSCRIBE_KEY) || messages[1];\n\n                        // Connect\n                        each_channel(function(channel){\n                            if (channel.connected) return;\n                            channel.connected = 1;\n                            channel.connect(channel.name);\n                        });\n\n                        if (RESUMED && !SUB_RESTORE) {\n                                TIMETOKEN = 0;\n                                RESUMED = false;\n                                // Update Saved Timetoken\n                                db['set']( SUBSCRIBE_KEY, 0 );\n                                timeout( _connect, windowing );\n                                return;\n                        }\n\n                        // Invoke Memory Catchup and Receive Up to 100\n                        // Previous Messages from the Queue.\n                        if (backfill) {\n                            TIMETOKEN = 10000;\n                            backfill  = 0;\n                        }\n\n                        // Update Saved Timetoken\n                        db['set']( SUBSCRIBE_KEY, messages[1] );\n\n                        // Route Channel <---> Callback for Message\n                        var next_callback = (function() {\n                            var channels = (messages.length>2?messages[2]:map(\n                                generate_channel_list(CHANNELS), function(chan) { return map(\n                                    Array(messages[0].length)\n                                    .join(',').split(','),\n                                    function() { return chan; }\n                                ) }).join(','));\n                            var list = channels.split(',');\n\n                            return function() {\n                                var channel = list.shift()||SUB_CHANNEL;\n                                return [\n                                    (CHANNELS[channel]||{})\n                                    .callback||SUB_CALLBACK,\n                                    channel.split(PRESENCE_SUFFIX)[0]\n                                ];\n                            };\n                        })();\n\n                        var latency = detect_latency(+messages[1]);\n                        each( messages[0], function(msg) {\n                            var next = next_callback();\n                            var decrypted_msg = decrypt(msg,CHANNELS[next[1]]['cipher_key']);\n                            next[0]( decrypted_msg, messages, next[1], latency);\n                        });\n\n                        timeout( _connect, windowing );\n                    }\n                });\n            }\n\n            CONNECT = function() {\n                _reset_offline();\n                timeout( _connect, windowing );\n            };\n\n            // Reduce Status Flicker\n            if (!READY) return READY_BUFFER.push(CONNECT);\n\n            // Connect Now\n            CONNECT();\n        },\n\n        /*\n            PUBNUB.here_now({ channel : 'my_chat', callback : fun });\n        */\n        'here_now' : function( args, callback ) {\n            var callback = args['callback'] || callback\n            ,   err      = args['error']    || function(){}\n            ,   auth_key = args['auth_key'] || AUTH_KEY\n            ,   channel  = args['channel']\n            ,   jsonp    = jsonp_cb()\n            ,   uuids    = ('uuids' in args) ? args['uuids'] : true\n            ,   state    = args['state']\n            ,   data     = { 'uuid' : UUID, 'auth' : auth_key };\n\n            if (!uuids) data['disable_uuids'] = 1;\n            if (state) data['state'] = 1;\n\n            // Make sure we have a Channel\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            var url = [\n                    STD_ORIGIN, 'v2', 'presence',\n                    'sub_key', SUBSCRIBE_KEY\n                ];\n\n            channel && url.push('channel') && url.push(encode(channel));\n\n            if (jsonp != '0') { data['callback'] = jsonp; }\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : url\n            });\n        },\n\n        /*\n            PUBNUB.current_channels_by_uuid({ channel : 'my_chat', callback : fun });\n        */\n        'where_now' : function( args, callback ) {\n            var callback = args['callback'] || callback\n            ,   err      = args['error']    || function(){}\n            ,   auth_key = args['auth_key'] || AUTH_KEY\n            ,   jsonp    = jsonp_cb()\n            ,   uuid     = args['uuid']     || UUID\n            ,   data     = { 'auth' : auth_key };\n\n            // Make sure we have a Channel\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n\n            if (jsonp != '0') { data['callback'] = jsonp; }\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : [\n                    STD_ORIGIN, 'v2', 'presence',\n                    'sub_key', SUBSCRIBE_KEY,\n                    'uuid', encode(uuid)\n                ]\n            });\n        },\n\n        'state' : function(args, callback) {\n            var callback = args['callback'] || callback || function(r) {}\n            ,   err      = args['error']    || function(){}\n            ,   auth_key = args['auth_key'] || AUTH_KEY\n            ,   jsonp    = jsonp_cb()\n            ,   state    = args['state']\n            ,   uuid     = args['uuid'] || UUID\n            ,   channel  = args['channel']\n            ,   url\n            ,   data     = { 'auth' : auth_key };\n\n            // Make sure we have a Channel\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n            if (!uuid) return error('Missing UUID');\n            if (!channel) return error('Missing Channel');\n\n            if (jsonp != '0') { data['callback'] = jsonp; }\n\n            if (CHANNELS[channel] && CHANNELS[channel].subscribed) STATE[channel] = state;\n\n            data['state'] = JSON.stringify(state);\n\n            if (state) {\n                url      = [\n                    STD_ORIGIN, 'v2', 'presence',\n                    'sub-key', SUBSCRIBE_KEY,\n                    'channel', encode(channel),\n                    'uuid', uuid, 'data'\n                ]\n            } else {\n                url      = [\n                    STD_ORIGIN, 'v2', 'presence',\n                    'sub-key', SUBSCRIBE_KEY,\n                    'channel', encode(channel),\n                    'uuid', encode(uuid)\n                ]\n            }\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : url\n\n            });\n\n        },\n\n        /*\n            PUBNUB.grant({\n                channel  : 'my_chat',\n                callback : fun,\n                error    : fun,\n                ttl      : 24 * 60, // Minutes\n                read     : true,\n                write    : true,\n                auth_key : '3y8uiajdklytowsj'\n            });\n        */\n        'grant' : function( args, callback ) {\n            var callback = args['callback'] || callback\n            ,   err      = args['error']    || function(){}\n            ,   channel  = args['channel']\n            ,   jsonp    = jsonp_cb()\n            ,   ttl      = args['ttl']\n            ,   r        = (args['read'] )?\"1\":\"0\"\n            ,   w        = (args['write'])?\"1\":\"0\"\n            ,   auth_key = args['auth_key'];\n\n            // Make sure we have a Channel\n            if (!channel)       return error('Missing Channel');\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n            if (!PUBLISH_KEY)   return error('Missing Publish Key');\n            if (!SECRET_KEY)    return error('Missing Secret Key');\n\n            var timestamp  = Math.floor(new Date().getTime() / 1000)\n            ,   sign_input = SUBSCRIBE_KEY + \"\\n\" + PUBLISH_KEY + \"\\n\"\n                    + \"grant\" + \"\\n\";\n\n\n            if (auth_key)  sign_input += (\"auth=\" + encode(auth_key) + \"&\");\n            if (jsonp != '0')   sign_input += (\"callback=\" + encode(jsonp) + \"&\") ;\n            if (channel)   sign_input += (\"channel=\" + encode(channel) + \"&\") ;\n\n            sign_input += \"pnsdk=\" + encode(PNSDK) + \"&\"\n                    + \"r=\" + r + \"&\"\n                    + \"timestamp=\" + encode(timestamp);\n                    \n            if (ttl || ttl === 0) sign_input += \"&\" + \"ttl=\" + ttl;\n\n            sign_input += \"&\" + \"w=\" + w;\n            var signature = hmac_SHA256( sign_input, SECRET_KEY );\n\n            signature = signature.replace( /\\+/g, \"-\" );\n            signature = signature.replace( /\\//g, \"_\" );\n\n            var data = {\n                'w'         : w,\n                'r'         : r,\n                'signature' : signature,\n                'channel'   : channel,\n                'timestamp' : timestamp\n            };\n\n            if (jsonp != '0') { data['callback'] = jsonp; }\n            if (ttl || ttl === 0) data['ttl'] = ttl;\n            if (auth_key) data['auth'] = auth_key;\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : [\n                    STD_ORIGIN, 'v1', 'auth', 'grant' ,\n                    'sub-key', SUBSCRIBE_KEY\n                ]\n            });\n        },\n\n        /*\n            PUBNUB.audit({\n                channel  : 'my_chat',\n                callback : fun,\n                error    : fun,\n                read     : true,\n                write    : true,\n                auth_key : '3y8uiajdklytowsj'\n            });\n        */\n        'audit' : function( args, callback ) {\n            var callback = args['callback'] || callback\n            ,   err      = args['error']    || function(){}\n            ,   channel  = args['channel']\n            ,   auth_key = args['auth_key']\n            ,   jsonp    = jsonp_cb();\n\n            // Make sure we have a Channel\n            if (!callback)      return error('Missing Callback');\n            if (!SUBSCRIBE_KEY) return error('Missing Subscribe Key');\n            if (!PUBLISH_KEY)   return error('Missing Publish Key');\n            if (!SECRET_KEY)    return error('Missing Secret Key');\n\n            var timestamp  = Math.floor(new Date().getTime() / 1000)\n            ,   sign_input = SUBSCRIBE_KEY + \"\\n\"\n                + PUBLISH_KEY + \"\\n\"\n                + \"audit\" + \"\\n\";\n\n            if (auth_key)  sign_input += (\"auth=\" + encode(auth_key) + \"&\");\n            if (jsonp != '0')   sign_input += (\"callback=\" + encode(jsonp) + \"&\") ;\n            if (channel)   sign_input += (\"channel=\" + encode(channel) + \"&\") ;\n\n            sign_input += \"pnsdk=\" + encode(PNSDK) + \"&\" + \"timestamp=\" + timestamp;\n\n            var signature = hmac_SHA256( sign_input, SECRET_KEY );\n\n            signature = signature.replace( /\\+/g, \"-\" );\n            signature = signature.replace( /\\//g, \"_\" );\n\n            var data = { 'signature' : signature, 'timestamp' : timestamp };\n\n            if (jsonp != '0') { data['callback'] = jsonp; }\n            if (channel)  data['channel'] = channel;\n            if (auth_key) data['auth']    = auth_key;\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) {\n                    _invoke_error(response, err);\n                },\n                url      : [\n                    STD_ORIGIN, 'v1', 'auth', 'audit' ,\n                    'sub-key', SUBSCRIBE_KEY\n                ]\n            });\n        },\n\n        /*\n            PUBNUB.revoke({\n                channel  : 'my_chat',\n                callback : fun,\n                error    : fun,\n                auth_key : '3y8uiajdklytowsj'\n            });\n        */\n        'revoke' : function( args, callback ) {\n            args['read']  = false;\n            args['write'] = false;\n            SELF['grant']( args, callback );\n        },\n        'set_uuid' : function(uuid) {\n            UUID = uuid;\n            CONNECT();\n        },\n        'get_uuid' : function() {\n            return UUID;\n        },\n        'presence_heartbeat' : function(args) {\n            var callback = args['callback'] || function() {}\n            var err      = args['error']    || function() {}\n            var jsonp    = jsonp_cb();\n            var data     = { 'uuid' : UUID, 'auth' : AUTH_KEY };\n\n            var st = JSON['stringify'](STATE);\n            if (st.length > 2) data['state'] = JSON['stringify'](STATE);\n\n            if (PRESENCE_HB > 0 && PRESENCE_HB < 320) data['heartbeat'] = PRESENCE_HB;\n\n            xdr({\n                callback : jsonp,\n                data     : data,\n                timeout  : SECOND * 5,\n                url      : [\n                    STD_ORIGIN, 'v2', 'presence',\n                    'sub-key', SUBSCRIBE_KEY,\n                    'channel' , encode(generate_channel_list(CHANNELS, true)['join'](',')),\n                    'heartbeat'\n                ],\n                success  : function(response) {\n                    _invoke_callback(response, callback, err);\n                },\n                fail     : function(response) { _invoke_error(response, err); }\n            });\n        },\n\n        // Expose PUBNUB Functions\n        'xdr'           : xdr,\n        'ready'         : ready,\n        'db'            : db,\n        'uuid'          : uuid,\n        'map'           : map,\n        'each'          : each,\n        'each-channel'  : each_channel,\n        'grep'          : grep,\n        'offline'       : function(){_reset_offline(1, { \"message\":\"Offline. Please check your network settings.\" })},\n        'supplant'      : supplant,\n        'now'           : rnow,\n        'unique'        : unique,\n        'updater'       : updater\n    };\n\n    function _poll_online() {\n        _is_online() || _reset_offline( 1, {\n            \"error\" : \"Offline. Please check your network settings. \"\n        });\n        timeout( _poll_online, SECOND );\n    }\n\n    function _poll_online2() {\n        SELF['time'](function(success){\n            detect_time_detla( function(){}, success );\n            success || _reset_offline( 1, {\n                \"error\" : \"Heartbeat failed to connect to Pubnub Servers.\" +\n                    \"Please check your network settings.\"\n                });\n            timeout( _poll_online2, KEEPALIVE );\n        });\n    }\n\n    function _reset_offline(err, msg) {\n        SUB_RECEIVER && SUB_RECEIVER(err, msg);\n        SUB_RECEIVER = null;\n    }\n\n    if (!UUID) UUID = SELF['uuid']();\n    db['set']( SUBSCRIBE_KEY + 'uuid', UUID );\n\n    timeout( _poll_online,  SECOND    );\n    timeout( _poll_online2, KEEPALIVE );\n    PRESENCE_HB_TIMEOUT = timeout( start_presence_heartbeat, ( PRESENCE_HB_INTERVAL - 3 ) * SECOND ) ;\n\n    // Detect Age of Message\n    function detect_latency(tt) {\n        var adjusted_time = rnow() - TIME_DRIFT;\n        return adjusted_time - tt / 10000;\n    }\n\n    detect_time_detla();\n    function detect_time_detla( cb, time ) {\n        var stime = rnow();\n\n        time && calculate(time) || SELF['time'](calculate);\n\n        function calculate(time) {\n            if (!time) return;\n            var ptime   = time / 10000\n            ,   latency = (rnow() - stime) / 2;\n            TIME_DRIFT = rnow() - (ptime + latency);\n            cb && cb(TIME_DRIFT);\n        }\n    }\n\n    return SELF;\n}\n\nvar CRYPTO = (function(){\n    var Nr = 14,\n    /* Default to 256 Bit Encryption */\n    Nk = 8,\n    Decrypt = false,\n\n    enc_utf8 = function(s)\n    {\n        try {\n            return unescape(encodeURIComponent(s));\n        }\n        catch(e) {\n            throw 'Error on UTF-8 encode';\n        }\n    },\n\n    dec_utf8 = function(s)\n    {\n        try {\n            return decodeURIComponent(escape(s));\n        }\n        catch(e) {\n            throw ('Bad Key');\n        }\n    },\n\n    padBlock = function(byteArr)\n    {\n        var array = [], cpad, i;\n        if (byteArr.length < 16) {\n            cpad = 16 - byteArr.length;\n            array = [cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad];\n        }\n        for (i = 0; i < byteArr.length; i++)\n        {\n            array[i] = byteArr[i];\n        }\n        return array;\n    },\n\n    block2s = function(block, lastBlock)\n    {\n        var string = '', padding, i;\n        if (lastBlock) {\n            padding = block[15];\n            if (padding > 16) {\n                throw ('Decryption error: Maybe bad key');\n            }\n            if (padding == 16) {\n                return '';\n            }\n            for (i = 0; i < 16 - padding; i++) {\n                string += String.fromCharCode(block[i]);\n            }\n        } else {\n            for (i = 0; i < 16; i++) {\n                string += String.fromCharCode(block[i]);\n            }\n        }\n        return string;\n    },\n\n    a2h = function(numArr)\n    {\n        var string = '', i;\n        for (i = 0; i < numArr.length; i++) {\n            string += (numArr[i] < 16 ? '0': '') + numArr[i].toString(16);\n        }\n        return string;\n    },\n\n    h2a = function(s)\n    {\n        var ret = [];\n        s.replace(/(..)/g,\n        function(s) {\n            ret.push(parseInt(s, 16));\n        });\n        return ret;\n    },\n\n    s2a = function(string, binary) {\n        var array = [], i;\n\n        if (! binary) {\n            string = enc_utf8(string);\n        }\n\n        for (i = 0; i < string.length; i++)\n        {\n            array[i] = string.charCodeAt(i);\n        }\n\n        return array;\n    },\n\n    size = function(newsize)\n    {\n        switch (newsize)\n        {\n        case 128:\n            Nr = 10;\n            Nk = 4;\n            break;\n        case 192:\n            Nr = 12;\n            Nk = 6;\n            break;\n        case 256:\n            Nr = 14;\n            Nk = 8;\n            break;\n        default:\n            throw ('Invalid Key Size Specified:' + newsize);\n        }\n    },\n\n    randArr = function(num) {\n        var result = [], i;\n        for (i = 0; i < num; i++) {\n            result = result.concat(Math.floor(Math.random() * 256));\n        }\n        return result;\n    },\n\n    openSSLKey = function(passwordArr, saltArr) {\n        // Number of rounds depends on the size of the AES in use\n        // 3 rounds for 256\n        //        2 rounds for the key, 1 for the IV\n        // 2 rounds for 128\n        //        1 round for the key, 1 round for the IV\n        // 3 rounds for 192 since it's not evenly divided by 128 bits\n        var rounds = Nr >= 12 ? 3: 2,\n        key = [],\n        iv = [],\n        md5_hash = [],\n        result = [],\n        data00 = passwordArr.concat(saltArr),\n        i;\n        md5_hash[0] = GibberishAES.Hash.MD5(data00);\n        result = md5_hash[0];\n        for (i = 1; i < rounds; i++) {\n            md5_hash[i] = GibberishAES.Hash.MD5(md5_hash[i - 1].concat(data00));\n            result = result.concat(md5_hash[i]);\n        }\n        key = result.slice(0, 4 * Nk);\n        iv = result.slice(4 * Nk, 4 * Nk + 16);\n        return {\n            key: key,\n            iv: iv\n        };\n    },\n\n    rawEncrypt = function(plaintext, key, iv) {\n        // plaintext, key and iv as byte arrays\n        key = expandKey(key);\n        var numBlocks = Math.ceil(plaintext.length / 16),\n        blocks = [],\n        i,\n        cipherBlocks = [];\n        for (i = 0; i < numBlocks; i++) {\n            blocks[i] = padBlock(plaintext.slice(i * 16, i * 16 + 16));\n        }\n        if (plaintext.length % 16 === 0) {\n            blocks.push([16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]);\n            // CBC OpenSSL padding scheme\n            numBlocks++;\n        }\n        for (i = 0; i < blocks.length; i++) {\n            blocks[i] = (i === 0) ? xorBlocks(blocks[i], iv) : xorBlocks(blocks[i], cipherBlocks[i - 1]);\n            cipherBlocks[i] = encryptBlock(blocks[i], key);\n        }\n        return cipherBlocks;\n    },\n\n    rawDecrypt = function(cryptArr, key, iv, binary) {\n        //  cryptArr, key and iv as byte arrays\n        key = expandKey(key);\n        var numBlocks = cryptArr.length / 16,\n        cipherBlocks = [],\n        i,\n        plainBlocks = [],\n        string = '';\n        for (i = 0; i < numBlocks; i++) {\n            cipherBlocks.push(cryptArr.slice(i * 16, (i + 1) * 16));\n        }\n        for (i = cipherBlocks.length - 1; i >= 0; i--) {\n            plainBlocks[i] = decryptBlock(cipherBlocks[i], key);\n            plainBlocks[i] = (i === 0) ? xorBlocks(plainBlocks[i], iv) : xorBlocks(plainBlocks[i], cipherBlocks[i - 1]);\n        }\n        for (i = 0; i < numBlocks - 1; i++) {\n            string += block2s(plainBlocks[i]);\n        }\n        string += block2s(plainBlocks[i], true);\n        return binary ? string : dec_utf8(string);\n    },\n\n    encryptBlock = function(block, words) {\n        Decrypt = false;\n        var state = addRoundKey(block, words, 0),\n        round;\n        for (round = 1; round < (Nr + 1); round++) {\n            state = subBytes(state);\n            state = shiftRows(state);\n            if (round < Nr) {\n                state = mixColumns(state);\n            }\n            //last round? don't mixColumns\n            state = addRoundKey(state, words, round);\n        }\n\n        return state;\n    },\n\n    decryptBlock = function(block, words) {\n        Decrypt = true;\n        var state = addRoundKey(block, words, Nr),\n        round;\n        for (round = Nr - 1; round > -1; round--) {\n            state = shiftRows(state);\n            state = subBytes(state);\n            state = addRoundKey(state, words, round);\n            if (round > 0) {\n                state = mixColumns(state);\n            }\n            //last round? don't mixColumns\n        }\n\n        return state;\n    },\n\n    subBytes = function(state) {\n        var S = Decrypt ? SBoxInv: SBox,\n        temp = [],\n        i;\n        for (i = 0; i < 16; i++) {\n            temp[i] = S[state[i]];\n        }\n        return temp;\n    },\n\n    shiftRows = function(state) {\n        var temp = [],\n        shiftBy = Decrypt ? [0, 13, 10, 7, 4, 1, 14, 11, 8, 5, 2, 15, 12, 9, 6, 3] : [0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12, 1, 6, 11],\n        i;\n        for (i = 0; i < 16; i++) {\n            temp[i] = state[shiftBy[i]];\n        }\n        return temp;\n    },\n\n    mixColumns = function(state) {\n        var t = [],\n        c;\n        if (!Decrypt) {\n            for (c = 0; c < 4; c++) {\n                t[c * 4] = G2X[state[c * 4]] ^ G3X[state[1 + c * 4]] ^ state[2 + c * 4] ^ state[3 + c * 4];\n                t[1 + c * 4] = state[c * 4] ^ G2X[state[1 + c * 4]] ^ G3X[state[2 + c * 4]] ^ state[3 + c * 4];\n                t[2 + c * 4] = state[c * 4] ^ state[1 + c * 4] ^ G2X[state[2 + c * 4]] ^ G3X[state[3 + c * 4]];\n                t[3 + c * 4] = G3X[state[c * 4]] ^ state[1 + c * 4] ^ state[2 + c * 4] ^ G2X[state[3 + c * 4]];\n            }\n        }else {\n            for (c = 0; c < 4; c++) {\n                t[c*4] = GEX[state[c*4]] ^ GBX[state[1+c*4]] ^ GDX[state[2+c*4]] ^ G9X[state[3+c*4]];\n                t[1+c*4] = G9X[state[c*4]] ^ GEX[state[1+c*4]] ^ GBX[state[2+c*4]] ^ GDX[state[3+c*4]];\n                t[2+c*4] = GDX[state[c*4]] ^ G9X[state[1+c*4]] ^ GEX[state[2+c*4]] ^ GBX[state[3+c*4]];\n                t[3+c*4] = GBX[state[c*4]] ^ GDX[state[1+c*4]] ^ G9X[state[2+c*4]] ^ GEX[state[3+c*4]];\n            }\n        }\n\n        return t;\n    },\n\n    addRoundKey = function(state, words, round) {\n        var temp = [],\n        i;\n        for (i = 0; i < 16; i++) {\n            temp[i] = state[i] ^ words[round][i];\n        }\n        return temp;\n    },\n\n    xorBlocks = function(block1, block2) {\n        var temp = [],\n        i;\n        for (i = 0; i < 16; i++) {\n            temp[i] = block1[i] ^ block2[i];\n        }\n        return temp;\n    },\n\n    expandKey = function(key) {\n        // Expects a 1d number array\n        var w = [],\n        temp = [],\n        i,\n        r,\n        t,\n        flat = [],\n        j;\n\n        for (i = 0; i < Nk; i++) {\n            r = [key[4 * i], key[4 * i + 1], key[4 * i + 2], key[4 * i + 3]];\n            w[i] = r;\n        }\n\n        for (i = Nk; i < (4 * (Nr + 1)); i++) {\n            w[i] = [];\n            for (t = 0; t < 4; t++) {\n                temp[t] = w[i - 1][t];\n            }\n            if (i % Nk === 0) {\n                temp = subWord(rotWord(temp));\n                temp[0] ^= Rcon[i / Nk - 1];\n            } else if (Nk > 6 && i % Nk == 4) {\n                temp = subWord(temp);\n            }\n            for (t = 0; t < 4; t++) {\n                w[i][t] = w[i - Nk][t] ^ temp[t];\n            }\n        }\n        for (i = 0; i < (Nr + 1); i++) {\n            flat[i] = [];\n            for (j = 0; j < 4; j++) {\n                flat[i].push(w[i * 4 + j][0], w[i * 4 + j][1], w[i * 4 + j][2], w[i * 4 + j][3]);\n            }\n        }\n        return flat;\n    },\n\n    subWord = function(w) {\n        // apply SBox to 4-byte word w\n        for (var i = 0; i < 4; i++) {\n            w[i] = SBox[w[i]];\n        }\n        return w;\n    },\n\n    rotWord = function(w) {\n        // rotate 4-byte word w left by one byte\n        var tmp = w[0],\n        i;\n        for (i = 0; i < 4; i++) {\n            w[i] = w[i + 1];\n        }\n        w[3] = tmp;\n        return w;\n    },\n\n// jlcooke: 2012-07-12: added strhex + invertArr to compress G2X/G3X/G9X/GBX/GEX/SBox/SBoxInv/Rcon saving over 7KB, and added encString, decString\n    strhex = function(str,size) {\n        var ret = [];\n        for (i=0; i<str.length; i+=size)\n            ret[i/size] = parseInt(str.substr(i,size), 16);\n        return ret;\n    },\n    invertArr = function(arr) {\n        var ret = [];\n        for (i=0; i<arr.length; i++)\n            ret[arr[i]] = i;\n        return ret;\n    },\n    Gxx = function(a, b) {\n        var i, ret;\n\n        ret = 0;\n        for (i=0; i<8; i++) {\n            ret = ((b&1)==1) ? ret^a : ret;\n            /* xmult */\n            a = (a>0x7f) ? 0x11b^(a<<1) : (a<<1);\n            b >>>= 1;\n        }\n\n        return ret;\n    },\n    Gx = function(x) {\n        var r = [];\n        for (var i=0; i<256; i++)\n            r[i] = Gxx(x, i);\n        return r;\n    },\n\n    // S-box\n/*\n    SBox = [\n    99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171,\n    118, 202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164,\n    114, 192, 183, 253, 147, 38, 54, 63, 247, 204, 52, 165, 229, 241, 113,\n    216, 49, 21, 4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226,\n    235, 39, 178, 117, 9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214,\n    179, 41, 227, 47, 132, 83, 209, 0, 237, 32, 252, 177, 91, 106, 203,\n    190, 57, 74, 76, 88, 207, 208, 239, 170, 251, 67, 77, 51, 133, 69,\n    249, 2, 127, 80, 60, 159, 168, 81, 163, 64, 143, 146, 157, 56, 245,\n    188, 182, 218, 33, 16, 255, 243, 210, 205, 12, 19, 236, 95, 151, 68,\n    23, 196, 167, 126, 61, 100, 93, 25, 115, 96, 129, 79, 220, 34, 42,\n    144, 136, 70, 238, 184, 20, 222, 94, 11, 219, 224, 50, 58, 10, 73,\n    6, 36, 92, 194, 211, 172, 98, 145, 149, 228, 121, 231, 200, 55, 109,\n    141, 213, 78, 169, 108, 86, 244, 234, 101, 122, 174, 8, 186, 120, 37,\n    46, 28, 166, 180, 198, 232, 221, 116, 31, 75, 189, 139, 138, 112, 62,\n    181, 102, 72, 3, 246, 14, 97, 53, 87, 185, 134, 193, 29, 158, 225,\n    248, 152, 17, 105, 217, 142, 148, 155, 30, 135, 233, 206, 85, 40, 223,\n    140, 161, 137, 13, 191, 230, 66, 104, 65, 153, 45, 15, 176, 84, 187,\n    22], //*/ SBox = strhex('637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16',2),\n\n    // Precomputed lookup table for the inverse SBox\n/*    SBoxInv = [\n    82, 9, 106, 213, 48, 54, 165, 56, 191, 64, 163, 158, 129, 243, 215,\n    251, 124, 227, 57, 130, 155, 47, 255, 135, 52, 142, 67, 68, 196, 222,\n    233, 203, 84, 123, 148, 50, 166, 194, 35, 61, 238, 76, 149, 11, 66,\n    250, 195, 78, 8, 46, 161, 102, 40, 217, 36, 178, 118, 91, 162, 73,\n    109, 139, 209, 37, 114, 248, 246, 100, 134, 104, 152, 22, 212, 164, 92,\n    204, 93, 101, 182, 146, 108, 112, 72, 80, 253, 237, 185, 218, 94, 21,\n    70, 87, 167, 141, 157, 132, 144, 216, 171, 0, 140, 188, 211, 10, 247,\n    228, 88, 5, 184, 179, 69, 6, 208, 44, 30, 143, 202, 63, 15, 2,\n    193, 175, 189, 3, 1, 19, 138, 107, 58, 145, 17, 65, 79, 103, 220,\n    234, 151, 242, 207, 206, 240, 180, 230, 115, 150, 172, 116, 34, 231, 173,\n    53, 133, 226, 249, 55, 232, 28, 117, 223, 110, 71, 241, 26, 113, 29,\n    41, 197, 137, 111, 183, 98, 14, 170, 24, 190, 27, 252, 86, 62, 75,\n    198, 210, 121, 32, 154, 219, 192, 254, 120, 205, 90, 244, 31, 221, 168,\n    51, 136, 7, 199, 49, 177, 18, 16, 89, 39, 128, 236, 95, 96, 81,\n    127, 169, 25, 181, 74, 13, 45, 229, 122, 159, 147, 201, 156, 239, 160,\n    224, 59, 77, 174, 42, 245, 176, 200, 235, 187, 60, 131, 83, 153, 97,\n    23, 43, 4, 126, 186, 119, 214, 38, 225, 105, 20, 99, 85, 33, 12,\n    125], //*/ SBoxInv = invertArr(SBox),\n\n    // Rijndael Rcon\n/*\n    Rcon = [1, 2, 4, 8, 16, 32, 64, 128, 27, 54, 108, 216, 171, 77, 154, 47, 94,\n    188, 99, 198, 151, 53, 106, 212, 179, 125, 250, 239, 197, 145],\n//*/ Rcon = strhex('01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591',2),\n\n/*\n    G2X = [\n    0x00, 0x02, 0x04, 0x06, 0x08, 0x0a, 0x0c, 0x0e, 0x10, 0x12, 0x14, 0x16,\n    0x18, 0x1a, 0x1c, 0x1e, 0x20, 0x22, 0x24, 0x26, 0x28, 0x2a, 0x2c, 0x2e,\n    0x30, 0x32, 0x34, 0x36, 0x38, 0x3a, 0x3c, 0x3e, 0x40, 0x42, 0x44, 0x46,\n    0x48, 0x4a, 0x4c, 0x4e, 0x50, 0x52, 0x54, 0x56, 0x58, 0x5a, 0x5c, 0x5e,\n    0x60, 0x62, 0x64, 0x66, 0x68, 0x6a, 0x6c, 0x6e, 0x70, 0x72, 0x74, 0x76,\n    0x78, 0x7a, 0x7c, 0x7e, 0x80, 0x82, 0x84, 0x86, 0x88, 0x8a, 0x8c, 0x8e,\n    0x90, 0x92, 0x94, 0x96, 0x98, 0x9a, 0x9c, 0x9e, 0xa0, 0xa2, 0xa4, 0xa6,\n    0xa8, 0xaa, 0xac, 0xae, 0xb0, 0xb2, 0xb4, 0xb6, 0xb8, 0xba, 0xbc, 0xbe,\n    0xc0, 0xc2, 0xc4, 0xc6, 0xc8, 0xca, 0xcc, 0xce, 0xd0, 0xd2, 0xd4, 0xd6,\n    0xd8, 0xda, 0xdc, 0xde, 0xe0, 0xe2, 0xe4, 0xe6, 0xe8, 0xea, 0xec, 0xee,\n    0xf0, 0xf2, 0xf4, 0xf6, 0xf8, 0xfa, 0xfc, 0xfe, 0x1b, 0x19, 0x1f, 0x1d,\n    0x13, 0x11, 0x17, 0x15, 0x0b, 0x09, 0x0f, 0x0d, 0x03, 0x01, 0x07, 0x05,\n    0x3b, 0x39, 0x3f, 0x3d, 0x33, 0x31, 0x37, 0x35, 0x2b, 0x29, 0x2f, 0x2d,\n    0x23, 0x21, 0x27, 0x25, 0x5b, 0x59, 0x5f, 0x5d, 0x53, 0x51, 0x57, 0x55,\n    0x4b, 0x49, 0x4f, 0x4d, 0x43, 0x41, 0x47, 0x45, 0x7b, 0x79, 0x7f, 0x7d,\n    0x73, 0x71, 0x77, 0x75, 0x6b, 0x69, 0x6f, 0x6d, 0x63, 0x61, 0x67, 0x65,\n    0x9b, 0x99, 0x9f, 0x9d, 0x93, 0x91, 0x97, 0x95, 0x8b, 0x89, 0x8f, 0x8d,\n    0x83, 0x81, 0x87, 0x85, 0xbb, 0xb9, 0xbf, 0xbd, 0xb3, 0xb1, 0xb7, 0xb5,\n    0xab, 0xa9, 0xaf, 0xad, 0xa3, 0xa1, 0xa7, 0xa5, 0xdb, 0xd9, 0xdf, 0xdd,\n    0xd3, 0xd1, 0xd7, 0xd5, 0xcb, 0xc9, 0xcf, 0xcd, 0xc3, 0xc1, 0xc7, 0xc5,\n    0xfb, 0xf9, 0xff, 0xfd, 0xf3, 0xf1, 0xf7, 0xf5, 0xeb, 0xe9, 0xef, 0xed,\n    0xe3, 0xe1, 0xe7, 0xe5\n    ], //*/ G2X = Gx(2),\n\n/*    G3X = [\n    0x00, 0x03, 0x06, 0x05, 0x0c, 0x0f, 0x0a, 0x09, 0x18, 0x1b, 0x1e, 0x1d,\n    0x14, 0x17, 0x12, 0x11, 0x30, 0x33, 0x36, 0x35, 0x3c, 0x3f, 0x3a, 0x39,\n    0x28, 0x2b, 0x2e, 0x2d, 0x24, 0x27, 0x22, 0x21, 0x60, 0x63, 0x66, 0x65,\n    0x6c, 0x6f, 0x6a, 0x69, 0x78, 0x7b, 0x7e, 0x7d, 0x74, 0x77, 0x72, 0x71,\n    0x50, 0x53, 0x56, 0x55, 0x5c, 0x5f, 0x5a, 0x59, 0x48, 0x4b, 0x4e, 0x4d,\n    0x44, 0x47, 0x42, 0x41, 0xc0, 0xc3, 0xc6, 0xc5, 0xcc, 0xcf, 0xca, 0xc9,\n    0xd8, 0xdb, 0xde, 0xdd, 0xd4, 0xd7, 0xd2, 0xd1, 0xf0, 0xf3, 0xf6, 0xf5,\n    0xfc, 0xff, 0xfa, 0xf9, 0xe8, 0xeb, 0xee, 0xed, 0xe4, 0xe7, 0xe2, 0xe1,\n    0xa0, 0xa3, 0xa6, 0xa5, 0xac, 0xaf, 0xaa, 0xa9, 0xb8, 0xbb, 0xbe, 0xbd,\n    0xb4, 0xb7, 0xb2, 0xb1, 0x90, 0x93, 0x96, 0x95, 0x9c, 0x9f, 0x9a, 0x99,\n    0x88, 0x8b, 0x8e, 0x8d, 0x84, 0x87, 0x82, 0x81, 0x9b, 0x98, 0x9d, 0x9e,\n    0x97, 0x94, 0x91, 0x92, 0x83, 0x80, 0x85, 0x86, 0x8f, 0x8c, 0x89, 0x8a,\n    0xab, 0xa8, 0xad, 0xae, 0xa7, 0xa4, 0xa1, 0xa2, 0xb3, 0xb0, 0xb5, 0xb6,\n    0xbf, 0xbc, 0xb9, 0xba, 0xfb, 0xf8, 0xfd, 0xfe, 0xf7, 0xf4, 0xf1, 0xf2,\n    0xe3, 0xe0, 0xe5, 0xe6, 0xef, 0xec, 0xe9, 0xea, 0xcb, 0xc8, 0xcd, 0xce,\n    0xc7, 0xc4, 0xc1, 0xc2, 0xd3, 0xd0, 0xd5, 0xd6, 0xdf, 0xdc, 0xd9, 0xda,\n    0x5b, 0x58, 0x5d, 0x5e, 0x57, 0x54, 0x51, 0x52, 0x43, 0x40, 0x45, 0x46,\n    0x4f, 0x4c, 0x49, 0x4a, 0x6b, 0x68, 0x6d, 0x6e, 0x67, 0x64, 0x61, 0x62,\n    0x73, 0x70, 0x75, 0x76, 0x7f, 0x7c, 0x79, 0x7a, 0x3b, 0x38, 0x3d, 0x3e,\n    0x37, 0x34, 0x31, 0x32, 0x23, 0x20, 0x25, 0x26, 0x2f, 0x2c, 0x29, 0x2a,\n    0x0b, 0x08, 0x0d, 0x0e, 0x07, 0x04, 0x01, 0x02, 0x13, 0x10, 0x15, 0x16,\n    0x1f, 0x1c, 0x19, 0x1a\n    ], //*/ G3X = Gx(3),\n\n/*\n    G9X = [\n    0x00, 0x09, 0x12, 0x1b, 0x24, 0x2d, 0x36, 0x3f, 0x48, 0x41, 0x5a, 0x53,\n    0x6c, 0x65, 0x7e, 0x77, 0x90, 0x99, 0x82, 0x8b, 0xb4, 0xbd, 0xa6, 0xaf,\n    0xd8, 0xd1, 0xca, 0xc3, 0xfc, 0xf5, 0xee, 0xe7, 0x3b, 0x32, 0x29, 0x20,\n    0x1f, 0x16, 0x0d, 0x04, 0x73, 0x7a, 0x61, 0x68, 0x57, 0x5e, 0x45, 0x4c,\n    0xab, 0xa2, 0xb9, 0xb0, 0x8f, 0x86, 0x9d, 0x94, 0xe3, 0xea, 0xf1, 0xf8,\n    0xc7, 0xce, 0xd5, 0xdc, 0x76, 0x7f, 0x64, 0x6d, 0x52, 0x5b, 0x40, 0x49,\n    0x3e, 0x37, 0x2c, 0x25, 0x1a, 0x13, 0x08, 0x01, 0xe6, 0xef, 0xf4, 0xfd,\n    0xc2, 0xcb, 0xd0, 0xd9, 0xae, 0xa7, 0xbc, 0xb5, 0x8a, 0x83, 0x98, 0x91,\n    0x4d, 0x44, 0x5f, 0x56, 0x69, 0x60, 0x7b, 0x72, 0x05, 0x0c, 0x17, 0x1e,\n    0x21, 0x28, 0x33, 0x3a, 0xdd, 0xd4, 0xcf, 0xc6, 0xf9, 0xf0, 0xeb, 0xe2,\n    0x95, 0x9c, 0x87, 0x8e, 0xb1, 0xb8, 0xa3, 0xaa, 0xec, 0xe5, 0xfe, 0xf7,\n    0xc8, 0xc1, 0xda, 0xd3, 0xa4, 0xad, 0xb6, 0xbf, 0x80, 0x89, 0x92, 0x9b,\n    0x7c, 0x75, 0x6e, 0x67, 0x58, 0x51, 0x4a, 0x43, 0x34, 0x3d, 0x26, 0x2f,\n    0x10, 0x19, 0x02, 0x0b, 0xd7, 0xde, 0xc5, 0xcc, 0xf3, 0xfa, 0xe1, 0xe8,\n    0x9f, 0x96, 0x8d, 0x84, 0xbb, 0xb2, 0xa9, 0xa0, 0x47, 0x4e, 0x55, 0x5c,\n    0x63, 0x6a, 0x71, 0x78, 0x0f, 0x06, 0x1d, 0x14, 0x2b, 0x22, 0x39, 0x30,\n    0x9a, 0x93, 0x88, 0x81, 0xbe, 0xb7, 0xac, 0xa5, 0xd2, 0xdb, 0xc0, 0xc9,\n    0xf6, 0xff, 0xe4, 0xed, 0x0a, 0x03, 0x18, 0x11, 0x2e, 0x27, 0x3c, 0x35,\n    0x42, 0x4b, 0x50, 0x59, 0x66, 0x6f, 0x74, 0x7d, 0xa1, 0xa8, 0xb3, 0xba,\n    0x85, 0x8c, 0x97, 0x9e, 0xe9, 0xe0, 0xfb, 0xf2, 0xcd, 0xc4, 0xdf, 0xd6,\n    0x31, 0x38, 0x23, 0x2a, 0x15, 0x1c, 0x07, 0x0e, 0x79, 0x70, 0x6b, 0x62,\n    0x5d, 0x54, 0x4f, 0x46\n    ], //*/ G9X = Gx(9),\n\n/*    GBX = [\n    0x00, 0x0b, 0x16, 0x1d, 0x2c, 0x27, 0x3a, 0x31, 0x58, 0x53, 0x4e, 0x45,\n    0x74, 0x7f, 0x62, 0x69, 0xb0, 0xbb, 0xa6, 0xad, 0x9c, 0x97, 0x8a, 0x81,\n    0xe8, 0xe3, 0xfe, 0xf5, 0xc4, 0xcf, 0xd2, 0xd9, 0x7b, 0x70, 0x6d, 0x66,\n    0x57, 0x5c, 0x41, 0x4a, 0x23, 0x28, 0x35, 0x3e, 0x0f, 0x04, 0x19, 0x12,\n    0xcb, 0xc0, 0xdd, 0xd6, 0xe7, 0xec, 0xf1, 0xfa, 0x93, 0x98, 0x85, 0x8e,\n    0xbf, 0xb4, 0xa9, 0xa2, 0xf6, 0xfd, 0xe0, 0xeb, 0xda, 0xd1, 0xcc, 0xc7,\n    0xae, 0xa5, 0xb8, 0xb3, 0x82, 0x89, 0x94, 0x9f, 0x46, 0x4d, 0x50, 0x5b,\n    0x6a, 0x61, 0x7c, 0x77, 0x1e, 0x15, 0x08, 0x03, 0x32, 0x39, 0x24, 0x2f,\n    0x8d, 0x86, 0x9b, 0x90, 0xa1, 0xaa, 0xb7, 0xbc, 0xd5, 0xde, 0xc3, 0xc8,\n    0xf9, 0xf2, 0xef, 0xe4, 0x3d, 0x36, 0x2b, 0x20, 0x11, 0x,1a, 0x07, 0x0c,\n    0x65, 0x6e, 0x73, 0x78, 0x49, 0x42, 0x5f, 0x54, 0xf7, 0xfc, 0xe1, 0xea,\n    0xdb, 0xd0, 0xcd, 0xc6, 0xaf, 0xa4, 0xb9, 0xb2, 0x83, 0x88, 0x95, 0x9e,\n    0x47, 0x4c, 0x51, 0x5a, 0x6b, 0x60, 0x7d, 0x76, 0x1f, 0x14, 0x09, 0x02,\n    0x33, 0x38, 0x25, 0x2e, 0x8c, 0x87, 0x9a, 0x91, 0xa0, 0xab, 0xb6, 0xbd,\n    0xd4, 0xdf, 0xc2, 0xc9, 0xf8, 0xf3, 0xee, 0xe5, 0x3c, 0x37, 0x2a, 0x21,\n    0x10, 0x1b, 0x06, 0x0d, 0x64, 0x6f, 0x72, 0x79, 0x48, 0x43, 0x5e, 0x55,\n    0x01, 0x0a, 0x17, 0x1c, 0x2d, 0x26, 0x3b, 0x30, 0x59, 0x52, 0x4f, 0x44,\n    0x75, 0x7e, 0x63, 0x68, 0xb1, 0xba, 0xa7, 0xac, 0x9d, 0x96, 0x8b, 0x80,\n    0xe9, 0xe2, 0xff, 0xf4, 0xc5, 0xce, 0xd3, 0xd8, 0x7a, 0x71, 0x6c, 0x67,\n    0x56, 0x5d, 0x40, 0x4b, 0x22, 0x29, 0x34, 0x3f, 0x0e, 0x05, 0x18, 0x13,\n    0xca, 0xc1, 0xdc, 0xd7, 0xe6, 0xed, 0xf0, 0xfb, 0x92, 0x99, 0x84, 0x8f,\n    0xbe, 0xb5, 0xa8, 0xa3\n    ], //*/ GBX = Gx(0xb),\n\n/*\n    GDX = [\n    0x00, 0x0d, 0x1a, 0x17, 0x34, 0x39, 0x2e, 0x23, 0x68, 0x65, 0x72, 0x7f,\n    0x5c, 0x51, 0x46, 0x4b, 0xd0, 0xdd, 0xca, 0xc7, 0xe4, 0xe9, 0xfe, 0xf3,\n    0xb8, 0xb5, 0xa2, 0xaf, 0x8c, 0x81, 0x96, 0x9b, 0xbb, 0xb6, 0xa1, 0xac,\n    0x8f, 0x82, 0x95, 0x98, 0xd3, 0xde, 0xc9, 0xc4, 0xe7, 0xea, 0xfd, 0xf0,\n    0x6b, 0x66, 0x71, 0x7c, 0x5f, 0x52, 0x45, 0x48, 0x03, 0x0e, 0x19, 0x14,\n    0x37, 0x3a, 0x2d, 0x20, 0x6d, 0x60, 0x77, 0x7a, 0x59, 0x54, 0x43, 0x4e,\n    0x05, 0x08, 0x1f, 0x12, 0x31, 0x3c, 0x2b, 0x26, 0xbd, 0xb0, 0xa7, 0xaa,\n    0x89, 0x84, 0x93, 0x9e, 0xd5, 0xd8, 0xcf, 0xc2, 0xe1, 0xec, 0xfb, 0xf6,\n    0xd6, 0xdb, 0xcc, 0xc1, 0xe2, 0xef, 0xf8, 0xf5, 0xbe, 0xb3, 0xa4, 0xa9,\n    0x8a, 0x87, 0x90, 0x9d, 0x06, 0x0b, 0x1c, 0x11, 0x32, 0x3f, 0x28, 0x25,\n    0x6e, 0x63, 0x74, 0x79, 0x5a, 0x57, 0x40, 0x4d, 0xda, 0xd7, 0xc0, 0xcd,\n    0xee, 0xe3, 0xf4, 0xf9, 0xb2, 0xbf, 0xa8, 0xa5, 0x86, 0x8b, 0x9c, 0x91,\n    0x0a, 0x07, 0x10, 0x1d, 0x3e, 0x33, 0x24, 0x29, 0x62, 0x6f, 0x78, 0x75,\n    0x56, 0x5b, 0x4c, 0x41, 0x61, 0x6c, 0x7b, 0x76, 0x55, 0x58, 0x4f, 0x42,\n    0x09, 0x04, 0x13, 0x1e, 0x3d, 0x30, 0x27, 0x2a, 0xb1, 0xbc, 0xab, 0xa6,\n    0x85, 0x88, 0x9f, 0x92, 0xd9, 0xd4, 0xc3, 0xce, 0xed, 0xe0, 0xf7, 0xfa,\n    0xb7, 0xba, 0xad, 0xa0, 0x83, 0x8e, 0x99, 0x94, 0xdf, 0xd2, 0xc5, 0xc8,\n    0xeb, 0xe6, 0xf1, 0xfc, 0x67, 0x6a, 0x7d, 0x70, 0x53, 0x5e, 0x49, 0x44,\n    0x0f, 0x02, 0x15, 0x18, 0x3b, 0x36, 0x21, 0x2c, 0x0c, 0x01, 0x16, 0x1b,\n    0x38, 0x35, 0x22, 0x2f, 0x64, 0x69, 0x7e, 0x73, 0x50, 0x5d, 0x4a, 0x47,\n    0xdc, 0xd1, 0xc6, 0xcb, 0xe8, 0xe5, 0xf2, 0xff, 0xb4, 0xb9, 0xae, 0xa3,\n    0x80, 0x8d, 0x9a, 0x97\n    ], //*/ GDX = Gx(0xd),\n\n/*\n    GEX = [\n    0x00, 0x0e, 0x1c, 0x12, 0x38, 0x36, 0x24, 0x2a, 0x70, 0x7e, 0x6c, 0x62,\n    0x48, 0x46, 0x54, 0x5a, 0xe0, 0xee, 0xfc, 0xf2, 0xd8, 0xd6, 0xc4, 0xca,\n    0x90, 0x9e, 0x8c, 0x82, 0xa8, 0xa6, 0xb4, 0xba, 0xdb, 0xd5, 0xc7, 0xc9,\n    0xe3, 0xed, 0xff, 0xf1, 0xab, 0xa5, 0xb7, 0xb9, 0x93, 0x9d, 0x8f, 0x81,\n    0x3b, 0x35, 0x27, 0x29, 0x03, 0x0d, 0x1f, 0x11, 0x4b, 0x45, 0x57, 0x59,\n    0x73, 0x7d, 0x6f, 0x61, 0xad, 0xa3, 0xb1, 0xbf, 0x95, 0x9b, 0x89, 0x87,\n    0xdd, 0xd3, 0xc1, 0xcf, 0xe5, 0xeb, 0xf9, 0xf7, 0x4d, 0x43, 0x51, 0x5f,\n    0x75, 0x7b, 0x69, 0x67, 0x3d, 0x33, 0x21, 0x2f, 0x05, 0x0b, 0x19, 0x17,\n    0x76, 0x78, 0x6a, 0x64, 0x4e, 0x40, 0x52, 0x5c, 0x06, 0x08, 0x1a, 0x14,\n    0x3e, 0x30, 0x22, 0x2c, 0x96, 0x98, 0x8a, 0x84, 0xae, 0xa0, 0xb2, 0xbc,\n    0xe6, 0xe8, 0xfa, 0xf4, 0xde, 0xd0, 0xc2, 0xcc, 0x41, 0x4f, 0x5d, 0x53,\n    0x79, 0x77, 0x65, 0x6b, 0x31, 0x3f, 0x2d, 0x23, 0x09, 0x07, 0x15, 0x1b,\n    0xa1, 0xaf, 0xbd, 0xb3, 0x99, 0x97, 0x85, 0x8b, 0xd1, 0xdf, 0xcd, 0xc3,\n    0xe9, 0xe7, 0xf5, 0xfb, 0x9a, 0x94, 0x86, 0x88, 0xa2, 0xac, 0xbe, 0xb0,\n    0xea, 0xe4, 0xf6, 0xf8, 0xd2, 0xdc, 0xce, 0xc0, 0x7a, 0x74, 0x66, 0x68,\n    0x42, 0x4c, 0x5e, 0x50, 0x0a, 0x04, 0x16, 0x18, 0x32, 0x3c, 0x2e, 0x20,\n    0xec, 0xe2, 0xf0, 0xfe, 0xd4, 0xda, 0xc8, 0xc6, 0x9c, 0x92, 0x80, 0x8e,\n    0xa4, 0xaa, 0xb8, 0xb6, 0x0c, 0x02, 0x10, 0x1e, 0x34, 0x3a, 0x28, 0x26,\n    0x7c, 0x72, 0x60, 0x6e, 0x44, 0x4a, 0x58, 0x56, 0x37, 0x39, 0x2b, 0x25,\n    0x0f, 0x01, 0x13, 0x1d, 0x47, 0x49, 0x5b, 0x55, 0x7f, 0x71, 0x63, 0x6d,\n    0xd7, 0xd9, 0xcb, 0xc5, 0xef, 0xe1, 0xf3, 0xfd, 0xa7, 0xa9, 0xbb, 0xb5,\n    0x9f, 0x91, 0x83, 0x8d\n    ], //*/ GEX = Gx(0xe),\n\n    enc = function(string, pass, binary) {\n        // string, password in plaintext\n        var salt = randArr(8),\n        pbe = openSSLKey(s2a(pass, binary), salt),\n        key = pbe.key,\n        iv = pbe.iv,\n        cipherBlocks,\n        saltBlock = [[83, 97, 108, 116, 101, 100, 95, 95].concat(salt)];\n        string = s2a(string, binary);\n        cipherBlocks = rawEncrypt(string, key, iv);\n        // Spells out 'Salted__'\n        cipherBlocks = saltBlock.concat(cipherBlocks);\n        return Base64.encode(cipherBlocks);\n    },\n\n    dec = function(string, pass, binary) {\n        // string, password in plaintext\n        var cryptArr = Base64.decode(string),\n        salt = cryptArr.slice(8, 16),\n        pbe = openSSLKey(s2a(pass, binary), salt),\n        key = pbe.key,\n        iv = pbe.iv;\n        cryptArr = cryptArr.slice(16, cryptArr.length);\n        // Take off the Salted__ffeeddcc\n        string = rawDecrypt(cryptArr, key, iv, binary);\n        return string;\n    },\n\n    MD5 = function(numArr) {\n\n        function rotateLeft(lValue, iShiftBits) {\n            return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));\n        }\n\n        function addUnsigned(lX, lY) {\n            var lX4,\n            lY4,\n            lX8,\n            lY8,\n            lResult;\n            lX8 = (lX & 0x80000000);\n            lY8 = (lY & 0x80000000);\n            lX4 = (lX & 0x40000000);\n            lY4 = (lY & 0x40000000);\n            lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);\n            if (lX4 & lY4) {\n                return (lResult ^ 0x80000000 ^ lX8 ^ lY8);\n            }\n            if (lX4 | lY4) {\n                if (lResult & 0x40000000) {\n                    return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);\n                } else {\n                    return (lResult ^ 0x40000000 ^ lX8 ^ lY8);\n                }\n            } else {\n                return (lResult ^ lX8 ^ lY8);\n            }\n        }\n\n        function f(x, y, z) {\n            return (x & y) | ((~x) & z);\n        }\n        function g(x, y, z) {\n            return (x & z) | (y & (~z));\n        }\n        function h(x, y, z) {\n            return (x ^ y ^ z);\n        }\n        function funcI(x, y, z) {\n            return (y ^ (x | (~z)));\n        }\n\n        function ff(a, b, c, d, x, s, ac) {\n            a = addUnsigned(a, addUnsigned(addUnsigned(f(b, c, d), x), ac));\n            return addUnsigned(rotateLeft(a, s), b);\n        }\n\n        function gg(a, b, c, d, x, s, ac) {\n            a = addUnsigned(a, addUnsigned(addUnsigned(g(b, c, d), x), ac));\n            return addUnsigned(rotateLeft(a, s), b);\n        }\n\n        function hh(a, b, c, d, x, s, ac) {\n            a = addUnsigned(a, addUnsigned(addUnsigned(h(b, c, d), x), ac));\n            return addUnsigned(rotateLeft(a, s), b);\n        }\n\n        function ii(a, b, c, d, x, s, ac) {\n            a = addUnsigned(a, addUnsigned(addUnsigned(funcI(b, c, d), x), ac));\n            return addUnsigned(rotateLeft(a, s), b);\n        }\n\n        function convertToWordArray(numArr) {\n            var lWordCount,\n            lMessageLength = numArr.length,\n            lNumberOfWords_temp1 = lMessageLength + 8,\n            lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64,\n            lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16,\n            lWordArray = [],\n            lBytePosition = 0,\n            lByteCount = 0;\n            while (lByteCount < lMessageLength) {\n                lWordCount = (lByteCount - (lByteCount % 4)) / 4;\n                lBytePosition = (lByteCount % 4) * 8;\n                lWordArray[lWordCount] = (lWordArray[lWordCount] | (numArr[lByteCount] << lBytePosition));\n                lByteCount++;\n            }\n            lWordCount = (lByteCount - (lByteCount % 4)) / 4;\n            lBytePosition = (lByteCount % 4) * 8;\n            lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);\n            lWordArray[lNumberOfWords - 2] = lMessageLength << 3;\n            lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;\n            return lWordArray;\n        }\n\n        function wordToHex(lValue) {\n            var lByte,\n            lCount,\n            wordToHexArr = [];\n            for (lCount = 0; lCount <= 3; lCount++) {\n                lByte = (lValue >>> (lCount * 8)) & 255;\n                wordToHexArr = wordToHexArr.concat(lByte);\n             }\n            return wordToHexArr;\n        }\n\n        /*function utf8Encode(string) {\n            string = string.replace(/\\r\\n/g, \"\\n\");\n            var utftext = \"\",\n            n,\n            c;\n\n            for (n = 0; n < string.length; n++) {\n\n                c = string.charCodeAt(n);\n\n                if (c < 128) {\n                    utftext += String.fromCharCode(c);\n                }\n                else if ((c > 127) && (c < 2048)) {\n                    utftext += String.fromCharCode((c >> 6) | 192);\n                    utftext += String.fromCharCode((c & 63) | 128);\n                }\n                else {\n                    utftext += String.fromCharCode((c >> 12) | 224);\n                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n                    utftext += String.fromCharCode((c & 63) | 128);\n                }\n\n            }\n\n            return utftext;\n        }*/\n\n        var x = [],\n        k,\n        AA,\n        BB,\n        CC,\n        DD,\n        a,\n        b,\n        c,\n        d,\n        rnd = strhex('67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391',8);\n\n        x = convertToWordArray(numArr);\n\n        a = rnd[0];\n        b = rnd[1];\n        c = rnd[2];\n        d = rnd[3]\n\n        for (k = 0; k < x.length; k += 16) {\n            AA = a;\n            BB = b;\n            CC = c;\n            DD = d;\n            a = ff(a, b, c, d, x[k + 0], 7, rnd[4]);\n            d = ff(d, a, b, c, x[k + 1], 12, rnd[5]);\n            c = ff(c, d, a, b, x[k + 2], 17, rnd[6]);\n            b = ff(b, c, d, a, x[k + 3], 22, rnd[7]);\n            a = ff(a, b, c, d, x[k + 4], 7, rnd[8]);\n            d = ff(d, a, b, c, x[k + 5], 12, rnd[9]);\n            c = ff(c, d, a, b, x[k + 6], 17, rnd[10]);\n            b = ff(b, c, d, a, x[k + 7], 22, rnd[11]);\n            a = ff(a, b, c, d, x[k + 8], 7, rnd[12]);\n            d = ff(d, a, b, c, x[k + 9], 12, rnd[13]);\n            c = ff(c, d, a, b, x[k + 10], 17, rnd[14]);\n            b = ff(b, c, d, a, x[k + 11], 22, rnd[15]);\n            a = ff(a, b, c, d, x[k + 12], 7, rnd[16]);\n            d = ff(d, a, b, c, x[k + 13], 12, rnd[17]);\n            c = ff(c, d, a, b, x[k + 14], 17, rnd[18]);\n            b = ff(b, c, d, a, x[k + 15], 22, rnd[19]);\n            a = gg(a, b, c, d, x[k + 1], 5, rnd[20]);\n            d = gg(d, a, b, c, x[k + 6], 9, rnd[21]);\n            c = gg(c, d, a, b, x[k + 11], 14, rnd[22]);\n            b = gg(b, c, d, a, x[k + 0], 20, rnd[23]);\n            a = gg(a, b, c, d, x[k + 5], 5, rnd[24]);\n            d = gg(d, a, b, c, x[k + 10], 9, rnd[25]);\n            c = gg(c, d, a, b, x[k + 15], 14, rnd[26]);\n            b = gg(b, c, d, a, x[k + 4], 20, rnd[27]);\n            a = gg(a, b, c, d, x[k + 9], 5, rnd[28]);\n            d = gg(d, a, b, c, x[k + 14], 9, rnd[29]);\n            c = gg(c, d, a, b, x[k + 3], 14, rnd[30]);\n            b = gg(b, c, d, a, x[k + 8], 20, rnd[31]);\n            a = gg(a, b, c, d, x[k + 13], 5, rnd[32]);\n            d = gg(d, a, b, c, x[k + 2], 9, rnd[33]);\n            c = gg(c, d, a, b, x[k + 7], 14, rnd[34]);\n            b = gg(b, c, d, a, x[k + 12], 20, rnd[35]);\n            a = hh(a, b, c, d, x[k + 5], 4, rnd[36]);\n            d = hh(d, a, b, c, x[k + 8], 11, rnd[37]);\n            c = hh(c, d, a, b, x[k + 11], 16, rnd[38]);\n            b = hh(b, c, d, a, x[k + 14], 23, rnd[39]);\n            a = hh(a, b, c, d, x[k + 1], 4, rnd[40]);\n            d = hh(d, a, b, c, x[k + 4], 11, rnd[41]);\n            c = hh(c, d, a, b, x[k + 7], 16, rnd[42]);\n            b = hh(b, c, d, a, x[k + 10], 23, rnd[43]);\n            a = hh(a, b, c, d, x[k + 13], 4, rnd[44]);\n            d = hh(d, a, b, c, x[k + 0], 11, rnd[45]);\n            c = hh(c, d, a, b, x[k + 3], 16, rnd[46]);\n            b = hh(b, c, d, a, x[k + 6], 23, rnd[47]);\n            a = hh(a, b, c, d, x[k + 9], 4, rnd[48]);\n            d = hh(d, a, b, c, x[k + 12], 11, rnd[49]);\n            c = hh(c, d, a, b, x[k + 15], 16, rnd[50]);\n            b = hh(b, c, d, a, x[k + 2], 23, rnd[51]);\n            a = ii(a, b, c, d, x[k + 0], 6, rnd[52]);\n            d = ii(d, a, b, c, x[k + 7], 10, rnd[53]);\n            c = ii(c, d, a, b, x[k + 14], 15, rnd[54]);\n            b = ii(b, c, d, a, x[k + 5], 21, rnd[55]);\n            a = ii(a, b, c, d, x[k + 12], 6, rnd[56]);\n            d = ii(d, a, b, c, x[k + 3], 10, rnd[57]);\n            c = ii(c, d, a, b, x[k + 10], 15, rnd[58]);\n            b = ii(b, c, d, a, x[k + 1], 21, rnd[59]);\n            a = ii(a, b, c, d, x[k + 8], 6, rnd[60]);\n            d = ii(d, a, b, c, x[k + 15], 10, rnd[61]);\n            c = ii(c, d, a, b, x[k + 6], 15, rnd[62]);\n            b = ii(b, c, d, a, x[k + 13], 21, rnd[63]);\n            a = ii(a, b, c, d, x[k + 4], 6, rnd[64]);\n            d = ii(d, a, b, c, x[k + 11], 10, rnd[65]);\n            c = ii(c, d, a, b, x[k + 2], 15, rnd[66]);\n            b = ii(b, c, d, a, x[k + 9], 21, rnd[67]);\n            a = addUnsigned(a, AA);\n            b = addUnsigned(b, BB);\n            c = addUnsigned(c, CC);\n            d = addUnsigned(d, DD);\n        }\n\n        return wordToHex(a).concat(wordToHex(b), wordToHex(c), wordToHex(d));\n    },\n\n    encString = function(plaintext, key, iv) {\n        plaintext = s2a(plaintext);\n\n        key = s2a(key);\n        for (var i=key.length; i<32; i++)\n            key[i] = 0;\n\n        if (iv == null) {\n            iv = genIV();\n        } else {\n            iv = s2a(iv);\n            for (var i=iv.length; i<16; i++)\n                iv[i] = 0;\n        }\n\n        var ct = rawEncrypt(plaintext, key, iv);\n        var ret = [iv];\n        for (var i=0; i<ct.length; i++)\n            ret[ret.length] = ct[i];\n        return Base64.encode(ret);\n    },\n\n    decString = function(ciphertext, key) {\n        var tmp = Base64.decode(ciphertext);\n        var iv = tmp.slice(0, 16);\n        var ct = tmp.slice(16, tmp.length);\n\n        key = s2a(key);\n        for (var i=key.length; i<32; i++)\n            key[i] = 0;\n\n        var pt = rawDecrypt(ct, key, iv, false);\n        return pt;\n    },\n\n    Base64 = (function(){\n        // Takes a Nx16x1 byte array and converts it to Base64\n        var _chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n        chars = _chars.split(''),\n\n        encode = function(b, withBreaks) {\n            var flatArr = [],\n            b64 = '',\n            i,\n            broken_b64;\n            var totalChunks = Math.floor(b.length * 16 / 3);\n            for (i = 0; i < b.length * 16; i++) {\n                flatArr.push(b[Math.floor(i / 16)][i % 16]);\n            }\n            for (i = 0; i < flatArr.length; i = i + 3) {\n                b64 += chars[flatArr[i] >> 2];\n                b64 += chars[((flatArr[i] & 3) << 4) | (flatArr[i + 1] >> 4)];\n                if (! (flatArr[i + 1] === undefined)) {\n                    b64 += chars[((flatArr[i + 1] & 15) << 2) | (flatArr[i + 2] >> 6)];\n                } else {\n                    b64 += '=';\n                }\n                if (! (flatArr[i + 2] === undefined)) {\n                    b64 += chars[flatArr[i + 2] & 63];\n                } else {\n                    b64 += '=';\n                }\n            }\n            // OpenSSL is super particular about line breaks\n            broken_b64 = b64.slice(0, 64); // + '\\n';\n            for (i = 1; i < (Math['ceil'](b64.length / 64)); i++) {\n                broken_b64 += b64.slice(i * 64, i * 64 + 64) + (Math.ceil(b64.length / 64) == i + 1 ? '': '\\n');\n            }\n            return broken_b64;\n        },\n\n        decode = function(string) {\n            string = string['replace'](/\\n/g, '');\n            var flatArr = [],\n            c = [],\n            b = [],\n            i;\n            for (i = 0; i < string.length; i = i + 4) {\n                c[0] = _chars.indexOf(string.charAt(i));\n                c[1] = _chars.indexOf(string.charAt(i + 1));\n                c[2] = _chars.indexOf(string.charAt(i + 2));\n                c[3] = _chars.indexOf(string.charAt(i + 3));\n\n                b[0] = (c[0] << 2) | (c[1] >> 4);\n                b[1] = ((c[1] & 15) << 4) | (c[2] >> 2);\n                b[2] = ((c[2] & 3) << 6) | c[3];\n                flatArr.push(b[0], b[1], b[2]);\n            }\n            flatArr = flatArr.slice(0, flatArr.length - (flatArr.length % 16));\n            return flatArr;\n        };\n\n        //internet explorer\n        if(typeof Array.indexOf === \"function\") {\n            _chars = chars;\n        }\n\n        /*\n        //other way to solve internet explorer problem\n        if(!Array.indexOf){\n            Array.prototype.indexOf = function(obj){\n                for(var i=0; i<this.length; i++){\n                    if(this[i]===obj){\n                        return i;\n                    }\n                }\n                return -1;\n            }\n        }\n        */\n\n\n        return {\n            \"encode\": encode,\n            \"decode\": decode\n        };\n    })();\n\n    return {\n        \"size\": size,\n        \"h2a\":h2a,\n        \"expandKey\":expandKey,\n        \"encryptBlock\":encryptBlock,\n        \"decryptBlock\":decryptBlock,\n        \"Decrypt\":Decrypt,\n        \"s2a\":s2a,\n        \"rawEncrypt\":rawEncrypt,\n        \"rawDecrypt\":rawDecrypt,\n        \"dec\":dec,\n        \"openSSLKey\":openSSLKey,\n        \"a2h\":a2h,\n        \"enc\":enc,\n        \"Hash\":{\"MD5\":MD5},\n        \"Base64\":Base64\n    };\n\n})();\n\nfunction crypto_obj (){\n\n\nfunction SHA256(s) {\n\n    var chrsz = 8;\n    var hexcase = 0;\n\n    function safe_add(x, y) {\n        var lsw = (x & 0xFFFF) + (y & 0xFFFF);\n        var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n        return (msw << 16) | (lsw & 0xFFFF);\n    }\n\n    function S(X, n) {\n        return ( X >>> n ) | (X << (32 - n));\n    }\n\n    function R(X, n) {\n        return ( X >>> n );\n    }\n\n    function Ch(x, y, z) {\n        return ((x & y) ^ ((~x) & z));\n    }\n\n    function Maj(x, y, z) {\n        return ((x & y) ^ (x & z) ^ (y & z));\n    }\n\n    function Sigma0256(x) {\n        return (S(x, 2) ^ S(x, 13) ^ S(x, 22));\n    }\n\n    function Sigma1256(x) {\n        return (S(x, 6) ^ S(x, 11) ^ S(x, 25));\n    }\n\n    function Gamma0256(x) {\n        return (S(x, 7) ^ S(x, 18) ^ R(x, 3));\n    }\n\n    function Gamma1256(x) {\n        return (S(x, 17) ^ S(x, 19) ^ R(x, 10));\n    }\n\n    function core_sha256(m, l) {\n        var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);\n        var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);\n        var W = new Array(64);\n        var a, b, c, d, e, f, g, h, i, j;\n        var T1, T2;\n\n        m[l >> 5] |= 0x80 << (24 - l % 32);\n        m[((l + 64 >> 9) << 4) + 15] = l;\n\n        for (var i = 0; i < m.length; i += 16) {\n            a = HASH[0];\n            b = HASH[1];\n            c = HASH[2];\n            d = HASH[3];\n            e = HASH[4];\n            f = HASH[5];\n            g = HASH[6];\n            h = HASH[7];\n\n            for (var j = 0; j < 64; j++) {\n                if (j < 16) W[j] = m[j + i];\n                else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);\n\n                T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);\n                T2 = safe_add(Sigma0256(a), Maj(a, b, c));\n\n                h = g;\n                g = f;\n                f = e;\n                e = safe_add(d, T1);\n                d = c;\n                c = b;\n                b = a;\n                a = safe_add(T1, T2);\n            }\n\n            HASH[0] = safe_add(a, HASH[0]);\n            HASH[1] = safe_add(b, HASH[1]);\n            HASH[2] = safe_add(c, HASH[2]);\n            HASH[3] = safe_add(d, HASH[3]);\n            HASH[4] = safe_add(e, HASH[4]);\n            HASH[5] = safe_add(f, HASH[5]);\n            HASH[6] = safe_add(g, HASH[6]);\n            HASH[7] = safe_add(h, HASH[7]);\n        }\n        return HASH;\n    }\n\n    function str2binb(str) {\n        var bin = Array();\n        var mask = (1 << chrsz) - 1;\n        for (var i = 0; i < str.length * chrsz; i += chrsz) {\n            bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32);\n        }\n        return bin;\n    }\n\n    function Utf8Encode(string) {\n        string = string['replace'](/\\r\\n/g, \"\\n\");\n        var utftext = \"\";\n\n        for (var n = 0; n < string['length']; n++) {\n\n            var c = string.charCodeAt(n);\n\n            if (c < 128) {\n                utftext += String.fromCharCode(c);\n            }\n            else if ((c > 127) && (c < 2048)) {\n                utftext += String.fromCharCode((c >> 6) | 192);\n                utftext += String.fromCharCode((c & 63) | 128);\n            }\n            else {\n                utftext += String.fromCharCode((c >> 12) | 224);\n                utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n                utftext += String.fromCharCode((c & 63) | 128);\n            }\n\n        }\n\n        return utftext;\n    }\n\n    function binb2hex(binarray) {\n        var hex_tab = hexcase ? \"0123456789ABCDEF\" : \"0123456789abcdef\";\n        var str = \"\";\n        for (var i = 0; i < binarray.length * 4; i++) {\n            str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) +\n                hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8  )) & 0xF);\n        }\n        return str;\n    }\n\n    s = Utf8Encode(s);\n    return binb2hex(core_sha256(str2binb(s), s.length * chrsz));\n}\n    var crypto = CRYPTO;\n    crypto['size'](256);\n\n    var cipher_key = \"\";\n    var iv = crypto['s2a'](\"0123456789012345\");\n\n    return {\n\n        'encrypt' : function(data, key) {\n            if (!key) return data;\n            var cipher_key = crypto['s2a'](SHA256(key)['slice'](0,32));\n            var hex_message = crypto['s2a'](JSON['stringify'](data));\n            var encryptedHexArray = crypto['rawEncrypt'](hex_message, cipher_key, iv);\n            var base_64_encrypted = crypto['Base64']['encode'](encryptedHexArray);\n            return base_64_encrypted || data;\n        } ,\n\n        'decrypt' : function(data, key) {\n            if (!key) return data;\n            var cipher_key = crypto['s2a'](SHA256(key)['slice'](0,32));\n            try {\n                var binary_enc = crypto['Base64']['decode'](data);\n                var json_plain = crypto['rawDecrypt'](binary_enc, cipher_key, iv, false);\n                var plaintext = JSON['parse'](json_plain);\n                return plaintext;\n            }\n            catch (e) {\n                return undefined;\n            }\n        }\n    };\n}\n/* ---------------------------------------------------------------------------\n--------------------------------------------------------------------------- */\n\n/* ---------------------------------------------------------------------------\nPubNub Real-time Cloud-Hosted Push API and Push Notification Client Frameworks\nCopyright (c) 2011 PubNub Inc.\nhttp://www.pubnub.com/\nhttp://www.pubnub.com/terms\n--------------------------------------------------------------------------- */\n\n/* ---------------------------------------------------------------------------\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n--------------------------------------------------------------------------- */\n(function(){\n\n/**\n * UTIL LOCALS\n */\nvar NOW        = 1\n,    PNSDK      = 'PubNub-JS-' + 'Modern' + '/' + '3.6.2'\n,   XHRTME     = 310000;\n\n\n\n/**\n * LOCAL STORAGE\n */\nvar db = (function(){\n    var ls = typeof localStorage != 'undefined' && localStorage;\n    return {\n        get : function(key) {\n            try {\n                if (ls) return ls.getItem(key);\n                if (document.cookie.indexOf(key) == -1) return null;\n                return ((document.cookie||'').match(\n                    RegExp(key+'=([^;]+)')\n                )||[])[1] || null;\n            } catch(e) { return }\n        },\n        set : function( key, value ) {\n            try {\n                if (ls) return ls.setItem( key, value ) && 0;\n                document.cookie = key + '=' + value +\n                    '; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/';\n            } catch(e) { return }\n        }\n    };\n})();\n\n\n/**\n * CORS XHR Request\n * ================\n *  xdr({\n *     url     : ['http://www.blah.com/url'],\n *     success : function(response) {},\n *     fail    : function() {}\n *  });\n */\nfunction xdr( setup ) {\n    var xhr\n    ,   finished = function() {\n            if (loaded) return;\n                loaded = 1;\n\n            clearTimeout(timer);\n\n            try       { response = JSON['parse'](xhr.responseText); }\n            catch (r) { return done(1); }\n\n            success(response);\n        }\n    ,   complete = 0\n    ,   loaded   = 0\n    ,   timer    = timeout( function(){done(1)}, XHRTME )\n    ,   data     = setup.data || {}\n    ,   fail     = setup.fail    || function(){}\n    ,   success  = setup.success || function(){}\n    ,   async    = ( typeof(setup.blocking) === 'undefined' )\n    ,   done     = function(failed, response) {\n            if (complete) return;\n                complete = 1;\n\n            clearTimeout(timer);\n\n            if (xhr) {\n                xhr.onerror = xhr.onload = null;\n                xhr.abort && xhr.abort();\n                xhr = null;\n            }\n\n            failed && fail(response);\n        };\n\n    // Send\n    try {\n        xhr = typeof XDomainRequest !== 'undefined' &&\n              new XDomainRequest()  ||\n              new XMLHttpRequest();\n\n        xhr.onerror = xhr.onabort   = function(){ done(1, xhr.responseText || { \"error\" : \"Network Connection Error\"}) };\n        xhr.onload  = xhr.onloadend = finished;\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState == 4) {\n                switch(xhr.status) {\n                    case 401:\n                    case 402:\n                    case 403:\n                        try {\n                            response = JSON['parse'](xhr.responseText);\n                            done(1,response);\n                        }\n                        catch (r) { return done(1, xhr.responseText); }\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        if (async) xhr.timeout = XHRTME;\n        data['pnsdk'] = PNSDK;\n        url = build_url(setup.url, data);\n        xhr.open( 'GET', url, async);\n        xhr.send();\n    }\n    catch(eee) {\n        done(0);\n        return xdr(setup);\n    }\n\n    // Return 'done'\n    return done;\n}\n\n/**\n * BIND\n * ====\n * bind( 'keydown', search('a')[0], function(element) {\n *     ...\n * } );\n */\nfunction bind( type, el, fun ) {\n    each( type.split(','), function(etype) {\n        var rapfun = function(e) {\n            if (!e) e = window.event;\n            if (!fun(e)) {\n                e.cancelBubble = true;\n                e.returnValue  = false;\n                e.preventDefault && e.preventDefault();\n                e.stopPropagation && e.stopPropagation();\n            }\n        };\n\n        if ( el.addEventListener ) el.addEventListener( etype, rapfun, false );\n        else if ( el.attachEvent ) el.attachEvent( 'on' + etype, rapfun );\n        else  el[ 'on' + etype ] = rapfun;\n    } );\n}\n\n/**\n * UNBIND\n * ======\n * unbind( 'keydown', search('a')[0] );\n */\nfunction unbind( type, el, fun ) {\n    if ( el.removeEventListener ) el.removeEventListener( type, false );\n    else if ( el.detachEvent ) el.detachEvent( 'on' + type, false );\n    else  el[ 'on' + type ] = null;\n}\n\n/**\n * ERROR\n * ===\n * error('message');\n */\nfunction error(message) { console['error'](message) }\n\n/**\n * EVENTS\n * ======\n * PUBNUB.events.bind( 'you-stepped-on-flower', function(message) {\n *     // Do Stuff with message\n * } );\n *\n * PUBNUB.events.fire( 'you-stepped-on-flower', \"message-data\" );\n * PUBNUB.events.fire( 'you-stepped-on-flower', {message:\"data\"} );\n * PUBNUB.events.fire( 'you-stepped-on-flower', [1,2,3] );\n *\n */\nvar events = {\n    'list'   : {},\n    'unbind' : function( name ) { events.list[name] = [] },\n    'bind'   : function( name, fun ) {\n        (events.list[name] = events.list[name] || []).push(fun);\n    },\n    'fire' : function( name, data ) {\n        each(\n            events.list[name] || [],\n            function(fun) { fun(data) }\n        );\n    }\n};\n\n/**\n * ATTR\n * ====\n * var attribute = attr( node, 'attribute' );\n */\nfunction attr( node, attribute, value ) {\n    if (value) node.setAttribute( attribute, value );\n    else return node && node.getAttribute && node.getAttribute(attribute);\n}\n\n/**\n * $\n * =\n * var div = $('divid');\n */\nfunction $(id) { return document.getElementById(id) }\n\n\n/**\n * SEARCH\n * ======\n * var elements = search('a div span');\n */\nfunction search( elements, start ) {\n    var list = [];\n    each( elements.split(/\\s+/), function(el) {\n        each( (start || document).getElementsByTagName(el), function(node) {\n            list.push(node);\n        } );\n    } );\n    return list;\n}\n\n/**\n * CSS\n * ===\n * var obj = create('div');\n */\nfunction css( element, styles ) {\n    for (var style in styles) if (styles.hasOwnProperty(style))\n        try {element.style[style] = styles[style] + (\n            '|width|height|top|left|'.indexOf(style) > 0 &&\n            typeof styles[style] == 'number'\n            ? 'px' : ''\n        )}catch(e){}\n}\n\n/**\n * CREATE\n * ======\n * var obj = create('div');\n */\nfunction create(element) { return document.createElement(element) }\n\n\nfunction get_hmac_SHA256(data,key) {\n    var hash = CryptoJS['HmacSHA256'](data, key);\n    return hash.toString(CryptoJS['enc']['Base64']);\n}\n\n/* =-====================================================================-= */\n/* =-====================================================================-= */\n/* =-=========================     PUBNUB     ===========================-= */\n/* =-====================================================================-= */\n/* =-====================================================================-= */\n\nfunction CREATE_PUBNUB(setup) {\n\n\n    setup['db'] = db;\n    setup['xdr'] = xdr;\n    setup['error'] = setup['error'] || error;\n    setup['PNSDK']      = PNSDK;\n    setup['hmac_SHA256']= get_hmac_SHA256;\n    setup['crypto_obj'] = crypto_obj();\n\n    SELF = function(setup) {\n        return CREATE_PUBNUB(setup);\n    }\n    var PN = PN_API(setup);\n    for (var prop in PN) {\n        if (PN.hasOwnProperty(prop)) {\n            SELF[prop] = PN[prop];\n        }\n    }\n\n    SELF['init'] = SELF;\n    SELF['$'] = $;\n    SELF['attr'] = attr;\n    SELF['search'] = search;\n    SELF['bind'] = bind;\n    SELF['css'] = css;\n    SELF['create'] = create;\n\n    if (typeof(window) !== 'undefined'){\n        bind( 'beforeunload', window, function() {\n            SELF['each-channel'](function(ch){ SELF['LEAVE']( ch.name, 1 ) });\n            return true;\n        });\n    }\n\n    // Return without Testing\n    if (setup['notest']) return SELF;\n\n    if (typeof(window) !== 'undefined'){\n        bind( 'offline', window,   SELF['_reset_offline'] );\n    }\n\n    if (typeof(document) !== 'undefined'){\n        bind( 'offline', document, SELF['_reset_offline'] );\n    }\n\n    SELF['ready']();\n    return SELF;\n}\nCREATE_PUBNUB['init'] = CREATE_PUBNUB\nCREATE_PUBNUB['secure'] = CREATE_PUBNUB\nPUBNUB = CREATE_PUBNUB({})\ntypeof module  !== 'undefined' && (module.exports = CREATE_PUBNUB) ||\ntypeof exports !== 'undefined' && (exports.PUBNUB = CREATE_PUBNUB) || (PUBNUB = CREATE_PUBNUB);\n\n})();\n(function(){\n\n// ---------------------------------------------------------------------------\n// WEBSOCKET INTERFACE\n// ---------------------------------------------------------------------------\nvar WS = PUBNUB['ws'] = function( url, protocols ) {\n    if (!(this instanceof WS)) return new WS( url, protocols );\n\n    var self     = this\n    ,   url      = self.url      = url || ''\n    ,   protocol = self.protocol = protocols || 'Sec-WebSocket-Protocol'\n    ,   bits     = url.split('/')\n    ,   setup    = {\n         'ssl'           : bits[0] === 'wss:'\n        ,'origin'        : bits[2]\n        ,'publish_key'   : bits[3]\n        ,'subscribe_key' : bits[4]\n        ,'channel'       : bits[5]\n    };\n\n    // READY STATES\n    self['CONNECTING'] = 0; // The connection is not yet open.\n    self['OPEN']       = 1; // The connection is open and ready to communicate.\n    self['CLOSING']    = 2; // The connection is in the process of closing.\n    self['CLOSED']     = 3; // The connection is closed or couldn't be opened.\n\n    // CLOSE STATES\n    self['CLOSE_NORMAL']         = 1000; // Normal Intended Close; completed.\n    self['CLOSE_GOING_AWAY']     = 1001; // Closed Unexpecttedly.\n    self['CLOSE_PROTOCOL_ERROR'] = 1002; // Server: Not Supported.\n    self['CLOSE_UNSUPPORTED']    = 1003; // Server: Unsupported Protocol.\n    self['CLOSE_TOO_LARGE']      = 1004; // Server: Too Much Data.\n    self['CLOSE_NO_STATUS']      = 1005; // Server: No reason.\n    self['CLOSE_ABNORMAL']       = 1006; // Abnormal Disconnect.\n\n    // Events Default\n    self['onclose']   = self['onerror'] =\n    self['onmessage'] = self['onopen']  =\n    self['onsend']    =  function(){};\n\n    // Attributes\n    self['binaryType']     = '';\n    self['extensions']     = '';\n    self['bufferedAmount'] = 0;\n    self['trasnmitting']   = false;\n    self['buffer']         = [];\n    self['readyState']     = self['CONNECTING'];\n\n    // Close if no setup.\n    if (!url) {\n        self['readyState'] = self['CLOSED'];\n        self['onclose']({\n            'code'     : self['CLOSE_ABNORMAL'],\n            'reason'   : 'Missing URL',\n            'wasClean' : true\n        });\n        return self;\n    }\n\n    // PubNub WebSocket Emulation\n    self.pubnub       = PUBNUB['init'](setup);\n    self.pubnub.setup = setup;\n    self.setup        = setup;\n\n    self.pubnub['subscribe']({\n        'restore'    : false,\n        'channel'    : setup['channel'],\n        'disconnect' : self['onerror'],\n        'reconnect'  : self['onopen'],\n        'error'      : function() {\n            self['onclose']({\n                'code'     : self['CLOSE_ABNORMAL'],\n                'reason'   : 'Missing URL',\n                'wasClean' : false\n            });\n        },\n        'callback'   : function(message) {\n            self['onmessage']({ 'data' : message });\n        },\n        'connect'    : function() {\n            self['readyState'] = self['OPEN'];\n            self['onopen']();\n        }\n    });\n};\n\n// ---------------------------------------------------------------------------\n// WEBSOCKET SEND\n// ---------------------------------------------------------------------------\nWS.prototype.send = function(data) {\n    var self = this;\n    self.pubnub['publish']({\n        'channel'  : self.pubnub.setup['channel'],\n        'message'  : data,\n        'callback' : function(response) {\n            self['onsend']({ 'data' : response });\n        }\n    });\n};\n\n// ---------------------------------------------------------------------------\n// WEBSOCKET CLOSE\n// ---------------------------------------------------------------------------\nWS.prototype.close = function() {\n    var self = this;\n    self.pubnub['unsubscribe']({ 'channel' : self.pubnub.setup['channel'] });\n    self['readyState'] = self['CLOSED'];\n    self['onclose']({});\n};\n\n})();\n","// STUN servers\nexports.stun = [\n  'stun.l.google.com:19302',\n  'stun1.l.google.com:19302',\n  'stun2.l.google.com:19302',\n  'stun3.l.google.com:19302',\n  'stun4.l.google.com:19302',\n  'stun.ekiga.net',\n  'stun.ideasip.com',\n  'stun.iptel.org',\n  'stun.rixtelecom.se',\n  'stun.schlund.de',\n  'stunserver.org',\n  // 'stun.softjoys.com',\n  'stun.stunprotocol.org:3478',\n  // 'stun.turnservers.com:3478',\n  'stun.voiparound.com',\n  'stun.voipbuster.com',\n  'stun.voipstunt.com'\n];\n\n// TURN servers\nexports.turn = [\n];\n","\nvar rng;\n\nif (global.crypto && crypto.getRandomValues) {\n  // WHATWG crypto-based RNG - http://wiki.whatwg.org/wiki/Crypto\n  // Moderately fast, high quality\n  var _rnds8 = new Uint8Array(16);\n  rng = function whatwgRNG() {\n    crypto.getRandomValues(_rnds8);\n    return _rnds8;\n  };\n}\n\nif (!rng) {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var  _rnds = new Array(16);\n  rng = function() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      _rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return _rnds;\n  };\n}\n\nmodule.exports = rng;\n\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = Buffer\nexports.INSPECT_MAX_BYTES = 50\nBuffer.poolSize = 8192\n\n/**\n * If `Buffer._useTypedArrays`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (compatible down to IE6)\n */\nBuffer._useTypedArrays = (function () {\n  // Detect if browser supports Typed Arrays. Supported browsers are IE 10+, Firefox 4+,\n  // Chrome 7+, Safari 5.1+, Opera 11.6+, iOS 4.2+. If the browser does not support adding\n  // properties to `Uint8Array` instances, then that's the same as no `Uint8Array` support\n  // because we need to be able to add all the node Buffer API methods. This is an issue\n  // in Firefox 4-29. Now fixed: https://bugzilla.mozilla.org/show_bug.cgi?id=695438\n  try {\n    var buf = new ArrayBuffer(0)\n    var arr = new Uint8Array(buf)\n    arr.foo = function () { return 42 }\n    return 42 === arr.foo() &&\n        typeof arr.subarray === 'function' // Chrome 9-10 lack `subarray`\n  } catch (e) {\n    return false\n  }\n})()\n\n/**\n * Class: Buffer\n * =============\n *\n * The Buffer constructor returns instances of `Uint8Array` that are augmented\n * with function properties for all the node `Buffer` API functions. We use\n * `Uint8Array` so that square bracket notation works as expected -- it returns\n * a single octet.\n *\n * By augmenting the instances, we can avoid modifying the `Uint8Array`\n * prototype.\n */\nfunction Buffer (subject, encoding, noZero) {\n  if (!(this instanceof Buffer))\n    return new Buffer(subject, encoding, noZero)\n\n  var type = typeof subject\n\n  // Workaround: node's base64 implementation allows for non-padded strings\n  // while base64-js does not.\n  if (encoding === 'base64' && type === 'string') {\n    subject = stringtrim(subject)\n    while (subject.length % 4 !== 0) {\n      subject = subject + '='\n    }\n  }\n\n  // Find the length\n  var length\n  if (type === 'number')\n    length = coerce(subject)\n  else if (type === 'string')\n    length = Buffer.byteLength(subject, encoding)\n  else if (type === 'object')\n    length = coerce(subject.length) // assume that object is array-like\n  else\n    throw new Error('First argument needs to be a number, array or string.')\n\n  var buf\n  if (Buffer._useTypedArrays) {\n    // Preferred: Return an augmented `Uint8Array` instance for best performance\n    buf = Buffer._augment(new Uint8Array(length))\n  } else {\n    // Fallback: Return THIS instance of Buffer (created by `new`)\n    buf = this\n    buf.length = length\n    buf._isBuffer = true\n  }\n\n  var i\n  if (Buffer._useTypedArrays && typeof subject.byteLength === 'number') {\n    // Speed optimization -- use set if we're copying from a typed array\n    buf._set(subject)\n  } else if (isArrayish(subject)) {\n    // Treat array-ish objects as a byte array\n    for (i = 0; i < length; i++) {\n      if (Buffer.isBuffer(subject))\n        buf[i] = subject.readUInt8(i)\n      else\n        buf[i] = subject[i]\n    }\n  } else if (type === 'string') {\n    buf.write(subject, 0, encoding)\n  } else if (type === 'number' && !Buffer._useTypedArrays && !noZero) {\n    for (i = 0; i < length; i++) {\n      buf[i] = 0\n    }\n  }\n\n  return buf\n}\n\n// STATIC METHODS\n// ==============\n\nBuffer.isEncoding = function (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'binary':\n    case 'base64':\n    case 'raw':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.isBuffer = function (b) {\n  return !!(b !== null && b !== undefined && b._isBuffer)\n}\n\nBuffer.byteLength = function (str, encoding) {\n  var ret\n  str = str.toString()\n  switch (encoding || 'utf8') {\n    case 'hex':\n      ret = str.length / 2\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8ToBytes(str).length\n      break\n    case 'ascii':\n    case 'binary':\n    case 'raw':\n      ret = str.length\n      break\n    case 'base64':\n      ret = base64ToBytes(str).length\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = str.length * 2\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.concat = function (list, totalLength) {\n  assert(isArray(list), 'Usage: Buffer.concat(list[, length])')\n\n  if (list.length === 0) {\n    return new Buffer(0)\n  } else if (list.length === 1) {\n    return list[0]\n  }\n\n  var i\n  if (totalLength === undefined) {\n    totalLength = 0\n    for (i = 0; i < list.length; i++) {\n      totalLength += list[i].length\n    }\n  }\n\n  var buf = new Buffer(totalLength)\n  var pos = 0\n  for (i = 0; i < list.length; i++) {\n    var item = list[i]\n    item.copy(buf, pos)\n    pos += item.length\n  }\n  return buf\n}\n\nBuffer.compare = function (a, b) {\n  assert(Buffer.isBuffer(a) && Buffer.isBuffer(b), 'Arguments must be Buffers')\n  var x = a.length\n  var y = b.length\n  for (var i = 0, len = Math.min(x, y); i < len && a[i] === b[i]; i++) {}\n  if (i !== len) {\n    x = a[i]\n    y = b[i]\n  }\n  if (x < y) {\n    return -1\n  }\n  if (y < x) {\n    return 1\n  }\n  return 0\n}\n\n// BUFFER INSTANCE METHODS\n// =======================\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  assert(strLen % 2 === 0, 'Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; i++) {\n    var byte = parseInt(string.substr(i * 2, 2), 16)\n    assert(!isNaN(byte), 'Invalid hex string')\n    buf[offset + i] = byte\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf8ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(asciiToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction binaryWrite (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(base64ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction utf16leWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf16leToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nBuffer.prototype.write = function (string, offset, length, encoding) {\n  // Support both (string, offset, length, encoding)\n  // and the legacy (string, encoding, offset, length)\n  if (isFinite(offset)) {\n    if (!isFinite(length)) {\n      encoding = length\n      length = undefined\n    }\n  } else {  // legacy\n    var swap = encoding\n    encoding = offset\n    offset = length\n    length = swap\n  }\n\n  offset = Number(offset) || 0\n  var remaining = this.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n  encoding = String(encoding || 'utf8').toLowerCase()\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexWrite(this, string, offset, length)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Write(this, string, offset, length)\n      break\n    case 'ascii':\n      ret = asciiWrite(this, string, offset, length)\n      break\n    case 'binary':\n      ret = binaryWrite(this, string, offset, length)\n      break\n    case 'base64':\n      ret = base64Write(this, string, offset, length)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leWrite(this, string, offset, length)\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.prototype.toString = function (encoding, start, end) {\n  var self = this\n\n  encoding = String(encoding || 'utf8').toLowerCase()\n  start = Number(start) || 0\n  end = (end === undefined) ? self.length : Number(end)\n\n  // Fastpath empty strings\n  if (end === start)\n    return ''\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexSlice(self, start, end)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Slice(self, start, end)\n      break\n    case 'ascii':\n      ret = asciiSlice(self, start, end)\n      break\n    case 'binary':\n      ret = binarySlice(self, start, end)\n      break\n    case 'base64':\n      ret = base64Slice(self, start, end)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leSlice(self, start, end)\n      break\n    default:\n      throw new Error('Unknown encoding')\n  }\n  return ret\n}\n\nBuffer.prototype.toJSON = function () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nBuffer.prototype.equals = function (b) {\n  assert(Buffer.isBuffer(b), 'Argument must be a Buffer')\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.compare = function (b) {\n  assert(Buffer.isBuffer(b), 'Argument must be a Buffer')\n  return Buffer.compare(this, b)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function (target, target_start, start, end) {\n  var source = this\n\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (!target_start) target_start = 0\n\n  // Copy 0 bytes; we're done\n  if (end === start) return\n  if (target.length === 0 || source.length === 0) return\n\n  // Fatal error conditions\n  assert(end >= start, 'sourceEnd < sourceStart')\n  assert(target_start >= 0 && target_start < target.length,\n      'targetStart out of bounds')\n  assert(start >= 0 && start < source.length, 'sourceStart out of bounds')\n  assert(end >= 0 && end <= source.length, 'sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length)\n    end = this.length\n  if (target.length - target_start < end - start)\n    end = target.length - target_start + start\n\n  var len = end - start\n\n  if (len < 100 || !Buffer._useTypedArrays) {\n    for (var i = 0; i < len; i++) {\n      target[i + target_start] = this[i + start]\n    }\n  } else {\n    target._set(this.subarray(start, start + len), target_start)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction binarySlice (buf, start, end) {\n  return asciiSlice(buf, start, end)\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; i++) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function (start, end) {\n  var len = this.length\n  start = clamp(start, len, 0)\n  end = clamp(end, len, len)\n\n  if (Buffer._useTypedArrays) {\n    return Buffer._augment(this.subarray(start, end))\n  } else {\n    var sliceLen = end - start\n    var newBuf = new Buffer(sliceLen, undefined, true)\n    for (var i = 0; i < sliceLen; i++) {\n      newBuf[i] = this[i + start]\n    }\n    return newBuf\n  }\n}\n\n// `get` will be removed in Node 0.13+\nBuffer.prototype.get = function (offset) {\n  console.log('.get() is deprecated. Access using array indexes instead.')\n  return this.readUInt8(offset)\n}\n\n// `set` will be removed in Node 0.13+\nBuffer.prototype.set = function (v, offset) {\n  console.log('.set() is deprecated. Access using array indexes instead.')\n  return this.writeUInt8(v, offset)\n}\n\nBuffer.prototype.readUInt8 = function (offset, noAssert) {\n  if (!noAssert) {\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'Trying to read beyond buffer length')\n  }\n\n  if (offset >= this.length)\n    return\n\n  return this[offset]\n}\n\nfunction readUInt16 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val\n  if (littleEndian) {\n    val = buf[offset]\n    if (offset + 1 < len)\n      val |= buf[offset + 1] << 8\n  } else {\n    val = buf[offset] << 8\n    if (offset + 1 < len)\n      val |= buf[offset + 1]\n  }\n  return val\n}\n\nBuffer.prototype.readUInt16LE = function (offset, noAssert) {\n  return readUInt16(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readUInt16BE = function (offset, noAssert) {\n  return readUInt16(this, offset, false, noAssert)\n}\n\nfunction readUInt32 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val\n  if (littleEndian) {\n    if (offset + 2 < len)\n      val = buf[offset + 2] << 16\n    if (offset + 1 < len)\n      val |= buf[offset + 1] << 8\n    val |= buf[offset]\n    if (offset + 3 < len)\n      val = val + (buf[offset + 3] << 24 >>> 0)\n  } else {\n    if (offset + 1 < len)\n      val = buf[offset + 1] << 16\n    if (offset + 2 < len)\n      val |= buf[offset + 2] << 8\n    if (offset + 3 < len)\n      val |= buf[offset + 3]\n    val = val + (buf[offset] << 24 >>> 0)\n  }\n  return val\n}\n\nBuffer.prototype.readUInt32LE = function (offset, noAssert) {\n  return readUInt32(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readUInt32BE = function (offset, noAssert) {\n  return readUInt32(this, offset, false, noAssert)\n}\n\nBuffer.prototype.readInt8 = function (offset, noAssert) {\n  if (!noAssert) {\n    assert(offset !== undefined && offset !== null,\n        'missing offset')\n    assert(offset < this.length, 'Trying to read beyond buffer length')\n  }\n\n  if (offset >= this.length)\n    return\n\n  var neg = this[offset] & 0x80\n  if (neg)\n    return (0xff - this[offset] + 1) * -1\n  else\n    return this[offset]\n}\n\nfunction readInt16 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val = readUInt16(buf, offset, littleEndian, true)\n  var neg = val & 0x8000\n  if (neg)\n    return (0xffff - val + 1) * -1\n  else\n    return val\n}\n\nBuffer.prototype.readInt16LE = function (offset, noAssert) {\n  return readInt16(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readInt16BE = function (offset, noAssert) {\n  return readInt16(this, offset, false, noAssert)\n}\n\nfunction readInt32 (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  var val = readUInt32(buf, offset, littleEndian, true)\n  var neg = val & 0x80000000\n  if (neg)\n    return (0xffffffff - val + 1) * -1\n  else\n    return val\n}\n\nBuffer.prototype.readInt32LE = function (offset, noAssert) {\n  return readInt32(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readInt32BE = function (offset, noAssert) {\n  return readInt32(this, offset, false, noAssert)\n}\n\nfunction readFloat (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  return ieee754.read(buf, offset, littleEndian, 23, 4)\n}\n\nBuffer.prototype.readFloatLE = function (offset, noAssert) {\n  return readFloat(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readFloatBE = function (offset, noAssert) {\n  return readFloat(this, offset, false, noAssert)\n}\n\nfunction readDouble (buf, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset + 7 < buf.length, 'Trying to read beyond buffer length')\n  }\n\n  return ieee754.read(buf, offset, littleEndian, 52, 8)\n}\n\nBuffer.prototype.readDoubleLE = function (offset, noAssert) {\n  return readDouble(this, offset, true, noAssert)\n}\n\nBuffer.prototype.readDoubleBE = function (offset, noAssert) {\n  return readDouble(this, offset, false, noAssert)\n}\n\nBuffer.prototype.writeUInt8 = function (value, offset, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xff)\n  }\n\n  if (offset >= this.length) return\n\n  this[offset] = value\n  return offset + 1\n}\n\nfunction writeUInt16 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xffff)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  for (var i = 0, j = Math.min(len - offset, 2); i < j; i++) {\n    buf[offset + i] =\n        (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n            (littleEndian ? i : 1 - i) * 8\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16LE = function (value, offset, noAssert) {\n  return writeUInt16(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeUInt16BE = function (value, offset, noAssert) {\n  return writeUInt16(this, value, offset, false, noAssert)\n}\n\nfunction writeUInt32 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'trying to write beyond buffer length')\n    verifuint(value, 0xffffffff)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  for (var i = 0, j = Math.min(len - offset, 4); i < j; i++) {\n    buf[offset + i] =\n        (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32LE = function (value, offset, noAssert) {\n  return writeUInt32(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeUInt32BE = function (value, offset, noAssert) {\n  return writeUInt32(this, value, offset, false, noAssert)\n}\n\nBuffer.prototype.writeInt8 = function (value, offset, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset < this.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7f, -0x80)\n  }\n\n  if (offset >= this.length)\n    return\n\n  if (value >= 0)\n    this.writeUInt8(value, offset, noAssert)\n  else\n    this.writeUInt8(0xff + value + 1, offset, noAssert)\n  return offset + 1\n}\n\nfunction writeInt16 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 1 < buf.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7fff, -0x8000)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  if (value >= 0)\n    writeUInt16(buf, value, offset, littleEndian, noAssert)\n  else\n    writeUInt16(buf, 0xffff + value + 1, offset, littleEndian, noAssert)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16LE = function (value, offset, noAssert) {\n  return writeInt16(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeInt16BE = function (value, offset, noAssert) {\n  return writeInt16(this, value, offset, false, noAssert)\n}\n\nfunction writeInt32 (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')\n    verifsint(value, 0x7fffffff, -0x80000000)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  if (value >= 0)\n    writeUInt32(buf, value, offset, littleEndian, noAssert)\n  else\n    writeUInt32(buf, 0xffffffff + value + 1, offset, littleEndian, noAssert)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32LE = function (value, offset, noAssert) {\n  return writeInt32(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeInt32BE = function (value, offset, noAssert) {\n  return writeInt32(this, value, offset, false, noAssert)\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')\n    verifIEEE754(value, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    assert(value !== undefined && value !== null, 'missing value')\n    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')\n    assert(offset !== undefined && offset !== null, 'missing offset')\n    assert(offset + 7 < buf.length,\n        'Trying to write beyond buffer length')\n    verifIEEE754(value, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n\n  var len = buf.length\n  if (offset >= len)\n    return\n\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// fill(value, start=0, end=buffer.length)\nBuffer.prototype.fill = function (value, start, end) {\n  if (!value) value = 0\n  if (!start) start = 0\n  if (!end) end = this.length\n\n  assert(end >= start, 'end < start')\n\n  // Fill 0 bytes; we're done\n  if (end === start) return\n  if (this.length === 0) return\n\n  assert(start >= 0 && start < this.length, 'start out of bounds')\n  assert(end >= 0 && end <= this.length, 'end out of bounds')\n\n  var i\n  if (typeof value === 'number') {\n    for (i = start; i < end; i++) {\n      this[i] = value\n    }\n  } else {\n    var bytes = utf8ToBytes(value.toString())\n    var len = bytes.length\n    for (i = start; i < end; i++) {\n      this[i] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\nBuffer.prototype.inspect = function () {\n  var out = []\n  var len = this.length\n  for (var i = 0; i < len; i++) {\n    out[i] = toHex(this[i])\n    if (i === exports.INSPECT_MAX_BYTES) {\n      out[i + 1] = '...'\n      break\n    }\n  }\n  return '<Buffer ' + out.join(' ') + '>'\n}\n\n/**\n * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.\n * Added in Node 0.12. Only available in browsers that support ArrayBuffer.\n */\nBuffer.prototype.toArrayBuffer = function () {\n  if (typeof Uint8Array !== 'undefined') {\n    if (Buffer._useTypedArrays) {\n      return (new Buffer(this)).buffer\n    } else {\n      var buf = new Uint8Array(this.length)\n      for (var i = 0, len = buf.length; i < len; i += 1) {\n        buf[i] = this[i]\n      }\n      return buf.buffer\n    }\n  } else {\n    throw new Error('Buffer.toArrayBuffer not supported in this browser')\n  }\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar BP = Buffer.prototype\n\n/**\n * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods\n */\nBuffer._augment = function (arr) {\n  arr._isBuffer = true\n\n  // save reference to original Uint8Array get/set methods before overwriting\n  arr._get = arr.get\n  arr._set = arr.set\n\n  // deprecated, will be removed in node 0.13+\n  arr.get = BP.get\n  arr.set = BP.set\n\n  arr.write = BP.write\n  arr.toString = BP.toString\n  arr.toLocaleString = BP.toString\n  arr.toJSON = BP.toJSON\n  arr.equals = BP.equals\n  arr.compare = BP.compare\n  arr.copy = BP.copy\n  arr.slice = BP.slice\n  arr.readUInt8 = BP.readUInt8\n  arr.readUInt16LE = BP.readUInt16LE\n  arr.readUInt16BE = BP.readUInt16BE\n  arr.readUInt32LE = BP.readUInt32LE\n  arr.readUInt32BE = BP.readUInt32BE\n  arr.readInt8 = BP.readInt8\n  arr.readInt16LE = BP.readInt16LE\n  arr.readInt16BE = BP.readInt16BE\n  arr.readInt32LE = BP.readInt32LE\n  arr.readInt32BE = BP.readInt32BE\n  arr.readFloatLE = BP.readFloatLE\n  arr.readFloatBE = BP.readFloatBE\n  arr.readDoubleLE = BP.readDoubleLE\n  arr.readDoubleBE = BP.readDoubleBE\n  arr.writeUInt8 = BP.writeUInt8\n  arr.writeUInt16LE = BP.writeUInt16LE\n  arr.writeUInt16BE = BP.writeUInt16BE\n  arr.writeUInt32LE = BP.writeUInt32LE\n  arr.writeUInt32BE = BP.writeUInt32BE\n  arr.writeInt8 = BP.writeInt8\n  arr.writeInt16LE = BP.writeInt16LE\n  arr.writeInt16BE = BP.writeInt16BE\n  arr.writeInt32LE = BP.writeInt32LE\n  arr.writeInt32BE = BP.writeInt32BE\n  arr.writeFloatLE = BP.writeFloatLE\n  arr.writeFloatBE = BP.writeFloatBE\n  arr.writeDoubleLE = BP.writeDoubleLE\n  arr.writeDoubleBE = BP.writeDoubleBE\n  arr.fill = BP.fill\n  arr.inspect = BP.inspect\n  arr.toArrayBuffer = BP.toArrayBuffer\n\n  return arr\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\n// slice(start, end)\nfunction clamp (index, len, defaultValue) {\n  if (typeof index !== 'number') return defaultValue\n  index = ~~index;  // Coerce to integer.\n  if (index >= len) return len\n  if (index >= 0) return index\n  index += len\n  if (index >= 0) return index\n  return 0\n}\n\nfunction coerce (length) {\n  // Coerce length to a number (possibly NaN), round up\n  // in case it's fractional (e.g. 123.456) then do a\n  // double negate to coerce a NaN to 0. Easy, right?\n  length = ~~Math.ceil(+length)\n  return length < 0 ? 0 : length\n}\n\nfunction isArray (subject) {\n  return (Array.isArray || function (subject) {\n    return Object.prototype.toString.call(subject) === '[object Array]'\n  })(subject)\n}\n\nfunction isArrayish (subject) {\n  return isArray(subject) || Buffer.isBuffer(subject) ||\n      subject && typeof subject === 'object' &&\n      typeof subject.length === 'number'\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    var b = str.charCodeAt(i)\n    if (b <= 0x7F) {\n      byteArray.push(b)\n    } else {\n      var start = i\n      if (b >= 0xD800 && b <= 0xDFFF) i++\n      var h = encodeURIComponent(str.slice(start, i+1)).substr(1).split('%')\n      for (var j = 0; j < h.length; j++) {\n        byteArray.push(parseInt(h[j], 16))\n      }\n    }\n  }\n  return byteArray\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(str)\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; i++) {\n    if ((i + offset >= dst.length) || (i >= src.length))\n      break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n\n/*\n * We have to make sure that the value is a valid integer. This means that it\n * is non-negative. It has no fractional component and that it does not\n * exceed the maximum allowed value.\n */\nfunction verifuint (value, max) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value >= 0, 'specified a negative value for writing an unsigned value')\n  assert(value <= max, 'value is larger than maximum value for type')\n  assert(Math.floor(value) === value, 'value has a fractional component')\n}\n\nfunction verifsint (value, max, min) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value <= max, 'value larger than maximum allowed value')\n  assert(value >= min, 'value smaller than minimum allowed value')\n  assert(Math.floor(value) === value, 'value has a fractional component')\n}\n\nfunction verifIEEE754 (value, max, min) {\n  assert(typeof value === 'number', 'cannot write a non-number as a number')\n  assert(value <= max, 'value larger than maximum allowed value')\n  assert(value >= min, 'value smaller than minimum allowed value')\n}\n\nfunction assert (test, message) {\n  if (!test) throw new Error(message || 'Failed assertion')\n}\n","function Mapper()\n{\n  var sources = {};\n\n\n  this.forEach = function(callback)\n  {\n    for(var key in sources)\n    {\n      var source = sources[key];\n\n      for(var key2 in source)\n        callback(source[key2]);\n    };\n  };\n\n  this.get = function(id, source)\n  {\n    var ids = sources[source];\n    if(ids == undefined)\n      return undefined;\n\n    return ids[id];\n  };\n\n  this.remove = function(id, source)\n  {\n    var ids = sources[source];\n    if(ids == undefined)\n      return;\n\n    delete ids[id];\n\n    if(!Object.keys(ids).length)\n      delete sources[source];\n  };\n\n  this.set = function(value, id, source)\n  {\n    if(value == undefined)\n      return this.remove(id, source);\n\n    var ids = sources[source];\n    if(ids == undefined)\n      sources[source] = ids = {};\n\n    ids[id] = value;\n  };\n};\n\n\nMapper.prototype.pop = function(id, source)\n{\n  var value = this.get(id, source);\n  if(value == undefined)\n    return undefined;\n\n  this.remove(id, source);\n\n  return value;\n};\n\n\nmodule.exports = Mapper;\n","var JsonRPC = require('./JsonRPC');\nvar XmlRPC  = require('./XmlRPC');\n\n\nexports.JsonRPC = JsonRPC;\nexports.XmlRPC  = XmlRPC;\n","/**\n * JsonRPC 2.0 packer\n */\n\n/**\n * Pack a JsonRPC 2.0 message\n *\n * @param {Object} message - object to be packaged. It requires to have all the\n *   fields needed by the JsonRPC 2.0 message that it's going to be generated\n *\n * @return {String} - the stringified JsonRPC 2.0 message\n */\nfunction pack(message, id)\n{\n  var result =\n  {\n    jsonrpc: \"2.0\"\n  };\n\n  // Request\n  if(message.method)\n  {\n    result.method = message.method;\n\n    if(message.params)\n      result.params = message.params;\n\n    // Request is a notification\n    if(id != undefined)\n      result.id = id;\n  }\n\n  // Response\n  else if(id != undefined)\n  {\n    if(message.error)\n    {\n      if(message.result !== undefined)\n        throw new TypeError(\"Both result and error are defined\");\n\n      result.error = message.error;\n    }\n    else if(message.result !== undefined)\n      result.result = message.result;\n    else\n      throw new TypeError(\"No result or error is defined\");\n\n    result.id = id;\n  };\n\n  return JSON.stringify(result);\n};\n\n/**\n * Unpack a JsonRPC 2.0 message\n *\n * @param {String} message - string with the content of the JsonRPC 2.0 message\n *\n * @throws {TypeError} - Invalid JsonRPC version\n *\n * @return {Object} - object filled with the JsonRPC 2.0 message content\n */\nfunction unpack(message)\n{\n  var result = message;\n\n  if(typeof message == 'string' || message instanceof String)\n    result = JSON.parse(message);\n\n  // Check if it's a valid message\n\n  var version = result.jsonrpc;\n  if(version != \"2.0\")\n    throw new TypeError(\"Invalid JsonRPC version '\"+version+\"': \"+message);\n\n  // Response\n  if(result.method == undefined)\n  {\n    if(result.id == undefined)\n      throw new TypeError(\"Invalid message: \"+message);\n\n    var result_defined = result.result !== undefined;\n    var error_defined  = result.error  !== undefined;\n\n    // Check only result or error is defined, not both or none\n    if(result_defined && error_defined)\n      throw new TypeError(\"Both result and error are defined: \"+message);\n\n    if(!result_defined && !error_defined)\n      throw new TypeError(\"No result or error is defined: \"+message);\n\n    result.ack = result.id;\n    delete result.id;\n  }\n\n  // Return unpacked message\n  return result;\n};\n\n\nexports.pack   = pack;\nexports.unpack = unpack;\n","function pack(message)\n{\n  throw new TypeError(\"Not yet implemented\");\n};\n\nfunction unpack(message)\n{\n  throw new TypeError(\"Not yet implemented\");\n};\n\n\nexports.pack   = pack;\nexports.unpack = unpack;\n","exports.read = function(buffer, offset, isLE, mLen, nBytes) {\n  var e, m,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      nBits = -7,\n      i = isLE ? (nBytes - 1) : 0,\n      d = isLE ? -1 : 1,\n      s = buffer[offset + i];\n\n  i += d;\n\n  e = s & ((1 << (-nBits)) - 1);\n  s >>= (-nBits);\n  nBits += eLen;\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  m = e & ((1 << (-nBits)) - 1);\n  e >>= (-nBits);\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity);\n  } else {\n    m = m + Math.pow(2, mLen);\n    e = e - eBias;\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n};\n\nexports.write = function(buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),\n      i = isLE ? 0 : (nBytes - 1),\n      d = isLE ? 1 : -1,\n      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;\n\n  value = Math.abs(value);\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0;\n    e = eMax;\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2);\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * Math.pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n      e = 0;\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);\n\n  e = (e << mLen) | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);\n\n  buffer[offset + i - d] |= s * 128;\n};\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar ZERO   = '0'.charCodeAt(0)\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\tmodule.exports.toByteArray = b64ToByteArray\n\tmodule.exports.fromByteArray = uint8ToBase64\n}())\n"]}