{"version":3,"file":"bundle.js","sources":["../lib/MessagePacker.js","../lib/PeerConnection_channels.shim.js","../lib/WebP2P.js","../lib/connectors/PubNub.js","../lib/connectors/core/Connector.js","../lib/connectors/core/DataChannel.js","../lib/connectors/core/HandshakeConnector.js","../lib/errors.js","../lib/index.js","../lib/managers/HandshakeManager.js","../lib/managers/Manager.js","../lib/managers/PeersManager.js","../node_modules/grunt-browserify/node_modules/browserify/node_modules/events/events.js","../shim/pubnub.min.js"],"names":["MessagePacker","sessionID","storeResponse","message","dest","stored","response","timeout","setTimeout","clearTimeout","responses","BASE_TIMEOUT","requestID","requests","this","pack","result","Array","type","PRESENCE","OFFER","ANSWER","error","Error","from","id","Math","min","ttl","MAX_TTL_DEFAULT","sdp","unpack","request_ids","request","callback","presence","offer","dispatchCallback","request_id","Object","keys","length","answer","module","exports","applyChannelsShim","pc","initChannel","channel","starter","defineProperty","value","channels","push","addEventListener","splice","indexOf","undefined","getDataChannels","dispatchEvent","event","call","createDataChannel","label","dataChannelDict","Event","WebP2P","options","onerror","self","emit","createPeerConnection","callbackType","RTCPeerConnection","iceServers","url","stun_server","optional","DtlsSrtpKeyAgreement","routingLabel","candidate","localDescription","console","signalingState","peersManager","add","initPeerConnection_Offer","labels","commonLabels","concat","i","mediaConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","createOffer","setLocalDescription","log","initPeerConnection_Answer","setRemoteDescription","RTCSessionDescription","createAnswer","forward","connector","warning","messagepacker","peer","_connectors","send","handshakeManager","initManagerEvents","manager","on","status","get","increaseConnections","warn","UUIDv4","b","a","random","toString","replace","handshake_servers","HandshakeManager","PeersManager","__defineGetter__","connectTo","close","window","EventEmitter","require","webkitRTCPeerConnection","prototype","__proto__","constructor","Connector_PubNub","config_init","config_mess","HandshakeConnector","pubnub","PUBNUB","init","subscribe","restore","backfill","connect","_open","_message","disconnect","_close","_error","unsubscribe","publish","max_connections","max_chars","Connector","TypeError","Connector_DataChannel","datachannel","JSON","parse","data","stringify","shouldConnect","connections","Number","POSITIVE_INFINITY","ERROR_NETWORK_UNKNOWN","msg","ERROR_NETWORK_OFFLINE","ERROR_REQUEST_FAILURE","ERROR_REQUEST_EMPTY","ERROR_NO_PEERS","createConnector","config","connectorConstructor","handshakeConnectorConstructors","_initConnector","_messageUnpacked","handshake","configs","index","Manager","registerConnectorConstructor","configs_infinity","addConfigs_byObject","addConfigs_byArray","configuration","addConfigs_byUri","json_uri","dispatchError","http_request","XMLHttpRequest","open","onload","errors","navigator","onLine","addConfigs","incomingConnector","peers","peerConnection","_events","_maxListeners","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","er","handler","len","args","listeners","arguments","apply","slice","addListener","listener","m","newListener","warned","trace","once","g","removeListener","fired","list","position","removeAllListeners","key","ret","listenerCount","emitter","x","ga","aa","Date","J","ka","c","join","ca","d","Q","t","encodeURIComponent","da","la","e","na","oa","fa","ja","hasOwnProperty","pa","qa","j","sort","ra","C","ba","I","u","valueOf","lastIndex","test","H","charCodeAt","h","p","f","q","r","k","isFinite","String","s","\\b","\\t","\\n","\\f","\\r","\"","\\\\","eval","G","P","ha","floor","split","sa","CryptoJS","HmacSHA256","enc","Base64","ta","document","getElementById","ua","va","getElementsByTagName","U","cancelBubble","preventDefault","stopPropagation","attachEvent","xa","V","setAttribute","getAttribute","ya","style","Ba","createElement","Da","Ca","W","Fa","M","ea","N","O","D","parentNode","removeChild","L","responseText","abort","XDomainRequest","onabort","onloadend","onreadystatechange","readyState","pnsdk","Ea","Ga","src","appendChild","Ha","Ia","userAgent","opera","postError","Ja","Ka","localStorage","getItem","cookie","match","RegExp","set","setItem","Y","unbind","bind","fire","Z","La","ia","z","time","R","Na","E","Oa","y","A","shift","jsonp","subscribe_key","uuid","xdr","db","_is_online","jsonp_cb","PNSDK","hmac_SHA256","windowing","keepalive","noleave","publish_key","auth_key","secret_key","ssl","origin","K","wa","za","Aa","ma","S","no_wait_for_pending","l","F","T","B","LEAVE","X","auth","v","history","count","limit","reverse","w","start","end","stringtoken","replay","source","destination","stop","Pa","err","prepend","action","name","reconnect","idle","noheresync","timetoken","here_now","uuids","timestamp","occupancy","grant","read","write","getTime","signature","audit","revoke","set_uuid","get_uuid","ready","map","each","each-channel","grep","offline","supplant","now","unique","updater","css","$","create","head","search","attr","events","notest","location","href","jQuery","top","innerHTML","rdx","unescape","Ma","ws","protocol","CONNECTING","OPEN","CLOSING","CLOSED","CLOSE_NORMAL","CLOSE_GOING_AWAY","CLOSE_PROTOCOL_ERROR","CLOSE_UNSUPPORTED","CLOSE_TOO_LARGE","CLOSE_NO_STATUS","CLOSE_ABNORMAL","onclose","onmessage","onopen","onsend","binaryType","extensions","bufferedAmount","trasnmitting","buffer","code","reason","wasClean"],"mappings":"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","sourcesContent":["/**\n * Based on code from RPC-Builder\n */\n\n\nconst PRESENCE = 0;\nconst OFFER    = 1;\nconst ANSWER   = 2;\n\nconst MAX_TTL_DEFAULT = 5;\n\nconst BASE_TIMEOUT = 5000;\n\n\nfunction MessagePacker(sessionID)\n{\n  var requestID = 0;\n\n  var requests  = {};\n  var responses = {};\n\n\n  /**\n   * Store the response to prevent to process duplicate request later\n   */\n  function storeResponse(message, dest)\n  {\n    message.stored = true;\n\n    var response =\n    {\n      message: message,\n      timeout: setTimeout(function()\n      {\n        clearTimeout(response.timeout);\n        delete responses[dest];\n      },\n      BASE_TIMEOUT)\n    };\n    responses[dest] = response;\n  };\n\n\n  //\n  // Pack & Unpack\n  //\n\n  this.pack = function(message)\n  {\n    var result = new Array(6);\n\n    // Type\n    var type = message.type;\n    switch(type)\n    {\n      case \"presence\":\n        result[0] = PRESENCE;\n      break;\n\n      case \"offer\":\n        result[0] = OFFER;\n      break;\n\n      case \"answer\":\n        result[0] = ANSWER;\n      break;\n\n      default:\n      {\n        var error = Error(\"Unknown message type '\"+type+\"'\");\n            error.message = message;\n\n        throw error;\n      };\n    };\n\n    // From\n    result[1] = message.from || sessionID;\n\n    // Offer & Answer\n\n    if(result.type != PRESENCE)\n    {\n      var id = message.id  || requestID++;\n\n      result[2] = message.dest;\n      result[3] = id;\n      result[4] = Math.min(message.ttl || MAX_TTL_DEFAULT, MAX_TTL_DEFAULT);\n      result[5] = message.sdp;\n    };\n\n    return result;\n  };\n\n  this.unpack = function(message)\n  {\n    var result = {};\n\n    // Type\n    var type = message[0];\n    switch(type)\n    {\n      case PRESENCE:\n        result.type = \"presence\";\n      break;\n\n      case OFFER:\n        result.type = \"offer\";\n      break;\n\n      case ANSWER:\n        result.type = \"answer\";\n      break;\n\n      default:\n      {\n        var error = Error(\"Unknown message type '\"+type+\"'\");\n            error.message = message;\n\n        throw error;\n      };\n    };\n\n    // From\n    result.from = message[1];\n\n    // Offer & Answer\n\n    if(type != PRESENCE)\n    {\n      result.dest = message[2];\n      result.id   = message[3];\n      result.ttl  = message[4];\n      result.sdp  = message[5];\n    };\n\n    // Dispatch responses callbacks\n    var from = result.from;\n    var id   = result.id;\n\n    if(result.type == 'offer')\n    {\n      // Check if it's a re-try\n      var response = responses[from];\n      if(response)\n      {\n        var message = response.message;\n\n        // Old message, ignore it\n        if(message.id > id)\n          return;\n\n        // Updated message (or duplicated one), delete old response\n        clearTimeout(response.timeout);\n        delete responses[from];\n\n        // Duplicated message, re-send it\n        if(message.id == id)\n        {\n          // Store the response to prevent to process duplicate request later\n          storeResponse(message, from);\n\n          // Return the stored response so it can be directly send back\n          return message;\n        };\n      };\n    };\n\n    if(result.type == 'answer')\n    {\n      var request_ids = requests[from];\n      if(request_ids)\n      {\n        var request = request_ids[id];\n        if(request)\n        {\n          request.callback(error, result);\n\n          // Return undefined to notify message has been procesed\n          return;\n        };\n      };\n    };\n\n    // Return unpacked message\n    return result;\n  };\n\n\n  //\n  // Application dependent messages\n  //\n\n  this.presence = function()\n  {\n    var message = this.pack(\n    {\n      type: \"presence\"\n    });\n\n    // Return the packed message\n    return message;\n  };\n\n  this.offer = function(dest, sdp, callback)\n  {\n    var message = this.pack(\n    {\n      type: \"offer\",\n      dest: dest,\n      sdp:  sdp\n    });\n\n    // Store callback if defined to be executed when received the response\n    if(callback)\n    {\n      var request_ids = requests[dest] = requests[dest] || {};\n\n      var id = message.id;\n\n      var request_id = request_ids[id] =\n      {\n        callback: dispatchCallback,\n        timeout:  setTimeout(function()\n        {\n          var error = new Error('Timed Out');\n              error.request = message;\n\n          dispatchCallback(error)\n        },\n        BASE_TIMEOUT)\n      };\n\n      function dispatchCallback(error, result)\n      {\n        clearTimeout(request_id.timeout);\n\n        delete request_ids[id];\n        if(!Object.keys(request_ids).length)\n          delete requests[dest];\n\n        callback(error, result);\n      };\n    };\n\n    // Return the packed message\n    return message;\n  };\n\n  this.answer = function(dest, id, sdp)\n  {\n    var message = this.pack(\n    {\n      type: \"answer\",\n      dest: dest,\n      id:   id,\n      sdp:  sdp\n    });\n\n    // Store the response to prevent to process duplicate request later\n    storeResponse(message, dest);\n\n    // Return the packed message\n    return message;\n  };\n};\n\n\nmodule.exports = MessagePacker;","/**\n * Add support to get a list of channels on a PeerConnection object\n */\nfunction applyChannelsShim(pc)\n{\n  if(pc.getDataChannels != undefined) return;\n\n  var channels = [];\n\n  pc.getDataChannels = function()\n  {\n    return channels;\n  };\n\n  function initChannel(channel, starter)\n  {\n    Object.defineProperty(channel, \"starter\", {value : starter});\n\n    channels.push(channel);\n\n    channel.addEventListener('close', function(event)\n    {\n      channels.splice(channels.indexOf(channel), 1);\n    });\n  };\n\n  // Add DataChannels created by remote PeerConnection object\n  var dispatchEvent = pc.dispatchEvent;\n  pc.dispatchEvent = function(event)\n  {\n    if(event.type == 'datachannel')\n    {\n      var channel = event.channel;\n\n      initChannel(channel, false);\n    };\n\n    // Dispatch events\n    dispatchEvent.call(this, event);\n  };\n\n  // Add DataChannels created by local PeerConnection object\n  var createDataChannel = pc.createDataChannel;\n  pc.createDataChannel = function(label, dataChannelDict)\n  {\n    var channel = createDataChannel.call(this, label, dataChannelDict);\n\n    initChannel(channel, true);\n\n    // Dispatch datachannel events for local created ones\n    var event = new Event('datachannel');\n        event.channel = channel;\n\n    dispatchEvent.call(this, event);\n  };\n};\n\n\nmodule.exports = applyChannelsShim;","var EventEmitter = require(\"events\").EventEmitter;\n\n//var uuid = require('uuid');\n\nvar HandshakeManager = require('./managers/HandshakeManager');\nvar PeersManager     = require('./managers/PeersManager');\n\nvar MessagePacker = require('./MessagePacker');\n\nvar applyChannelsShim = require(\"./PeerConnection_channels.shim\");\n\n\nvar RTCPeerConnection = RTCPeerConnection || webkitRTCPeerConnection;\n\n\n/**\n * @classdesc Init and connect to the WebP2P.io network\n *\n * @constructor\n */\nfunction WebP2P(options)\n{\n  var self = this;\n\n\n  /**\n   * UUID generator\n   */\n  var UUIDv4 = function b(a)\n  {\n    return a ? (a ^ Math.random() * 16 >> a / 4).toString(16) : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, b);\n  };\n\n\n  var options = options || {};\n\n  // Internal options\n  var commonLabels      = options.commonLabels || [];\n  var handshake_servers = options.handshake_servers;\n  var stun_server       = options.stun_server || 'stun.l.google.com:19302';\n\n  // Read-only options\n  Object.defineProperty(this, \"routingLabel\",\n  {\n    value: options.routingLabel || \"webp2p\"\n  });\n  Object.defineProperty(this, \"sessionID\",\n  {\n    value: options.sessionID || UUIDv4()\n//    value: options.sessionID || uuid.v4()\n  });\n\n\n  var messagepacker = new MessagePacker(this.sessionID);\n\n  var handshakeManager = new HandshakeManager(messagepacker, handshake_servers);\n  var peersManager     = new PeersManager(messagepacker, self.routingLabel);\n\n  this.__defineGetter__(\"status\", function()\n  {\n    if(peersManager.status == 'connected')\n      return 'connected'\n\n    return handshakeManager.status\n  });\n\n\n  function onerror(error)\n  {\n    self.emit('error', new Error(error));\n  };\n\n\n  /**\n   * Create a new RTCPeerConnection\n   * @param {UUID} id Identifier of the other peer so later can be accessed.\n   *\n   * @return {RTCPeerConnection}\n   */\n  function createPeerConnection(sessionID, callbackType, callback)\n  {\n    var pc = new RTCPeerConnection\n    (\n      {iceServers: [{url: 'stun:'+stun_server}]},\n      {optional: [{DtlsSrtpKeyAgreement: true}]}\n    );\n\n    applyChannelsShim(pc);\n\n    self.emit('peerconnection', pc);\n\n    pc.createDataChannel(self.routingLabel);\n\n    pc.addEventListener('icecandidate', function(event)\n    {\n      // There's a candidate, ignore it\n      if(event.candidate)\n        return;\n\n      // There's no candidate, send the full SDP\n      var type = this.localDescription.type;\n      var sdp  = this.localDescription.sdp;\n\n      if(type == callbackType)\n        callback(sdp)\n      else\n        console.error(type+\" SDP type is not equal to \"+callbackType+\" callback type\");\n    });\n\n    pc.addEventListener('signalingstatechange', function(event)\n    {\n      // Add PeerConnection object to available ones when gets open\n      if(pc.signalingState == 'open')\n        peersManager.add(sessionID, pc);\n    });\n\n    return pc;\n  };\n\n\n  function initPeerConnection_Offer(pc, labels)\n  {\n    // Set channels for this PeerConnection object\n    labels = commonLabels.concat(labels);\n    for(var i=0, label; label=labels[i]; i++)\n      pc.createDataChannel(label);\n\n    // Send offer\n    var mediaConstraints =\n    {\n      mandatory:\n      {\n        OfferToReceiveAudio: false,\n        OfferToReceiveVideo: false\n      }\n    };\n\n    pc.createOffer(function(offer)\n    {\n      // Set the peer local description\n      pc.setLocalDescription(offer,\n      function()\n      {\n        console.log(\"Offer LocalDescription created and set\");\n      },\n      onerror);\n    },\n    onerror,\n    mediaConstraints);\n  };\n\n  function initPeerConnection_Answer(pc, sdp)\n  {\n    // Process offer\n    pc.setRemoteDescription(new RTCSessionDescription(\n    {\n      sdp:  sdp,\n      type: 'offer'\n    }),\n    function()\n    {\n      // Send answer\n      pc.createAnswer(function(answer)\n      {\n        // Set the peer local description\n        pc.setLocalDescription(answer,\n        function()\n        {\n          console.log(\"Answer LocalDescription created and set\");\n        },\n        onerror);\n      },\n      onerror)\n    },\n    onerror);\n  };\n\n\n  //\n  // Connection methods\n  //\n\n  /**\n   * Callback to send the offer. If not defined send it to all connected peers.\n   *\n   * @callback WebP2P~ConnectToCallback\n   * @param {Error} error\n   * @param {RTCPeerConnection} peer - The (newly created) peer\n   */\n\n  /**\n   * Connects to another peer based on its UID. If we are already connected,\n   * it does nothing.\n   *\n   * @param {UUID} sessionID - Identifier of the other peer to be connected.\n   * @param {string[]} [labels] - Per-connection labels\n   * @param {WebP2P~ConnectToCallback} callback\n   */\n  this.connectTo = function(dest, labels, callback)\n  {\n    // Don't connect to uurself\n    if(dest == self.sessionID)\n    {\n      callback(new Error(\"Connecting to ourself\"));\n      return;\n    }\n\n    var peer = peersManager.get(dest);\n    if(peer)\n      callback(null, peer)\n\n    else\n    {\n      peer = createPeerConnection(dest, \"offer\", function(offer)\n      {\n        var message = messagepacker.offer(dest, offer, callback);\n\n        handshakeManager.send(message);\n        peersManager.send(message);\n      });\n\n      initPeerConnection_Offer(peer, labels);\n    }\n  };\n\n\n  //\n  // Managers\n  //\n\n  function forward(message, connector)\n  {\n    // Don't forward the message if TTL has been achieved\n    if(--message.ttl <= 0)\n    {\n      console.warning(\"TTL achieved: \"+message);\n      return;\n    };\n\n    var dest = message.dest;\n\n    message = messagepacker.pack(message);\n\n    // Search the peer between the ones currently connected\n    for(var i=0, peer; peer=peersManager._connectors[i]; i++)\n      if(peer.sessionID === dest)\n      {\n        peer.send(message);\n        return;\n      };\n\n    // Peer was not found, forward message to all the connectors\n    peersManager.send(message, connector);\n    handshakeManager.send(message, connector);\n  };\n\n\n  function initManagerEvents(manager)\n  {\n    //\n    // Basic events\n    //\n\n    manager.on('connected', function(connector)\n    {\n      if(handshakeManager.status != peersManager.status)\n        self.emit('connected');\n    });\n    manager.on('disconnected', function()\n    {\n      if(handshakeManager.status == peersManager.status)\n        self.emit('disconnected');\n    });\n    manager.on('error', function(error)\n    {\n      self.emit('error', error);\n    });\n\n    //\n    // Offer & answer events\n    //\n\n    manager.on('offer', function(message, connector)\n    {\n      var from = message.from;\n      var dest = message.dest;\n\n      // Ignore messages send by us\n      if(from == self.sessionID) return;\n\n      // Message is for us\n      if(dest == self.sessionID)\n      {\n        console.log(\"[\"+self.sessionID+\"] Received connection request from \"+from);\n\n        var id = message.id;\n\n        // Search the peer between the list of currently connected ones,\n        // or create it if it's not connected\n        var pc = createPeerConnection(from, \"answer\", function(answer)\n        {\n          var message = messagepacker.answer(from, id, answer);\n\n          // Send back the connection request over the same connector, since\n          // this should be the shortest path to connect both peers\n          connector.send(message);\n        });\n\n        initPeerConnection_Answer(pc, message.sdp);\n      }\n\n      // Forward message\n      else\n        forward(message, connector);\n    });\n\n    manager.on('answer', function(message, connector)\n    {\n      var from = message.from;\n      var dest = message.dest;\n\n      // Ignore messages send by us\n      if(from == self.sessionID) return;\n\n      // Message is for us\n      if(dest == self.sessionID)\n      {\n        console.log(\"[\"+self.sessionID+\"] Received connection response from \"+from);\n\n        var peer = peersManager.get(from);\n        if(peer)\n        {\n          peer.setRemoteDescription(new RTCSessionDescription(\n          {\n            sdp: sdp,\n            type: 'answer'\n          }),\n          function()\n          {\n            console.log(\"Successfuly generated RemoteDescription for \"+from);\n          },\n          onerror);\n\n          connector.increaseConnections();\n        }\n        else\n          console.warn(\"[\"+self.sessionID+\"] Connection with peer '\" + from + \"' was not previously requested\");\n      }\n\n      // Forward message\n      else\n        forward(message, connector);\n    });\n  };\n\n  // Init managers events\n\n  initManagerEvents(handshakeManager);\n  initManagerEvents(peersManager);\n\n  handshakeManager.on('presence', function(from, connector)\n  {\n    // Ignore messages send by us\n    if(from == self.sessionID) return;\n\n    var peer = peersManager.get(from);\n    if(!peer)\n    {\n      var pc = createPeerConnection(from, \"offer\", function(offer)\n      {\n        var message = messagepacker.offer(from, offer);\n\n        // Send back the connection request over the same connector, since this\n        // should be the shortest path to connect both peers\n        connector.send(message);\n      });\n\n      initPeerConnection_Offer(pc);\n    }\n  });\n\n\n  //\n  // Clossing functions\n  //\n\n  this.close = function()\n  {\n    handshakeManager.close();\n    peersManager.close();\n  };\n\n  // Close all connections when user goes out of the page\n  if(window)\n    window.addEventListener('beforeunload', function(event)\n    {\n      self.close();\n    });\n};\nWebP2P.prototype.__proto__   = EventEmitter.prototype;\nWebP2P.prototype.constructor = WebP2P;\n\n\nmodule.exports = WebP2P;","var HandshakeConnector = require(\"./core/HandshakeConnector\");\n\nvar PUBNUB = require(\"pubnub\");\n\n\n/**\n * Handshake connector for PubNub\n * @param {Object} configuration Configuration object.\n */\nfunction Connector_PubNub(config_init, config_mess)\n{\n  HandshakeConnector.call(this);\n\n  var self = this;\n\n  var channel = config_mess.channel;\n\n\n  // Connect a handshake connector to the PubNub server\n  var pubnub = PUBNUB.init(config_init);\n\n  // Configure handshake connector\n  pubnub.subscribe(\n  {\n    channel: channel,\n    restore: false,\n    backfill: false,\n\n    connect:    self._open,\n    message:    self._message,\n    disconnect: self._close,\n    error:      self._error\n  });\n\n\n  // Define methods\n\n  /**\n   * Close the connection with this handshake server\n   */\n  this.close = function()\n  {\n    pubnub.unsubscribe(\n    {\n      channel: channel\n    });\n\n    // This shouldn't be necesary, but seems 'disconnect' event is not being\n    // dispatched by the PubNub channel, so we close the connector explicitly\n    self._close();\n  }\n\n  /**\n   * Send the message\n   */\n  this.send = function(message)\n  {\n    pubnub.publish(\n    {\n      channel: channel,\n      message: message\n    });\n  };\n}\nConnector_PubNub.prototype.__proto__   = HandshakeConnector.prototype;\nConnector_PubNub.prototype.constructor = Connector_PubNub;\n\n//Class constants\nConnector_PubNub.prototype.max_connections = 50;\nConnector_PubNub.prototype.max_chars       = 1800;\n\n\nmodule.exports = Connector_PubNub;","var EventEmitter = require(\"events\").EventEmitter;\n\n\nfunction Connector()\n{\n  EventEmitter.call(this);\n\n  var self = this;\n\n\n  /**\n   * Notify that the connection to this handshake server is open\n   */\n  this._open = function()\n  {\n    self.emit('open');\n  };\n\n  this._message = function(message)\n  {\n    self.emit(\"message\", message);\n  };\n\n  this._close = function()\n  {\n    self.emit('close');\n  };\n\n  this._error = function(error)\n  {\n    self.emit('error', error);\n  };\n};\nConnector.prototype.__proto__   = EventEmitter.prototype;\nConnector.prototype.constructor = Connector;\n\nConnector.prototype.close = function()\n{\n  throw new TypeError(\"Connector.close should be defined in a child class\");\n};\nConnector.prototype.send = function(message)\n{\n  throw new TypeError(\"Connector.send should be defined in a child class\");\n};\n\n\nmodule.exports = Connector;","var Connector = require(\"./Connector\");\n\n\nfunction Connector_DataChannel(datachannel)\n{\n  Connector.call(this);\n\n  var self = this;\n\n\n  datachannel.addEventListener('open',  self._open);\n  datachannel.addEventListener('message', function(event)\n  {\n    self._message(JSON.parse(event.data));\n  });\n  datachannel.addEventListener('close', self._close);\n  datachannel.addEventListener('error', self._error);\n\n\n  // Define methods\n\n  /**\n   * Close the connection with the peer\n   */\n  this.close = function()\n  {\n    datachannel.close();\n  };\n\n  /**\n   * Send the message\n   */\n  this.send = function(message)\n  {\n    datachannel.send(JSON.stringify(message));\n  };\n};\nConnector_DataChannel.prototype.__proto__   = Connector.prototype;\nConnector_DataChannel.prototype.constructor = Connector_DataChannel;\n\n\nmodule.exports = Connector_DataChannel;","var Connector = require(\"./Connector\");\n\n\nfunction HandshakeConnector()\n{\n  Connector.call(this);\n\n  var self = this;\n\n\n  /**\n   * Check if we should connect this new peer or ignore it to increase entropy\n   * in the network mesh\n   *\n   * @returns {Boolean}\n   */\n  this.shouldConnect = function()\n  {\n    return true;\n  };\n\n\n  // Count the maximum number of pending connections allowed to be\n  // done with this handshake server (undefined == unlimited)\n  var connections = 0;\n\n  this.increaseConnections = function()\n  {\n    // Increase the number of connections reached throught\n    // this handshake server\n    connections++;\n\n    // Close connection with handshake server if we got its quota of peers\n    if(connections >= self.max_connections)\n       self.close();\n  };\n};\nHandshakeConnector.prototype.__proto__   = Connector.prototype;\nHandshakeConnector.prototype.constructor = HandshakeConnector;\n\n// Class constants\nHandshakeConnector.prototype.max_connections = Number.POSITIVE_INFINITY;\n\n\nmodule.exports = HandshakeConnector;","const ERROR_NETWORK_UNKNOWN = {id: 0, msg: 'Unable to fetch handshake servers configuration'};\nconst ERROR_NETWORK_OFFLINE = {id: 1, msg: \"There's no available network\"};\nconst ERROR_REQUEST_FAILURE = {id: 2, msg: 'Unable to fetch handshake servers configuration'};\nconst ERROR_REQUEST_EMPTY   = {id: 3, msg: 'Handshake servers configuration is empty'};\n\nconst ERROR_NO_PEERS        = {id: 4, msg: 'Not connected to any peer'};\n\n\nexports.ERROR_NETWORK_UNKNOWN = ERROR_NETWORK_UNKNOWN;\nexports.ERROR_NETWORK_OFFLINE = ERROR_NETWORK_OFFLINE;\nexports.ERROR_REQUEST_FAILURE = ERROR_REQUEST_FAILURE;\nexports.ERROR_REQUEST_EMPTY   = ERROR_REQUEST_EMPTY;\nexports.ERROR_NO_PEERS        = ERROR_NO_PEERS;","/**\n * New node file\n */\nvar HandshakeConnector = require('./connectors/core/HandshakeConnector');\nvar WebP2P             = require('./WebP2P');\n\n\nmodule.exports = WebP2P;\nmodule.exports.HandshakeConnector = HandshakeConnector;","var Manager = require('./Manager');\n\nvar errors = require('../errors');\n\n\nvar Connector_PubNub = require('../connectors/PubNub');\n\n\n/**\n * Manage the handshake connectors using several servers\n *\n * @constructor\n * @param {String} json_uri URI of the handshake servers configuration.\n */\nfunction HandshakeManager(messagepacker, handshake_servers)\n{\n  Manager.call(this, messagepacker);\n\n  var self = this;\n\n\n  var handshakeConnectorConstructors = {};\n\n  this.registerConnectorConstructor = function(type, constructor)\n  {\n    handshakeConnectorConstructors[type] = constructor\n  };\n\n\n  // Default handshake connectors\n  this.registerConnectorConstructor('PubNub', Connector_PubNub);\n\n\n  function createConnector(config)\n  {\n    var type        = config.type;\n    var config_init = config.config_init;\n    var config_mess = config.config_mess;\n\n    // Check if connector constructor is from a valid handshake server\n    var connectorConstructor = handshakeConnectorConstructors[type];\n    if(!connectorConstructor)\n      throw Error(\"Invalid handshake server type '\" + type + \"'\");\n\n    var connector = new connectorConstructor(config_init, config_mess);\n\n    self._initConnector(connector);\n\n    connector.on('open', function()\n    {\n      // Notify our presence to the other peers\n      connector.send(messagepacker.presence());\n    });\n\n    var _messageUnpacked = connector._messageUnpacked;\n    connector._messageUnpacked = function(message)\n    {\n      if(message.type == 'presence')\n      {\n        if(connector.shouldConnect())\n          self.emit(\"presence\", message.from, connector);\n      }\n      else\n        _messageUnpacked.call(connector, message);\n    };\n\n    return connector;\n  };\n\n\n  var configs = [];\n  var index = 0;\n\n  var configs_infinity = [];\n\n  /**\n   * Get a random handshake connector or test for the next one\n   * @param {Object} configuration Handshake servers configuration.\n   */\n  function handshake()\n  {\n    if(!configs.length)\n      throw Error('No handshake servers defined')\n\n    for(; index < configs.length; index++)\n    {\n      var connector = createConnector(configs[index]);\n      if(connector)\n      {\n        connector.on('close', function()\n        {\n          // Handshake connector has been closed, try to get an alternative one\n          index++;\n          handshake();\n        });\n\n        // Connector successfully created\n        return;\n      };\n    };\n\n    // All configured handshake servers has been consumed\n    // Get ready to start again from beginning of handshake servers list\n    index = 0;\n  };\n\n\n  this.addConfigs_byObject = function(config)\n  {\n    // Check if connector constructor is from a valid handshake server\n    var connectorConstructor = handshakeConnectorConstructors[config.type];\n    if(!connectorConstructor)\n    {\n      console.error(\"Invalid handshake server config: \", config);\n      return;\n    };\n\n    if(connectorConstructor.prototype.max_connections == Number.POSITIVE_INFINITY)\n    {\n      configs_infinity.push(config)\n\n      // Start handshaking\n      createConnector(config);\n    }\n    else\n    {\n      configs.push(config);\n\n      // Start handshaking\n      if(self.status == 'disconnected')\n      {\n        if(index == undefined)\n           index = 0;\n\n        handshake();\n      }\n    }\n  };\n\n  this.addConfigs_byArray = function(configuration)\n  {\n    for(var i=0, config; config=configuration[i]; i++)\n      self.addConfigs_byObject(config);\n  };\n\n  this.addConfigs_byUri = function(json_uri)\n  {\n    function dispatchError(error)\n    {\n      self.emit('error', error);\n    };\n\n    // Request the handshake servers configuration file\n    var http_request = new XMLHttpRequest();\n\n    http_request.open('GET', json_uri);\n    http_request.onload = function(event)\n    {\n      if(this.status == 200)\n      {\n        var configuration = JSON.parse(http_request.response);\n\n        // We got some config entries\n        if(configuration.length)\n          this.addConfigs_byArray(configuration)\n\n        // Config was empty\n        else\n          dispatchError(errors.ERROR_REQUEST_EMPTY)\n      }\n\n      // Request returned an error\n      else\n        dispatchError(errors.ERROR_REQUEST_FAILURE)\n    };\n\n    // Connection error\n    http_request.onerror = function(event)\n    {\n      dispatchError(navigator.onLine ? errors.ERROR_NETWORK_UNKNOWN\n                                     : errors.ERROR_NETWORK_OFFLINE)\n    };\n\n    http_request.send();\n  };\n\n  this.addConfigs = function(configuration)\n  {\n    if(typeof configuration == 'string')\n      this.addConfigs_byUri(configuration)\n\n    else if(configuration instanceof Array)\n      this.addConfigs_byArray(configuration)\n\n    else\n      this.addConfigs_byObject(configuration)\n  };\n\n\n  // Add handshake servers configuration\n  if(handshake_servers)\n    this.addConfigs(handshake_servers)\n};\nHandshakeManager.prototype.__proto__   = Manager.prototype;\nHandshakeManager.prototype.constructor = HandshakeManager;\n\n\nmodule.exports = HandshakeManager;","var EventEmitter = require(\"events\").EventEmitter;\n\n\nfunction Manager(messagepacker)\n{\n  EventEmitter.call(this);\n\n  var self = this;\n\n\n  this._connectors = [];\n\n  this.__defineGetter__(\"status\", function()\n  {\n    return this._connectors.length ? 'connected' : 'disconnected';\n  });\n\n\n  this._initConnector = function(connector)\n  {\n    connector.on('open', function()\n    {\n      self._connectors.push(connector);\n\n      if(self._connectors.length == 1)\n         self.emit('connected');\n    });\n    connector.on('close', function()\n    {\n      self._connectors.splice(self._connectors.indexOf(connector), 1);\n\n      if(self._connectors.length == 0)\n         self.emit('disconnected');\n    });\n    connector.on('error', function(error)\n    {\n      connector.close();\n\n      self.emit('error', error);\n    });\n\n    connector._messageUnpacked = function(message)\n    {\n      switch(message.type)\n      {\n        case 'offer':\n        case 'answer':\n          self.emit(message.type, message, connector);\n        break;\n\n        default:\n          console.error(\"Unknown message type '\"+type+\"'\");\n          console.error(message);\n      };\n    };\n\n    connector.on('message', function(message)\n    {\n      message = messagepacker.unpack(message);\n      if(message)\n      {\n        // Response was previously stored, send it directly\n        if(message.stored)\n          connector.send(message)\n\n        // Normal message, process it\n        else\n          connector._messageUnpacked(message);\n      };\n    });\n  };\n\n\n  /**\n   * {Object} message - Message to be send\n   * {Connector} [incomingConnector] - {Connector} to don't send the message\n   */\n  this.send = function(message, incomingConnector)\n  {\n    for(var i=0, peer; peer=this._connectors[i]; i++)\n    {\n      // Don't send the message to the same connector where we received it\n      if(peer === incomingConnector)\n        continue;\n\n      peer.send(message);\n    };\n  };\n\n\n  /**\n   * Close all the connections\n   */\n  this.close = function()\n  {\n    for(var i=0, peer; peer=this._connectors[i]; i++)\n      peer.close();\n  };\n};\nManager.prototype.__proto__   = EventEmitter.prototype;\nManager.prototype.constructor = Manager;\n\n\nmodule.exports = Manager;","var Manager = require('./Manager');\n\nvar Connector_DataChannel = require('../connectors/core/DataChannel');\n\n\n/**\n * @classdesc Manager of the communications with the other peers\n *\n * @constructor\n */\nfunction PeersManager(messagepacker, routingLabel)\n{\n  Manager.call(this, messagepacker);\n\n  var self = this;\n\n\n  function createConnector(channel)\n  {\n    var connector = new Connector_DataChannel(channel);\n\n    this._initConnector(connector);\n\n    return connector;\n  };\n\n\n  var peers = {};\n\n  this.add = function(sessionID, peerConnection)\n  {\n    peerConnection.addEventListener('signalingstatechange', function(event)\n    {\n      // Remove the peer from the list of peers when gets closed\n      if(peerConnection.signalingState == 'closed')\n        delete peers[sessionID];\n    });\n\n    // Routing DataChannel, just init routing functionality on it\n    var channels = peerConnection.getDataChannels();\n\n    for(var i=0, channel; channel=channels[i]; i++)\n      if(channel.label == routingLabel)\n      {\n        createConnector(channel);\n        break;\n      }\n\n    // Add the PeerConnection to the list of enabled ones\n    peers[sessionID] = peerConnection;\n  };\n\n  this.get = function(sessionID)\n  {\n    return peers[sessionID];\n  };\n};\nPeersManager.prototype.__proto__   = Manager.prototype;\nPeersManager.prototype.constructor = PeersManager;\n\n\nmodule.exports = PeersManager;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      console.trace();\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","// Version: 3.5.48\n(function(){\nvar j=!0,t=null,u=!1;function x(){return function(){}}\nwindow.JSON&&window.JSON.stringify||function(){function a(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'\"'+a.replace(d,function(a){var b=H[a];return\"string\"===typeof b?b:\"\\\\u\"+(\"0000\"+a.charCodeAt(0).toString(16)).slice(-4)})+'\"':'\"'+a+'\"'}function b(d,h){var p,f,q,r,i,k=e,g=h[d];g&&\"object\"===typeof g&&(g=a.call(g));\"function\"===typeof m&&(g=m.call(h,d,g));switch(typeof g){case \"string\":return c(g);case \"number\":return isFinite(g)?String(g):\"null\";case \"boolean\":case \"null\":return String(g);\ncase \"object\":if(!g)return\"null\";e+=s;i=[];if(\"[object Array]\"===Object.prototype.toString.apply(g)){r=g.length;for(p=0;p<r;p+=1)i[p]=b(p,g)||\"null\";q=0===i.length?\"[]\":e?\"[\\n\"+e+i.join(\",\\n\"+e)+\"\\n\"+k+\"]\":\"[\"+i.join(\",\")+\"]\";e=k;return q}if(m&&\"object\"===typeof m){r=m.length;for(p=0;p<r;p+=1)f=m[p],\"string\"===typeof f&&(q=b(f,g))&&i.push(c(f)+(e?\": \":\":\")+q)}else for(f in g)Object.hasOwnProperty.call(g,f)&&(q=b(f,g))&&i.push(c(f)+(e?\": \":\":\")+q);q=0===i.length?\"{}\":e?\"{\\n\"+e+i.join(\",\\n\"+e)+\"\\n\"+\nk+\"}\":\"{\"+i.join(\",\")+\"}\";e=k;return q}}window.JSON||(window.JSON={});var d=/[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,e,s,H={\"\\b\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\f\":\"\\\\f\",\"\\r\":\"\\\\r\",'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\"},m;\"function\"!==typeof JSON.stringify&&(JSON.stringify=function(a,c,d){var f;s=e=\"\";if(\"number\"===typeof d)for(f=0;f<d;f+=1)s+=\" \";else\"string\"===typeof d&&(s=d);if((m=c)&&\"function\"!==typeof c&&(\"object\"!==typeof c||\"number\"!==\ntypeof c.length))throw Error(\"JSON.stringify\");return b(\"\",{\"\":a})});\"function\"!==typeof JSON.parse&&(JSON.parse=function(a){return eval(\"(\"+a+\")\")})}();var aa=1,C=u,ba=[],G=\"-pnpres\",I=1E3,ca=\"/\",da=\"&\",fa=/{([\\w\\-]+)}/g;function ga(){return\"x\"+ ++aa+\"\"+ +new Date}function J(){return+new Date}var P,ha=Math.floor(20*Math.random());P=function(a,c){return 0<a.indexOf(\"pubsub.\")&&a.replace(\"pubsub\",\"ps\"+(c?ja().split(\"-\")[0]:20>++ha?ha:ha=1))||a};\nfunction ka(a,c){var b=a.join(ca),d=[];if(!c)return b;Q(c,function(a,b){\"undefined\"!=typeof b&&(b!=t&&0<encodeURIComponent(b).length)&&d.push(a+\"=\"+encodeURIComponent(b))});return b+=\"?\"+d.join(da)}function la(a,c){function b(){e+c>J()?(clearTimeout(d),d=setTimeout(b,c)):(e=J(),a())}var d,e=0;return b}function na(a,c){var b=[];Q(a||[],function(a){c(a)&&b.push(a)});return b}function oa(a,c){return a.replace(fa,function(a,d){return c[d]||a})}\nfunction ja(a){var c=\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return(\"x\"==a?c:c&3|8).toString(16)});a&&a(c);return c}function Q(a,c){if(a&&c)if(\"undefined\"!=typeof a[0])for(var b=0,d=a.length;b<d;)c.call(a[b],a[b],b++);else for(b in a)a.hasOwnProperty&&a.hasOwnProperty(b)&&c.call(a[b],b,a[b])}function pa(a,c){var b=[];Q(a||[],function(a,e){b.push(c(a,e))});return b}function qa(a){var c=[];Q(a,function(a,d){d.j&&c.push(a)});return c.sort()}\nfunction ra(){setTimeout(function(){C||(C=1,Q(ba,function(a){a()}))},I)}\nif(!window.PUBNUB){var sa=function(a,c){return CryptoJS.HmacSHA256(a,c).toString(CryptoJS.enc.Base64)},ta=function(a){return document.getElementById(a)},ua=function(a){console.error(a)},va=function(a,c){var b=[];Q(a.split(/\\s+/),function(a){Q((c||document).getElementsByTagName(a),function(a){b.push(a)})});return b},U=function(a,c,b){Q(a.split(\",\"),function(a){function e(a){a||(a=window.event);b(a)||(a.cancelBubble=j,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}c.addEventListener?\nc.addEventListener(a,e,u):c.attachEvent?c.attachEvent(\"on\"+a,e):c[\"on\"+a]=e})},xa=function(){return va(\"head\")[0]},V=function(a,c,b){if(b)a.setAttribute(c,b);else return a&&a.getAttribute&&a.getAttribute(c)},ya=function(a,c){for(var b in c)if(c.hasOwnProperty(b))try{a.style[b]=c[b]+(0<\"|width|height|top|left|\".indexOf(b)&&\"number\"==typeof c[b]?\"px\":\"\")}catch(d){}},Ba=function(a){return document.createElement(a)},Da=function(){return Ca||W()?0:ga()},Fa=function(a){function c(a,b){M||(M=1,g.onerror=\nt,clearTimeout(ea),a||!b||N(b),setTimeout(function(){a&&O();var b=ta(D),c=b&&b.parentNode;c&&c.removeChild(b)},I))}if(Ca||W()){a:{var b,d,e=function(){if(!H){H=1;clearTimeout(L);try{d=JSON.parse(b.responseText)}catch(a){return r(1)}s=1;f(d)}},s=0,H=0,m=a.timeout||1E4,L=setTimeout(function(){r(1)},m),h=a.b||x(),p=a.data||{},f=a.c||x(),q=\"undefined\"===typeof a.g,r=function(a,c){s||(s=1,clearTimeout(L),b&&(b.onerror=b.onload=t,b.abort&&b.abort(),b=t),a&&h(c))};try{b=W()||window.XDomainRequest&&new XDomainRequest||\nnew XMLHttpRequest;b.onerror=b.onabort=function(){r(1,b.responseText||{error:\"Network Connection Error\"})};b.onload=b.onloadend=e;b.onreadystatechange=function(){if(b&&4==b.readyState)switch(b.status){case 401:case 402:case 403:try{d=JSON.parse(b.responseText),r(1,d)}catch(a){return r(1,b.responseText)}}};q&&(b.timeout=m);p.pnsdk=Ea;var i=ka(a.url,p);b.open(\"GET\",i,q);b.send()}catch(k){r(0);Ca=0;a=Fa(a);break a}a=r}return a}var g=Ba(\"script\"),e=a.a,D=ga(),M=0,ea=setTimeout(function(){c(1)},a.timeout||\n1E4),O=a.b||x(),m=a.data||{},N=a.c||x();window[e]=function(a){c(0,a)};a.g||(g[Ga]=Ga);g.onerror=function(){c(1)};m.pnsdk=Ea;g.src=ka(a.url,m);V(g,\"id\",D);xa().appendChild(g);return c},Ha=function(){return!(\"onLine\"in navigator)?1:navigator.onLine},W=function(){if(!Ia||!Ia.get)return 0;var a={id:W.id++,send:x(),abort:function(){a.id={}},open:function(c,b){W[a.id]=a;Ia.get(a.id,b)}};return a},Ga=\"async\",Ea=\"PubNub-JS-Web/3.5.48\",Ca=-1==navigator.userAgent.indexOf(\"MSIE 6\");window.console||(window.console=\nwindow.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||x());var Ja,Ka=window.localStorage;Ja={get:function(a){try{return Ka?Ka.getItem(a):-1==document.cookie.indexOf(a)?t:((document.cookie||\"\").match(RegExp(a+\"=([^;]+)\"))||[])[1]||t}catch(c){}},set:function(a,c){try{if(Ka)return Ka.setItem(a,c)&&0;document.cookie=a+\"=\"+c+\"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/\"}catch(b){}}};var Y={list:{},unbind:function(a){Y.list[a]=[]},bind:function(a,c){(Y.list[a]=Y.list[a]||\n[]).push(c)},fire:function(a,c){Q(Y.list[a]||[],function(a){a(c)})}},Z=ta(\"pubnub\")||0,La=function(a){function c(){}function b(a,b){function c(b){b&&(ia=J()-(b/1E4+(J()-d)/2),a&&a(ia))}var d=J();b&&c(b)||z.time(c)}function d(a,b){R&&R(a,b);R=t}function e(){z.time(function(a){b(x(),a);a||d(1,{error:\"Heartbeat failed to connect to Pubnub Servers.Please check your network settings.\"});setTimeout(e,q)})}function s(){Na()||d(1,{error:\"Offline. Please check your network settings. \"});setTimeout(s,I)}function H(a){var b=\n0;Q(qa(E),function(c){if(c=E[c])b++,(a||x())(c)});return b}function m(a){if(Oa){if(!y.length)return}else{a&&(y.h=0);if(y.h||!y.length)return;y.h=1}A(y.shift())}a.jsonp&&(Ca=0);var L=a.subscribe_key||\"\";a.uuid||Ja.get(L+\"uuid\");a.xdr=Fa;a.db=Ja;a.error=ua;a._is_online=Ha;a.jsonp_cb=Da;a.PNSDK=Ea;a.hmac_SHA256=sa;var h,p=+a.windowing||10,f=(+a.timeout||310)*I,q=(+a.keepalive||60)*I,r=a.noleave||0,i=a.publish_key||\"demo\",k=a.subscribe_key||\"demo\",g=a.auth_key||\"\",D=a.secret_key||\"\",M=a.PNSDK||\"\",ea=\na.hmac_SHA256,O=a.ssl?\"s\":\"\",N=\"http\"+O+\"://\"+(a.origin||\"pubsub.pubnub.com\"),K=P(N),wa=P(N),y=[],ia=0,za=0,Aa=0,R=0,ma=0,S=0,E={},Oa=a.no_wait_for_pending,A=a.xdr,l=a.error||x(),Na=a._is_online||function(){return 1},F=a.jsonp_cb||function(){return 0},T=a.db||{get:x(),set:x()},B=a.uuid||T&&T.get(k+\"uuid\")||\"\",z={LEAVE:function(a,b,c,d){var X={uuid:B,auth:g},e=P(N),c=c||x(),v=d||x(),d=F();if(0<a.indexOf(G))return j;if(r||!O||\"0\"==d)return u;\"0\"!=d&&(X.callback=d);A({g:b||O,timeout:2E3,a:d,data:X,c:function(a){\"object\"==\ntypeof a&&a.error?v(a):c(a)},b:v,url:[e,\"v2\",\"presence\",\"sub_key\",k,\"channel\",encodeURIComponent(a),\"leave\"]});return j},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||\"false\",X=a.error||x(),e=a.auth_key||g,v=a.channel,w=a.start,h=a.end,n={},i=F();if(!v)return l(\"Missing Channel\");if(!b)return l(\"Missing Callback\");if(!k)return l(\"Missing Subscribe Key\");n.stringtoken=\"true\";n.count=c;n.reverse=d;n.auth=e;i&&(n.callback=i);w&&(n.start=w);h&&(n.end=h);A({a:i,data:n,\nc:function(a){\"object\"==typeof a&&a.error?X(a):b(a)},b:X,url:[K,\"v2\",\"history\",\"sub-key\",k,\"channel\",encodeURIComponent(v)]})},replay:function(a){var b=b||a.callback||x(),c=a.auth_key||g,d=a.source,e=a.destination,h=a.stop,v=a.start,w=a.end,Pa=a.reverse,a=a.limit,n=F(),f={};if(!d)return l(\"Missing Source Channel\");if(!e)return l(\"Missing Destination Channel\");if(!i)return l(\"Missing Publish Key\");if(!k)return l(\"Missing Subscribe Key\");\"0\"!=n&&(f.callback=n);h&&(f.stop=\"all\");Pa&&(f.reverse=\"true\");\nv&&(f.start=v);w&&(f.end=w);a&&(f.count=a);f.auth=c;A({a:n,c:function(a){\"object\"==typeof a&&a.error?err(a):b(a)},b:function(){b([0,\"Disconnected\"])},url:[K,\"v1\",\"replay\",i,k,d,e],data:f})},auth:function(a){g=a;c()},time:function(a){var b=F();A({a:b,data:{uuid:B,auth:g},timeout:5*I,url:[K,\"time\",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,b){var b=b||a.callback||x(),c=a.message,d=a.channel,e=a.auth_key||g,h=a.error||x(),v=F(),w=\"push\";a.prepend&&(w=\"unshift\");if(!c)return l(\"Missing Message\");\nif(!d)return l(\"Missing Channel\");if(!i)return l(\"Missing Publish Key\");if(!k)return l(\"Missing Subscribe Key\");c=JSON.stringify(c);y[w]({a:v,timeout:5*I,url:[K,\"publish\",i,k,0,encodeURIComponent(d),v,encodeURIComponent(c)],data:{uuid:B,auth:e},b:function(a){h(a);m(1)},c:function(a){\"object\"==typeof a&&a.error?h(a):b(a);m(1)}});m()},unsubscribe:function(a,b){var d=a.channel,b=b||a.callback||x(),e=a.error||x();S=0;ma=1;d=pa((d.join?d.join(\",\"):\"\"+d).split(\",\"),function(a){if(E[a])return a+\",\"+a+G}).join(\",\");\nQ(d.split(\",\"),function(a){var c=j;a&&(C&&(c=z.LEAVE(a,0,b,e)),c||b({action:\"leave\"}),E[a]=0)});c()},subscribe:function(a,b){function e(a){a?setTimeout(c,I):(K=P(N,1),wa=P(N,1),setTimeout(function(){z.time(e)},I));H(function(b){if(a&&b.d)return b.d=0,b.m(b.name);!a&&!b.d&&(b.d=1,b.l(b.name))})}function h(){var a=F(),b=qa(E).join(\",\");b&&(d(),R=A({timeout:O,a:a,b:function(a){n(a);R=t;z.time(e)},data:{uuid:B,auth:m},url:[wa,\"subscribe\",k,encodeURIComponent(b),a,S],c:function(a){R=t;if(!a||\"object\"==\ntypeof a&&\"error\"in a&&a.error)return n(a),setTimeout(c,I);r(a[1]);S=!S&&ma&&T.get(k)||a[1];H(function(a){a.f||(a.f=1,a.k(a.name))});y&&(S=1E4,y=0);T.set(k,a[1]);var b,d=(2<a.length?a[2]:pa(E,function(b){return pa(Array(a[0].length).join(\",\").split(\",\"),function(){return b})}).join(\",\")).split(\",\");b=function(){var a=d.shift()||Aa;return[(E[a]||{}).a||za,a.split(G)[0]]};var e=J()-ia-+a[1]/1E4;Q(a[0],function(c){var d=b();d[0](c,a,d[1],e)});setTimeout(h,L)}}))}var i=a.channel,b=(b=b||a.callback)||\na.message,m=a.auth_key||g,v=a.connect||x(),w=a.reconnect||x(),q=a.disconnect||x(),n=a.error||x(),r=a.idle||x(),s=a.presence||0,D=a.noheresync||0,y=a.backfill||0,M=a.timetoken||0,O=a.timeout||f,L=a.windowing||p;ma=a.restore;S=M;if(!i)return l(\"Missing Channel\");if(!b)return l(\"Missing Callback\");if(!k)return l(\"Missing Subscribe Key\");Q((i.join?i.join(\",\"):\"\"+i).split(\",\"),function(a){var c=E[a]||{};E[Aa=a]={name:a,f:c.f,d:c.d,j:1,a:za=b,k:v,l:q,m:w};s&&(z.subscribe({channel:a+G,callback:s}),!c.j&&\n!D&&z.here_now({channel:a,callback:function(b){Q(\"uuids\"in b?b.uuids:[],function(c){s({action:\"join\",uuid:c,timestamp:J(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){d();setTimeout(h,L)};if(!C)return ba.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||x(),d=a.auth_key||g,e=a.channel,h=F(),d={uuid:B,auth:d};if(!e)return l(\"Missing Channel\");if(!b)return l(\"Missing Callback\");if(!k)return l(\"Missing Subscribe Key\");\"0\"!=h&&(d.callback=h);A({a:h,data:d,c:function(a){\"object\"==\ntypeof a&&a.error?c(a):b(a)},b:c,url:[K,\"v2\",\"presence\",\"sub_key\",k,\"channel\",encodeURIComponent(e)]})},grant:function(a,b){var b=a.callback||b,c=a.error||x(),d=a.channel,e=F(),h=a.ttl||-1,g=a.read?\"1\":\"0\",w=a.write?\"1\":\"0\",f=a.auth_key;if(!d)return l(\"Missing Channel\");if(!b)return l(\"Missing Callback\");if(!k)return l(\"Missing Subscribe Key\");if(!i)return l(\"Missing Publish Key\");if(!D)return l(\"Missing Secret Key\");\"0\"!=e&&(n.callback=e);var n=Math.floor((new Date).getTime()/1E3),m=ea(k+\"\\n\"+i+\n\"\\ngrant\\n\"+(f&&0<encodeURIComponent(f).length?\"auth=\"+encodeURIComponent(f)+\"&\":\"\")+\"channel=\"+encodeURIComponent(d)+\"&pnsdk=\"+encodeURIComponent(M)+\"&r=\"+g+\"&timestamp=\"+encodeURIComponent(n)+(-1<h?\"&ttl=\"+h:\"\")+\"&w=\"+w,D),m=m.replace(/\\+/g,\"-\"),m=m.replace(/\\//g,\"_\"),n={w:w,r:g,signature:m,channel:encodeURIComponent(d),timestamp:n};-1<h&&(n.ttl=h);f&&(n.auth=encodeURIComponent(f));A({a:e,data:n,c:function(a){b(a)},b:c,url:[K,\"v1\",\"auth\",\"grant\",\"sub-key\",k]})},audit:function(a,b){var b=a.callback||\nb,c=a.error||x(),d=a.channel,e=a.auth_key,h=F();if(!b)return l(\"Missing Callback\");if(!k)return l(\"Missing Subscribe Key\");if(!i)return l(\"Missing Publish Key\");if(!D)return l(\"Missing Secret Key\");\"0\"!=h&&(g.callback=h);var g=Math.floor((new Date).getTime()/1E3),f=k+\"\\n\"+i+\"\\naudit\\n\";e&&(f+=\"auth=\"+encodeURIComponent(e)+\"&\");d&&(f+=\"channel=\"+encodeURIComponent(d)+\"&\");var f=f+(\"pnsdk=\"+encodeURIComponent(M)+\"&timestamp=\"+g),f=ea(f,D),f=f.replace(/\\+/g,\"-\"),f=f.replace(/\\//g,\"_\"),g={signature:f,\ntimestamp:g};d&&(g.channel=encodeURIComponent(d));e&&(g.auth=encodeURIComponent(e));A({a:h,data:g,c:function(a){b(a)},b:c,url:[K,\"v1\",\"auth\",\"audit\",\"sub-key\",k]})},revoke:function(a,b){a.read=u;a.write=u;z.grant(a,b)},set_uuid:function(a){B=a;c()},get_uuid:function(){return B},xdr:A,ready:ra,db:T,uuid:ja,map:pa,each:Q,\"each-channel\":H,grep:na,offline:function(){d(1)},supplant:oa,now:J,unique:ga,updater:la};B||(B=z.uuid());T.set(k+\"uuid\",B);setTimeout(s,I);setTimeout(e,q);b();h=z;h.css=ya;h.$=ta;\nh.create=Ba;h.bind=U;h.head=xa;h.search=va;h.attr=V;h.events=Y;h.init=La;U(\"beforeunload\",window,function(){h[\"each-channel\"](function(a){h.LEAVE(a.name,0)});return j});if(a.notest)return h;U(\"offline\",window,h.offline);U(\"offline\",document,h.offline);return h};\"complete\"===document.readyState?setTimeout(ra,0):U(\"load\",window,function(){setTimeout(ra,0)});var $=Z||{};PUBNUB=La({notest:1,publish_key:V($,\"pub-key\"),subscribe_key:V($,\"sub-key\"),ssl:!document.location.href.indexOf(\"https\")||\"on\"==V($,\n\"ssl\"),origin:V($,\"origin\"),uuid:V($,\"uuid\")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);\"undefined\"!==typeof module&&(module.exports=PUBNUB)&&ra();var Ia=ta(\"pubnubs\")||0;if(Z){ya(Z,{position:\"absolute\",top:-I});if(\"opera\"in window||V(Z,\"flash\"))Z.innerHTML=\"<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>\";PUBNUB.rdx=function(a,c){if(!c)return W[a].onerror();\nW[a].responseText=unescape(c);W[a].onload()};W.id=I}}\nvar Ma=PUBNUB.ws=function(a,c){if(!(this instanceof Ma))return new Ma(a,c);var b=this,a=b.url=a||\"\";b.protocol=c||\"Sec-WebSocket-Protocol\";var d=a.split(\"/\"),d={ssl:\"wss:\"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};b.CONNECTING=0;b.OPEN=1;b.CLOSING=2;b.CLOSED=3;b.CLOSE_NORMAL=1E3;b.CLOSE_GOING_AWAY=1001;b.CLOSE_PROTOCOL_ERROR=1002;b.CLOSE_UNSUPPORTED=1003;b.CLOSE_TOO_LARGE=1004;b.CLOSE_NO_STATUS=1005;b.CLOSE_ABNORMAL=1006;b.onclose=b.onerror=b.onmessage=b.onopen=b.onsend=\nx();b.binaryType=\"\";b.extensions=\"\";b.bufferedAmount=0;b.trasnmitting=u;b.buffer=[];b.readyState=b.CONNECTING;if(!a)return b.readyState=b.CLOSED,b.onclose({code:b.CLOSE_ABNORMAL,reason:\"Missing URL\",wasClean:j}),b;b.e=PUBNUB.init(d);b.e.i=d;b.i=d;b.e.subscribe({restore:u,channel:d.channel,disconnect:b.onerror,reconnect:b.onopen,error:function(){b.onclose({code:b.CLOSE_ABNORMAL,reason:\"Missing URL\",wasClean:u})},callback:function(a){b.onmessage({data:a})},connect:function(){b.readyState=b.OPEN;b.onopen()}})};\nMa.prototype.send=function(a){var c=this;c.e.publish({channel:c.e.i.channel,message:a,callback:function(a){c.onsend({data:a})}})};\n})();\n"]}