
function MessagePacker(e){function t(e,t,r){e.stored=!0;var a={message:e,id:r,timeout:setTimeout(function(){clearTimeout(a.timeout),delete n[t]},BASE_TIMEOUT)};n[t]=a}var r=this,a=0,s={},n={};this.pack=function(t,r){var s=new Array(6),n=t.type;switch(n){case"presence":s[0]=PRESENCE;break;case"offer":s[0]=OFFER;break;case"answer":s[0]=ANSWER;break;default:var c=Error("Unknown message type '"+n+"'");throw c.message=t,c}return s[1]=t.from||e,s.type!=PRESENCE&&(s[2]=t.dest,s[3]=r||a++,s[4]=Math.min(t.ttl||MAX_TTL_DEFAULT,MAX_TTL_DEFAULT),s[5]=t.sdp),s},this.unpack=function(e){var a={},c=e[1],i=e[3],o=e[0];switch(o){case PRESENCE:a.type="presence";break;case OFFER:a.type="offer";break;case ANSWER:a.type="answer";break;default:var u=Error("Unknown message type '"+o+"'");throw u.message=e,u}if(a.from=c,o!=PRESENCE&&(a.dest=e[2],a.ttl=e[4],a.sdp=e[5],a.pack=function(){return r.pack(this,i)}),"offer"==a.type){var f=n[c];if(f){if(f.id>i)return;if(clearTimeout(f.timeout),delete n[c],f.id==i){var e=f.message;return t(e,c,i),e}}else a.reply=function(e,a){var s=r.pack({type:"answer",dest:e,sdp:a},i);return t(s,e,i),s}}if("answer"==a.type){var E=s[c];if(E){var p=E[i];p&&p.callback(u,a)}}return a},this.presence=function(){var e=this.pack({type:"presence"});return e},this.offer=function(e,t,r){function a(e,t){n.cancel(),r(e,t)}var n={type:"offer",dest:e,sdp:t};if(r||(n.ttl=1),n=this.pack(n),n.cancel=function(){},r){var c=s[e]=s[e]||{},i=n[3],o=c[i]={message:n,callback:a,timeout:setTimeout(function(){var e=new Error("Timed Out");e.request=n,a(e)},BASE_TIMEOUT)};n.cancel=function(){clearTimeout(o.timeout),delete c[i],Object.keys(c).length||delete s[e]}}return n}}const ERROR=0,PRESENCE=1,OFFER=2,ANSWER=3,MAX_TTL_DEFAULT=5,BASE_TIMEOUT=5e3;module.exports=MessagePacker;
},{}],2:[function(require,module,exports){
function WebP2P(e){function n(e){c.emit("error",new Error(e))}function o(e,n,o){var t=new RTCPeerConnection({iceServers:[{url:"stun:"+d}]},{optional:[{DtlsSrtpKeyAgreement:!0}]});return t.addEventListener("icecandidate",function(e){if(!e.candidate){var t=this.localDescription.type,s=this.localDescription.sdp;t==n?o(s):console.error(t+" SDP type is not equal to "+n+" callback type")}}),t.addEventListener("signalingstatechange",function(){if("stable"==t.signalingState){var n=t._channels||[];p.add(e,t,n);var o=v[e];if(o){delete v[e];var s=o.callback;s&&s(null,t,n)}c.emit("peerconnection",t,n)}}),Object.defineProperty(t,"sessionID",{value:e}),t}function t(e,o){o=[c.routingLabel].concat(a,o);for(var t,s=[],r=0;t=o[r];r++){var i=e.createDataChannel(t);s.push(i),i.addEventListener("close",function(){s.splice(s.indexOf(i),1)})}e._channels=s;var f={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};e.createOffer(function(o){e.setLocalDescription(o,function(){console.log("["+c.sessionID+"] Offer LocalDescription created and set")},n)},n,f)}function s(e,o){e.setRemoteDescription(new RTCSessionDescription({sdp:o,type:"offer"}),function(){e.createAnswer(function(o){e.setLocalDescription(o,function(){console.log("["+c.sessionID+"] Answer LocalDescription created and set")},n)},n)},n)}function r(e,n){if(--e.ttl<=0)return console.warn("TTL achieved:",e);var o=e.dest;e=e.pack();for(var t,s=0;t=p._connectors[s];s++)if(t.sessionID==o)return t.send(e);p.send(e,n),l.send(e,n)}function i(e){function t(e){var n=p.get(e);if(n)return console.log("["+c.sessionID+"] Already connected to "+e),!0;var o=v[e];if(o){if(console.log("["+c.sessionID+"] Already offered connection to "+e),c.sessionID<e)return!0;o.message.cancel(),o.peerConnection.close(),delete v[e]}return!1}e.on("connected",function(){l.status!=p.status&&c.emit("connected")}),e.on("disconnected",function(){l.status==p.status&&c.emit("disconnected")}),e.on("error",function(e){c.emit("error",e)}),e.on("offer",function(e,n){var i=e.from,a=e.dest;if(i!=c.sessionID)if(a==c.sessionID){if(console.log("["+c.sessionID+"] Received connection request from "+i),t(i))return;var f=e,d=o(i,"answer",function(e){var o=f.reply(i,e);n.send(o)});s(d,e.sdp)}else r(e,n)}),e.on("answer",function(e,o){var t=e.from,s=e.dest;if(t!=c.sessionID)if(s==c.sessionID){console.log("["+c.sessionID+"] Received connection response from "+t);var i=v[t];i?i.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:e.sdp,type:"answer"}),function(){console.log("Successfuly generated RemoteDescription for "+t)},n):console.warn("["+c.sessionID+"] Connection with peer '"+t+"' was not previously requested")}else r(e,o)})}var c=this,e=e||{},a=e.commonLabels||[],f=e.handshake_servers,d=e.stun_server||"stun.l.google.com:19302";Object.defineProperty(this,"routingLabel",{value:e.routingLabel||"webp2p"}),Object.defineProperty(this,"sessionID",{value:e.sessionID||uuid.v4()});var u=new MessagePacker(this.sessionID),l=new HandshakeManager(u,f),p=new PeersManager(u,c.routingLabel);this.__defineGetter__("status",function(){return"connected"==p.status?"connected":l.status}),this.__defineGetter__("peers",function(){return p.peers});var v={};this.connectTo=function(e,n,s){if(n instanceof Function){if(s)throw new SyntaxError("Nothing can be defined after the callback");s=n,n=void 0}if(e==c.sessionID)return s(new Error("Connecting to ourself"));var r=p.get(e);r?s(null,r):(r=o(e,"offer",function(n){var o=u.offer(e,n,function(e,n){return e?s(e):(console.debug("["+c.sessionID+"] Received offer for connectTo from "+n.from),void 0)});v[e]={callback:s,message:o,peerConnection:r},l.send(o),p.send(o)}),t(r,n))},l.on("connected",function(){c.emit("handshakeManager.connected",l)}),l.on("disconnected",function(){c.emit("handshakeManager.disconnected",l)}),p.on("connected",function(){c.emit("peersManager.connected",p)}),p.on("disconnected",function(){c.emit("peersManager.disconnected",p)}),i(l),i(p),l.on("presence",function(e,n){if(e!=c.sessionID){var s=p.get(e);if(!s){var r=o(e,"offer",function(o){var t=u.offer(e,o);v[e]={message:t,peerConnection:r},n.send(t)});r.addEventListener("signalingstatechange",function(){"stable"==r.signalingState&&n.increaseConnections()}),t(r)}}}),this.close=function(){l.close(),p.close()},window&&window.addEventListener("beforeunload",function(){c.close()})}var EventEmitter=require("events").EventEmitter,RTCPeerConnection=require("wrtc").RTCPeerConnection,uuid=require("uuid"),HandshakeManager=require("./managers/HandshakeManager"),PeersManager=require("./managers/PeersManager"),MessagePacker=require("./MessagePacker");WebP2P.prototype.__proto__=EventEmitter.prototype,WebP2P.prototype.constructor=WebP2P,module.exports=WebP2P;
},{"./MessagePacker":1,"./managers/HandshakeManager":9,"./managers/PeersManager":11,"events":12,"uuid":15,"wrtc":16}],3:[function(require,module,exports){
function Connector_PubNub(e,n,o){HandshakeConnector.call(this,o);var r=this,t=n.channel,c=PUBNUB.init(e);c.subscribe({channel:t,restore:!1,backfill:!1,connect:r._open,message:r._message,disconnect:r._close,error:function(e){r._error(new Error(e?e.error:"Undefined error"))}}),this.close=function(){c.unsubscribe({channel:t}),r._close()},this.send=function(e){c.publish({channel:t,message:e})}}var HandshakeConnector=require("./core/HandshakeConnector"),PUBNUB=require("pubnub");Connector_PubNub.prototype.__proto__=HandshakeConnector.prototype,Connector_PubNub.prototype.constructor=Connector_PubNub,Connector_PubNub.prototype.max_connections=50,Object.defineProperty(Connector_PubNub.prototype,"max_chars",{value:1800}),module.exports=Connector_PubNub;
},{"./core/HandshakeConnector":6,"pubnub":17}],4:[function(require,module,exports){
function Connector(){EventEmitter.call(this);var e=this;this._open=function(){e.emit("open")},this._message=function(o){e.emit("message",o)},this._close=function(){e.emit("close")},this._error=function(o){e.emit("error",o)}}var EventEmitter=require("events").EventEmitter;Connector.prototype.__proto__=EventEmitter.prototype,Connector.prototype.constructor=Connector,Connector.prototype.close=function(){throw new TypeError("Connector.close should be defined in a child class")},Connector.prototype.send=function(){throw new TypeError("Connector.send should be defined in a child class")},module.exports=Connector;
},{"events":12}],5:[function(require,module,exports){
function Connector_DataChannel(n){Connector.call(this);var e=this;n.addEventListener("open",e._open),n.addEventListener("message",function(n){e._message(JSON.parse(n.data))}),n.addEventListener("close",e._close),n.addEventListener("error",e._error),this.close=function(){n.close()},this.send=function(e){n.send(JSON.stringify(e))}}var Connector=require("./Connector");Connector_DataChannel.prototype.__proto__=Connector.prototype,Connector_DataChannel.prototype.constructor=Connector_DataChannel,module.exports=Connector_DataChannel;
},{"./Connector":4}],6:[function(require,module,exports){
function HandshakeConnector(n){Connector.call(this);var o=this;void 0!=n&&(this.max_connections=Math.min(n,this.max_connections)),this.shouldConnect=function(){return!0};var t=0;this.increaseConnections=function(){t++,t>=o.max_connections&&o.close()}}var Connector=require("./Connector");HandshakeConnector.prototype.__proto__=Connector.prototype,HandshakeConnector.prototype.constructor=HandshakeConnector,HandshakeConnector.prototype.max_connections=Number.POSITIVE_INFINITY,module.exports=HandshakeConnector;
},{"./Connector":4}],7:[function(require,module,exports){
const ERROR_NETWORK_UNKNOWN={id:0,msg:"Unable to fetch handshake servers configuration"},ERROR_NETWORK_OFFLINE={id:1,msg:"There's no available network"},ERROR_REQUEST_FAILURE={id:2,msg:"Unable to fetch handshake servers configuration"},ERROR_REQUEST_EMPTY={id:3,msg:"Handshake servers configuration is empty"},ERROR_NO_PEERS={id:4,msg:"Not connected to any peer"};exports.ERROR_NETWORK_UNKNOWN=ERROR_NETWORK_UNKNOWN,exports.ERROR_NETWORK_OFFLINE=ERROR_NETWORK_OFFLINE,exports.ERROR_REQUEST_FAILURE=ERROR_REQUEST_FAILURE,exports.ERROR_REQUEST_EMPTY=ERROR_REQUEST_EMPTY,exports.ERROR_NO_PEERS=ERROR_NO_PEERS;
},{}],8:[function(require,module,exports){
var HandshakeConnector=require("./connectors/core/HandshakeConnector"),WebP2P=require("./WebP2P");module.exports=WebP2P,module.exports.HandshakeConnector=HandshakeConnector;
},{"./WebP2P":2,"./connectors/core/HandshakeConnector":6}],9:[function(require,module,exports){
function HandshakeManager(n,r){function e(r){var e=r.type,o=r.config_init,a=r.config_mess,i=r.max_connections,c=s[e];if(!c)throw Error("Invalid handshake server type '"+e+"'");var d=new c(o,a,i);t._initConnector(d),d.on("open",function(){d.send(n.presence())});var u=d._messageUnpacked;return d._messageUnpacked=function(n){"presence"==n.type?d.shouldConnect()&&t.emit("presence",n.from,d):u.call(d,n)},d}function o(){if(!a.length)throw Error("No handshake servers defined");for(;i<a.length;i++){var n=e(a[i]);return n.on("close",function(){i++,o()}),void 0}i=0}Manager.call(this,n);var t=this,s={};this.registerConnectorConstructor=function(n,r){s[n]=r},this.registerConnectorConstructor("PubNub",Connector_PubNub);var a=[],i=0,c=[];this.addConfigs_byObject=function(n){var r=s[n.type];return r?(r.prototype.max_connections!=Number.POSITIVE_INFINITY||n.max_connections?(a.push(n),"disconnected"==t.status&&(void 0==i&&(i=0),o())):(c.push(n),e(n)),void 0):(console.error("Invalid handshake server config: ",n),void 0)},this.addConfigs_byArray=function(n){for(var r,e=0;r=n[e];e++)t.addConfigs_byObject(r)},this.addConfigs_byUri=function(n){function r(n){t.emit("error",n)}var e=new XMLHttpRequest;e.open("GET",n),e.onload=function(){if(200==this.status){var n=JSON.parse(e.response);n.length?this.addConfigs_byArray(n):r(errors.ERROR_REQUEST_EMPTY)}else r(errors.ERROR_REQUEST_FAILURE)},e.onerror=function(){r(navigator.onLine?errors.ERROR_NETWORK_UNKNOWN:errors.ERROR_NETWORK_OFFLINE)},e.send()},this.addConfigs=function(n){"string"==typeof n?this.addConfigs_byUri(n):n instanceof Array?this.addConfigs_byArray(n):this.addConfigs_byObject(n)},r&&this.addConfigs(r)}var Manager=require("./Manager"),errors=require("../errors"),Connector_PubNub=require("../connectors/PubNub");HandshakeManager.prototype.__proto__=Manager.prototype,HandshakeManager.prototype.constructor=HandshakeManager,module.exports=HandshakeManager;
},{"../connectors/PubNub":3,"../errors":7,"./Manager":10}],10:[function(require,module,exports){
function Manager(e){EventEmitter.call(this);var n=this;this._connectors=[],this.__defineGetter__("status",function(){return this._connectors.length?"connected":"disconnected"}),this._initConnector=function(t){t.on("open",function(){n._connectors.push(t),1==n._connectors.length&&n.emit("connected")}),t.on("close",function(){n._connectors.splice(n._connectors.indexOf(t),1),0==n._connectors.length&&n.emit("disconnected")}),t.on("error",function(e){t.close(),n.emit("error",e)}),t._messageUnpacked=function(e){switch(e.type){case"offer":case"answer":n.emit(e.type,e,t);break;default:console.error("Unknown message type '"+type+"'"),console.error(e)}},t.on("message",function(n){n=e.unpack(n),n&&(n.stored?t.send(n):t._messageUnpacked(n))})},this.send=function(e,n){for(var t,o=0;t=this._connectors[o];o++)t!==n&&t.send(e)},this.close=function(){for(var e,n=0;e=this._connectors[n];n++)e.close()}}var EventEmitter=require("events").EventEmitter;Manager.prototype.__proto__=EventEmitter.prototype,Manager.prototype.constructor=Manager,module.exports=Manager;
},{"events":12}],11:[function(require,module,exports){
function PeersManager(e,n){function t(e){var n=new Connector_DataChannel(e);return a._initConnector(n),n}function r(e,r){if(e.label==n){var a=t(e);return a.sessionID=r,a}}Manager.call(this,e);var a=this,o={};this.__defineGetter__("peers",function(){return o}),this.add=function(e,n,t){function a(n){var t=n.channel,o=r(t,e);o&&n.target.removeEventListener("datachannel",a)}if(n.addEventListener("signalingstatechange",function(){"closed"==n.signalingState&&delete o[e]}),t.length)for(var i,s=0;(i=t[s])&&!r(i,e);s++);else n.addEventListener("datachannel",a);o[e]=n},this.get=function(e){return o[e]}}var Manager=require("./Manager"),Connector_DataChannel=require("../connectors/core/DataChannel");PeersManager.prototype.__proto__=Manager.prototype,PeersManager.prototype.constructor=PeersManager,module.exports=PeersManager;
},{"../connectors/core/DataChannel":5,"./Manager":10}],12:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};
},{}],13:[function(require,module,exports){
require=function t(e,n,r){function i(a,f){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!f&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=n[a]={exports:{}};e[a][0].call(s.exports,function(t){var n=e[a][1][t];return i(n?n:t)},s,s.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({PcZj9L:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i=typeof t;if("base64"===e&&"string"===i)for(t=S(t);0!==t.length%4;)t+="=";var o;if("number"===i)o=M(t);else if("string"===i)o=r.byteLength(t,e);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=M(t.length)}var a;Y?a=_(new Uint8Array(o)):(a=this,a.length=o);var f;if(r.isBuffer(t))a.set(t);else if(N(t))for(f=0;o>f;f++)a[f]=r.isBuffer(t)?t.readUInt8(f):t[f];else if("string"===i)a.write(t,0,e);else if("number"===i&&!Y&&!n)for(f=0;o>f;f++)a[f]=0;return a}function i(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var a=e.length;if(0!==a%2)throw new Error("Invalid hex string");i>a/2&&(i=a/2);for(var f=0;i>f;f++){var u=parseInt(e.substr(2*f,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[n+f]=u}return r._charsWritten=2*f,f}function o(t,e,n,i){return r._charsWritten=q(x(e),t,n,i)}function a(t,e,n,i){return r._charsWritten=q(T(e),t,n,i)}function f(t,e,n,r){return a(t,e,n,r)}function u(t,e,n,i){return r._charsWritten=q(V(e),t,n,i)}function s(t,e,n){return 0===e&&n===t.length?R.fromByteArray(t):R.fromByteArray(t.slice(e,n))}function l(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=k(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+k(i)}function h(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function c(t,e,n){return h(t,e,n)}function g(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=C(t[o]);return i}function d(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(i>e+1)return t._dataview.getUint16(e,n);var o=new DataView(new ArrayBuffer(2));return o.setUint8(0,t[i-1]),o.getUint16(0,n)}var a;return n?(a=t[e],i>e+1&&(a|=t[e+1]<<8)):(a=t[e]<<8,i>e+1&&(a|=t[e+1])),a}}function w(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(i>e+3)return t._dataview.getUint32(e,n);for(var o=new DataView(new ArrayBuffer(4)),a=0;i>a+e;a++)o.setUint8(a,t[a+e]);return o.getUint32(0,n)}var f;return n?(i>e+2&&(f=t[e+2]<<16),i>e+1&&(f|=t[e+1]<<8),f|=t[e],i>e+3&&(f+=t[e+3]<<24>>>0)):(i>e+1&&(f=t[e+1]<<16),i>e+2&&(f|=t[e+2]<<8),i>e+3&&(f|=t[e+3]),f+=t[e]<<24>>>0),f}}function v(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(e+1===i){var o=new DataView(new ArrayBuffer(2));return o.setUint8(0,t[i-1]),o.getInt16(0,n)}return t._dataview.getInt16(e,n)}var a=d(t,e,n,!0),f=32768&a;return f?-1*(65535-a+1):a}}function p(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(e+3>=i){for(var o=new DataView(new ArrayBuffer(4)),a=0;i>a+e;a++)o.setUint8(a,t[a+e]);return o.getInt32(0,n)}return t._dataview.getInt32(e,n)}var f=w(t,e,n,!0),u=2147483648&f;return u?-1*(4294967295-f+1):f}}function y(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+3<t.length,"Trying to read beyond buffer length")),Y?t._dataview.getFloat32(e,n):X.read(t,e,n,23,4)}function b(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+7<t.length,"Trying to read beyond buffer length")),Y?t._dataview.getFloat64(e,n):X.read(t,e,n,52,8)}function m(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"trying to write beyond buffer length"),O(e,65535));var o=t.length;if(!(n>=o))if(Y)if(n+1===o){var a=new DataView(new ArrayBuffer(2));a.setUint16(0,e,r),t[n]=a.getUint8(0)}else t._dataview.setUint16(n,e,r);else for(var f=0,u=Math.min(o-n,2);u>f;f++)t[n+f]=(e&255<<8*(r?f:1-f))>>>8*(r?f:1-f)}function E(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"trying to write beyond buffer length"),O(e,4294967295));var o=t.length;if(!(n>=o)){var a;if(Y)if(n+3>=o){var f=new DataView(new ArrayBuffer(4));for(f.setUint32(0,e,r),a=0;o>a+n;a++)t[a+n]=f.getUint8(a)}else t._dataview.setUint32(n,e,r);else for(a=0,j=Math.min(o-n,4);j>a;a++)t[n+a]=255&e>>>8*(r?a:3-a)}}function I(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"Trying to write beyond buffer length"),P(e,32767,-32768));var o=t.length;if(!(n>=o))if(Y)if(n+1===o){var a=new DataView(new ArrayBuffer(2));a.setInt16(0,e,r),t[n]=a.getUint8(0)}else t._dataview.setInt16(n,e,r);else e>=0?m(t,e,n,r,i):m(t,65535+e+1,n,r,i)}function B(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),P(e,2147483647,-2147483648));var o=t.length;if(!(n>=o))if(Y)if(n+3>=o){var a=new DataView(new ArrayBuffer(4));a.setInt32(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setInt32(n,e,r);else e>=0?E(t,e,n,r,i):E(t,4294967295+e+1,n,r,i)}function U(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),W(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;if(!(n>=o))if(Y)if(n+3>=o){var a=new DataView(new ArrayBuffer(4));a.setFloat32(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setFloat32(n,e,r);else X.write(t,e,n,r,23,4)}function A(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+7<t.length,"Trying to write beyond buffer length"),W(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;if(!(n>=o))if(Y)if(n+7>=o){var a=new DataView(new ArrayBuffer(8));a.setFloat64(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setFloat64(n,e,r);else X.write(t,e,n,r,52,8)}function L(){return new r(this).buffer}function S(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function _(t){return t._isBuffer=!0,t.write=Z.write,t.toString=Z.toString,t.toLocaleString=Z.toString,t.toJSON=Z.toJSON,t.copy=Z.copy,t.slice=Z.slice,t.readUInt8=Z.readUInt8,t.readUInt16LE=Z.readUInt16LE,t.readUInt16BE=Z.readUInt16BE,t.readUInt32LE=Z.readUInt32LE,t.readUInt32BE=Z.readUInt32BE,t.readInt8=Z.readInt8,t.readInt16LE=Z.readInt16LE,t.readInt16BE=Z.readInt16BE,t.readInt32LE=Z.readInt32LE,t.readInt32BE=Z.readInt32BE,t.readFloatLE=Z.readFloatLE,t.readFloatBE=Z.readFloatBE,t.readDoubleLE=Z.readDoubleLE,t.readDoubleBE=Z.readDoubleBE,t.writeUInt8=Z.writeUInt8,t.writeUInt16LE=Z.writeUInt16LE,t.writeUInt16BE=Z.writeUInt16BE,t.writeUInt32LE=Z.writeUInt32LE,t.writeUInt32BE=Z.writeUInt32BE,t.writeInt8=Z.writeInt8,t.writeInt16LE=Z.writeInt16LE,t.writeInt16BE=Z.writeInt16BE,t.writeInt32LE=Z.writeInt32LE,t.writeInt32BE=Z.writeInt32BE,t.writeFloatLE=Z.writeFloatLE,t.writeFloatBE=Z.writeFloatBE,t.writeDoubleLE=Z.writeDoubleLE,t.writeDoubleBE=Z.writeDoubleBE,t.fill=Z.fill,t.inspect=Z.inspect,t.toArrayBuffer=L,0!==t.byteLength&&(t._dataview=new DataView(t.buffer,t.byteOffset,t.byteLength)),t}function D(t,e,n){return"number"!=typeof t?n:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function M(t){return t=~~Math.ceil(+t),0>t?0:t}function F(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function N(t){return F(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function C(t){return 16>t?"0"+t.toString(16):t.toString(16)}function x(t){for(var e=[],n=0;n<t.length;n++)if(t.charCodeAt(n)<=127)e.push(t.charCodeAt(n));else for(var r=encodeURIComponent(t.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)e.push(parseInt(r[i],16));return e}function T(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function V(t){return R.toByteArray(t)}function q(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function k(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function O(t,e){J("number"==typeof t,"cannot write a non-number as a number"),J(t>=0,"specified a negative value for writing an unsigned value"),J(e>=t,"value is larger than maximum value for type"),J(Math.floor(t)===t,"value has a fractional component")}function P(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value"),J(Math.floor(t)===t,"value has a fractional component")}function W(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value")}function J(t,e){if(!t)throw new Error(e||"Failed assertion")}var R=t("base64-js"),X=t("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var Y=function(){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer||"undefined"==typeof DataView)return!1;try{var t=new Uint8Array(0);return t.foo=function(){return 42},42===t.foo()}catch(e){return!1}}();r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":return!0;default:return!1}},r.isBuffer=function(t){return t&&t._isBuffer},r.byteLength=function(t,e){switch(e||"utf8"){case"hex":return t.length/2;case"utf8":case"utf-8":return x(t).length;case"ascii":case"binary":return t.length;case"base64":return V(t).length;default:throw new Error("Unknown encoding")}},r.concat=function(t,e){if(!F(t))throw new Error("Usage: Buffer.concat(list, [totalLength])\nlist should be an Array.");if(0===t.length)return new r(0);if(1===t.length)return t[0];var n;if("number"!=typeof e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var a=t[n];a.copy(i,o),o+=a.length}return i},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var s=r;r=e,e=n,n=s}e=Number(e)||0;var l=this.length-e;switch(n?(n=Number(n),n>l&&(n=l)):n=l,r=String(r||"utf8").toLowerCase()){case"hex":return i(this,t,e,n);case"utf8":case"utf-8":return o(this,t,e,n);case"ascii":return a(this,t,e,n);case"binary":return f(this,t,e,n);case"base64":return u(this,t,e,n);default:throw new Error("Unknown encoding")}},r.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0!==n?Number(n):n=r.length,n===e)return"";switch(t){case"hex":return g(r,e,n);case"utf8":case"utf-8":return l(r,e,n);case"ascii":return h(r,e,n);case"binary":return c(r,e,n);case"base64":return s(r,e,n);default:throw new Error("Unknown encoding")}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(t,e,n,r){var i=this;if(n||(n=0),r||0===r||(r=this.length),e||(e=0),r!==n&&0!==t.length&&0!==i.length){if(n>r)throw new Error("sourceEnd < sourceStart");if(0>e||e>=t.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);for(var o=0;r-n>o;o++)t[o+e]=this[o+n]}},r.prototype.slice=function(t,e){var n=this.length;if(t=D(t,n,0),e=D(e,n,n),Y)return _(this.subarray(t,e));for(var i=e-t,o=new r(i,void 0,!0),a=0;i>a;a++)o[a]=this[a+t];return o},r.prototype.readUInt8=function(t,e){var n=this;return e||(J(void 0!==t&&null!==t,"missing offset"),J(t<n.length,"Trying to read beyond buffer length")),t>=n.length?void 0:n[t]},r.prototype.readUInt16LE=function(t,e){return d(this,t,!0,e)},r.prototype.readUInt16BE=function(t,e){return d(this,t,!1,e)},r.prototype.readUInt32LE=function(t,e){return w(this,t,!0,e)},r.prototype.readUInt32BE=function(t,e){return w(this,t,!1,e)},r.prototype.readInt8=function(t,e){var n=this;if(e||(J(void 0!==t&&null!==t,"missing offset"),J(t<n.length,"Trying to read beyond buffer length")),!(t>=n.length)){if(Y)return n._dataview.getInt8(t);var r=128&n[t];return r?-1*(255-n[t]+1):n[t]}},r.prototype.readInt16LE=function(t,e){return v(this,t,!0,e)},r.prototype.readInt16BE=function(t,e){return v(this,t,!1,e)},r.prototype.readInt32LE=function(t,e){return p(this,t,!0,e)},r.prototype.readInt32BE=function(t,e){return p(this,t,!1,e)},r.prototype.readFloatLE=function(t,e){return y(this,t,!0,e)},r.prototype.readFloatBE=function(t,e){return y(this,t,!1,e)},r.prototype.readDoubleLE=function(t,e){return b(this,t,!0,e)},r.prototype.readDoubleBE=function(t,e){return b(this,t,!1,e)},r.prototype.writeUInt8=function(t,e,n){var r=this;n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<r.length,"trying to write beyond buffer length"),O(t,255)),e>=r.length||(r[e]=t)},r.prototype.writeUInt16LE=function(t,e,n){m(this,t,e,!0,n)},r.prototype.writeUInt16BE=function(t,e,n){m(this,t,e,!1,n)},r.prototype.writeUInt32LE=function(t,e,n){E(this,t,e,!0,n)},r.prototype.writeUInt32BE=function(t,e,n){E(this,t,e,!1,n)},r.prototype.writeInt8=function(t,e,n){var r=this;n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<r.length,"Trying to write beyond buffer length"),P(t,127,-128)),e>=r.length||(Y?r._dataview.setInt8(e,t):t>=0?r.writeUInt8(t,e,n):r.writeUInt8(255+t+1,e,n))},r.prototype.writeInt16LE=function(t,e,n){I(this,t,e,!0,n)},r.prototype.writeInt16BE=function(t,e,n){I(this,t,e,!1,n)},r.prototype.writeInt32LE=function(t,e,n){B(this,t,e,!0,n)},r.prototype.writeInt32BE=function(t,e,n){B(this,t,e,!1,n)},r.prototype.writeFloatLE=function(t,e,n){U(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){U(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){A(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){A(this,t,e,!1,n)},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),"number"!=typeof t||isNaN(t))throw new Error("value is not a number");if(e>n)throw new Error("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");for(var r=e;n>r;r++)this[r]=t}},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=C(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"};var Z=r.prototype},{"base64-js":3,ieee754:4}],"native-buffer-browserify":[function(t,e){e.exports=t("PcZj9L")},{}],3:[function(t,e){function n(t,e){var n=t.length,r=Number(arguments[1])||0;for(r=0>r?Math.ceil(r):Math.floor(r),0>r&&(r+=n);n>r;r++)if("string"==typeof t&&t.charAt(r)===e||"string"!=typeof t&&t[r]===e)return r;return-1}!function(){"use strict";function t(t){var e,r,o,a,f,u;if(t.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(f=n(t,"="),f=f>0?t.length-f:0,u=[],o=f>0?t.length-4:t.length,e=0,r=0;o>e;e+=4,r+=3)a=n(i,t.charAt(e))<<18|n(i,t.charAt(e+1))<<12|n(i,t.charAt(e+2))<<6|n(i,t.charAt(e+3)),u.push((16711680&a)>>16),u.push((65280&a)>>8),u.push(255&a);return 2===f?(a=n(i,t.charAt(e))<<2|n(i,t.charAt(e+1))>>4,u.push(255&a)):1===f&&(a=n(i,t.charAt(e))<<10|n(i,t.charAt(e+1))<<4|n(i,t.charAt(e+2))>>2,u.push(255&a>>8),u.push(255&a)),u}function r(t){function e(t){return i.charAt(63&t>>18)+i.charAt(63&t>>12)+i.charAt(63&t>>6)+i.charAt(63&t)}var n,r,o,a=t.length%3,f="";for(n=0,o=t.length-a;o>n;n+=3)r=(t[n]<<16)+(t[n+1]<<8)+t[n+2],f+=e(r);switch(a){case 1:r=t[t.length-1],f+=i.charAt(r>>2),f+=i.charAt(63&r<<4),f+="==";break;case 2:r=(t[t.length-2]<<8)+t[t.length-1],f+=i.charAt(r>>10),f+=i.charAt(63&r>>4),f+=i.charAt(63&r<<2),f+="="}return f}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.exports.toByteArray=t,e.exports.fromByteArray=r}()},{}],4:[function(t,e,n){n.read=function(t,e,n,r,i){var o,a,f=8*i-r-1,u=(1<<f)-1,s=u>>1,l=-7,h=n?i-1:0,c=n?-1:1,g=t[e+h];for(h+=c,o=g&(1<<-l)-1,g>>=-l,l+=f;l>0;o=256*o+t[e+h],h+=c,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=c,l-=8);if(0===o)o=1-s;else{if(o===u)return a?0/0:1/0*(g?-1:1);a+=Math.pow(2,r),o-=s}return(g?-1:1)*a*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var a,f,u,s=8*o-i-1,l=(1<<s)-1,h=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:o-1,d=r?1:-1,w=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(f=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+h>=1?c/u:c*Math.pow(2,1-h),e*u>=2&&(a++,u/=2),a+h>=l?(f=0,a=l):a+h>=1?(f=(e*u-1)*Math.pow(2,i),a+=h):(f=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+g]=255&f,g+=d,f/=256,i-=8);for(a=a<<i|f,s+=i;s>0;t[n+g]=255&a,g+=d,a/=256,s-=8);t[n+g-d]|=128*w}},{}]},{},[]),module.exports=require("native-buffer-browserify").Buffer;
},{}],14:[function(require,module,exports){
var global="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var n,r=0;16>r;r++)0===(3&r)&&(n=4294967296*Math.random()),_rnds[r]=255&n>>>((3&r)<<3);return _rnds}}module.exports=rng;
},{}],15:[function(require,module,exports){
function parse(e,s,r){var t=s&&r||0,u=0;for(s=s||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>u&&(s[t+u++]=_hexToByte[e])});16>u;)s[t+u++]=0;return s}function unparse(e,s){var r=s||0,t=_byteToHex;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]}function v1(e,s,r){var t=s&&r||0,u=s||[];e=e||{};var n=void 0!==e.clockseq?e.clockseq:_clockseq,o=void 0!==e.msecs?e.msecs:(new Date).getTime(),a=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,i=o-_lastMSecs+(a-_lastNSecs)/1e4;if(0>i&&void 0===e.clockseq&&(n=16383&n+1),(0>i||o>_lastMSecs)&&void 0===e.nsecs&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=o,_lastNSecs=a,_clockseq=n,o+=122192928e5;var _=(1e4*(268435455&o)+a)%4294967296;u[t++]=255&_>>>24,u[t++]=255&_>>>16,u[t++]=255&_>>>8,u[t++]=255&_;var c=268435455&1e4*(o/4294967296);u[t++]=255&c>>>8,u[t++]=255&c,u[t++]=16|15&c>>>24,u[t++]=255&c>>>16,u[t++]=128|n>>>8,u[t++]=255&n;for(var f=e.node||_nodeId,d=0;6>d;d++)u[t+d]=f[d];return s?s:unparse(u)}function v4(e,s,r){var t=s&&r||0;"string"==typeof e&&(s="binary"==e?new BufferClass(16):null,e=null),e=e||{};var u=e.random||(e.rng||_rng)();if(u[6]=64|15&u[6],u[8]=128|63&u[8],s)for(var n=0;16>n;n++)s[t+n]=u[n];return s||unparse(u)}for(var Buffer=require("__browserify_Buffer"),_rng=require("./rng"),BufferClass="function"==typeof Buffer?Buffer:Array,_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,uuid.BufferClass=BufferClass,module.exports=uuid;
},{"./rng":14,"__browserify_Buffer":13}],16:[function(require,module,exports){
var RTCIceCandidate=window.mozRTCIceCandidate||window.webkitRTCIceCandidate||window.RTCIceCandidate,RTCPeerConnection=window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection,RTCSessionDescription=window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.RTCSessionDescription;exports.RTCIceCandidate=RTCIceCandidate,exports.RTCPeerConnection=RTCPeerConnection,exports.RTCSessionDescription=RTCSessionDescription;
},{}],17:[function(require,module,exports){
!function(){function x(){return function(){}}function ga(){return"x"+ ++aa+ +new Date}function J(){return+new Date}function ka(n,e){var o=n.join(ca),r=[];return e?(Q(e,function(n,e){"undefined"!=typeof e&&e!=t&&0<encodeURIComponent(e).length&&r.push(n+"="+encodeURIComponent(e))}),o+="?"+r.join(da)):o}function la(n,e){function t(){r+e>J()?(clearTimeout(o),o=setTimeout(t,e)):(r=J(),n())}var o,r=0;return t}function na(n,e){var t=[];return Q(n||[],function(n){e(n)&&t.push(n)}),t}function oa(n,e){return n.replace(fa,function(n,t){return e[t]||n})}function ja(n){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=0|16*Math.random();return("x"==n?e:8|3&e).toString(16)});return n&&n(e),e}function Q(n,e){if(n&&e)if("undefined"!=typeof n[0])for(var t=0,o=n.length;o>t;)e.call(n[t],n[t],t++);else for(t in n)n.hasOwnProperty&&n.hasOwnProperty(t)&&e.call(n[t],t,n[t])}function pa(n,e){var t=[];return Q(n||[],function(n,o){t.push(e(n,o))}),t}function qa(n){var e=[];return Q(n,function(n,t){t.j&&e.push(n)}),e.sort()}function ra(){setTimeout(function(){C||(C=1,Q(ba,function(n){n()}))},I)}var j=!0,t=null,u=!1;window.JSON&&window.JSON.stringify||function(){function a(){try{return this.valueOf()}catch(n){return t}}function c(n){return d.lastIndex=0,d.test(n)?'"'+n.replace(d,function(n){var e=H[n];return"string"==typeof e?e:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function b(n,t){var o,r,i,u,f,l=e,d=t[n];switch(d&&"object"==typeof d&&(d=a.call(d)),"function"==typeof m&&(d=m.call(t,n,d)),typeof d){case"string":return c(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(e+=s,f=[],"[object Array]"===Object.prototype.toString.apply(d)){for(u=d.length,o=0;u>o;o+=1)f[o]=b(o,d)||"null";return i=0===f.length?"[]":e?"[\n"+e+f.join(",\n"+e)+"\n"+l+"]":"["+f.join(",")+"]",e=l,i}if(m&&"object"==typeof m)for(u=m.length,o=0;u>o;o+=1)r=m[o],"string"==typeof r&&(i=b(r,d))&&f.push(c(r)+(e?": ":":")+i);else for(r in d)Object.hasOwnProperty.call(d,r)&&(i=b(r,d))&&f.push(c(r)+(e?": ":":")+i);return i=0===f.length?"{}":e?"{\n"+e+f.join(",\n"+e)+"\n"+l+"}":"{"+f.join(",")+"}",e=l,i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,s,H={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;"function"!=typeof JSON.stringify&&(JSON.stringify=function(n,t,o){var r;if(s=e="","number"==typeof o)for(r=0;o>r;r+=1)s+=" ";else"string"==typeof o&&(s=o);if((m=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return b("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();var aa=1,C=u,ba=[],G="-pnpres",I=1e3,ca="/",da="&",fa=/{([\w\-]+)}/g,P,ha=Math.floor(20*Math.random());if(P=function(n,e){return 0<n.indexOf("pubsub.")&&n.replace("pubsub","ps"+(e?ja().split("-")[0]:20>++ha?ha:ha=1))||n},!window.PUBNUB){var sa=function(n,e){return CryptoJS.HmacSHA256(n,e).toString(CryptoJS.enc.Base64)},ta=function(n){return document.getElementById(n)},ua=function(n){console.error(n)},va=function(n,e){var t=[];return Q(n.split(/\s+/),function(n){Q((e||document).getElementsByTagName(n),function(n){t.push(n)})}),t},U=function(n,e,t){Q(n.split(","),function(n){function o(n){n||(n=window.event),t(n)||(n.cancelBubble=j,n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation())}e.addEventListener?e.addEventListener(n,o,u):e.attachEvent?e.attachEvent("on"+n,o):e["on"+n]=o})},xa=function(){return va("head")[0]},V=function(n,e,t){return t?(n.setAttribute(e,t),void 0):n&&n.getAttribute&&n.getAttribute(e)},ya=function(n,e){for(var t in e)if(e.hasOwnProperty(t))try{n.style[t]=e[t]+(0<"|width|height|top|left|".indexOf(t)&&"number"==typeof e[t]?"px":"")}catch(o){}},Ba=function(n){return document.createElement(n)},Da=function(){return Ca||W()?0:ga()},Fa=function(n){function e(n,e){v||(v=1,g.onerror=t,clearTimeout(w),n||!e||C(e),setTimeout(function(){n&&k();var e=ta(y),t=e&&e.parentNode;t&&t.removeChild(e)},I))}if(Ca||W()){n:{var o,r,i=function(){if(!u){u=1,clearTimeout(s);try{r=JSON.parse(o.responseText)}catch(n){return b(1)}a=1,d(r)}},a=0,u=0,c=n.timeout||1e4,s=setTimeout(function(){b(1)},c),f=n.b||x(),l=n.data||{},d=n.c||x(),p="undefined"==typeof n.g,b=function(n,e){a||(a=1,clearTimeout(s),o&&(o.onerror=o.onload=t,o.abort&&o.abort(),o=t),n&&f(e))};try{o=W()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest,o.onerror=o.onabort=function(){b(1,o.responseText||{error:"Network Connection Error"})},o.onload=o.onloadend=i,o.onreadystatechange=function(){if(o&&4==o.readyState)switch(o.status){case 401:case 402:case 403:try{r=JSON.parse(o.responseText),b(1,r)}catch(n){return b(1,o.responseText)}}},p&&(o.timeout=c),l.pnsdk=Ea;var h=ka(n.url,l);o.open("GET",h,p),o.send()}catch(m){b(0),Ca=0,n=Fa(n);break n}n=b}return n}var g=Ba("script"),i=n.a,y=ga(),v=0,w=setTimeout(function(){e(1)},n.timeout||1e4),k=n.b||x(),c=n.data||{},C=n.c||x();return window[i]=function(n){e(0,n)},n.g||(g[Ga]=Ga),g.onerror=function(){e(1)},c.pnsdk=Ea,g.src=ka(n.url,c),V(g,"id",y),xa().appendChild(g),e},Ha=function(){return"onLine"in navigator?navigator.onLine:1},W=function(){if(!Ia||!Ia.get)return 0;var n={id:W.id++,send:x(),abort:function(){n.id={}},open:function(e,t){W[n.id]=n,Ia.get(n.id,t)}};return n},Ga="async",Ea="PubNub-JS-Web/3.5.48",Ca=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||x());var Ja,Ka=window.localStorage;Ja={get:function(n){try{return Ka?Ka.getItem(n):-1==document.cookie.indexOf(n)?t:((document.cookie||"").match(RegExp(n+"=([^;]+)"))||[])[1]||t}catch(e){}},set:function(n,e){try{if(Ka)return Ka.setItem(n,e)&&0;document.cookie=n+"="+e+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(t){}}};var Y={list:{},unbind:function(n){Y.list[n]=[]},bind:function(n,e){(Y.list[n]=Y.list[n]||[]).push(e)},fire:function(n,e){Q(Y.list[n]||[],function(n){n(e)})}},Z=ta("pubnub")||0,La=function(n){function e(){}function o(n,e){function t(e){e&&(E=J()-(e/1e4+(J()-o)/2),n&&n(E))}var o=J();e&&t(e)||X.time(t)}function r(n,e){L&&L(n,e),L=t}function i(){X.time(function(n){o(x(),n),n||r(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),setTimeout(i,b)})}function a(){q()||r(1,{error:"Offline. Please check your network settings. "}),setTimeout(a,I)}function c(n){var e=0;return Q(qa(K),function(t){(t=K[t])&&(e++,(n||x())(t))}),e}function s(n){if(D){if(!N.length)return}else{if(n&&(N.h=0),N.h||!N.length)return;N.h=1}W(N.shift())}n.jsonp&&(Ca=0);var f=n.subscribe_key||"";n.uuid||Ja.get(f+"uuid"),n.xdr=Fa,n.db=Ja,n.error=ua,n._is_online=Ha,n.jsonp_cb=Da,n.PNSDK=Ea,n.hmac_SHA256=sa;var l,d=+n.windowing||10,p=(+n.timeout||310)*I,b=(+n.keepalive||60)*I,h=n.noleave||0,m=n.publish_key||"demo",g=n.subscribe_key||"demo",y=n.auth_key||"",v=n.secret_key||"",w=n.PNSDK||"",k=n.hmac_SHA256,S=n.ssl?"s":"",O="http"+S+"://"+(n.origin||"pubsub.pubnub.com"),_=P(O),M=P(O),N=[],E=0,T=0,R=0,L=0,A=0,B=0,K={},D=n.no_wait_for_pending,W=n.xdr,H=n.error||x(),q=n._is_online||function(){return 1},$=n.jsonp_cb||function(){return 0},Z=n.db||{get:x(),set:x()},F=n.uuid||Z&&Z.get(g+"uuid")||"",X={LEAVE:function(n,e,t,o){var r={uuid:F,auth:y},i=P(O),t=t||x(),a=o||x(),o=$();return 0<n.indexOf(G)?j:h||!S||"0"==o?u:("0"!=o&&(r.callback=o),W({g:e||S,timeout:2e3,a:o,data:r,c:function(n){"object"==typeof n&&n.error?a(n):t(n)},b:a,url:[i,"v2","presence","sub_key",g,"channel",encodeURIComponent(n),"leave"]}),j)},history:function(n,e){var e=n.callback||e,t=n.count||n.limit||100,o=n.reverse||"false",r=n.error||x(),i=n.auth_key||y,a=n.channel,u=n.start,c=n.end,s={},f=$();return a?e?g?(s.stringtoken="true",s.count=t,s.reverse=o,s.auth=i,f&&(s.callback=f),u&&(s.start=u),c&&(s.end=c),W({a:f,data:s,c:function(n){"object"==typeof n&&n.error?r(n):e(n)},b:r,url:[_,"v2","history","sub-key",g,"channel",encodeURIComponent(a)]}),void 0):H("Missing Subscribe Key"):H("Missing Callback"):H("Missing Channel")},replay:function(n){var e=e||n.callback||x(),t=n.auth_key||y,o=n.source,r=n.destination,i=n.stop,a=n.start,u=n.end,c=n.reverse,n=n.limit,s=$(),f={};return o?r?m?g?("0"!=s&&(f.callback=s),i&&(f.stop="all"),c&&(f.reverse="true"),a&&(f.start=a),u&&(f.end=u),n&&(f.count=n),f.auth=t,W({a:s,c:function(n){"object"==typeof n&&n.error?err(n):e(n)},b:function(){e([0,"Disconnected"])},url:[_,"v1","replay",m,g,o,r],data:f}),void 0):H("Missing Subscribe Key"):H("Missing Publish Key"):H("Missing Destination Channel"):H("Missing Source Channel")},auth:function(n){y=n,e()},time:function(n){var e=$();W({a:e,data:{uuid:F,auth:y},timeout:5*I,url:[_,"time",e],c:function(e){n(e[0])},b:function(){n(0)}})},publish:function(n,e){var e=e||n.callback||x(),t=n.message,o=n.channel,r=n.auth_key||y,i=n.error||x(),a=$(),u="push";return n.prepend&&(u="unshift"),t?o?m?g?(t=JSON.stringify(t),N[u]({a:a,timeout:5*I,url:[_,"publish",m,g,0,encodeURIComponent(o),a,encodeURIComponent(t)],data:{uuid:F,auth:r},b:function(n){i(n),s(1)},c:function(n){"object"==typeof n&&n.error?i(n):e(n),s(1)}}),s(),void 0):H("Missing Subscribe Key"):H("Missing Publish Key"):H("Missing Channel"):H("Missing Message")},unsubscribe:function(n,t){var o=n.channel,t=t||n.callback||x(),r=n.error||x();B=0,A=1,o=pa((o.join?o.join(","):""+o).split(","),function(n){return K[n]?n+","+n+G:void 0}).join(","),Q(o.split(","),function(n){var e=j;n&&(C&&(e=X.LEAVE(n,0,t,r)),e||t({action:"leave"}),K[n]=0)}),e()},subscribe:function(n,o){function i(n){n?setTimeout(e,I):(_=P(O,1),M=P(O,1),setTimeout(function(){X.time(i)},I)),c(function(e){return n&&e.d?(e.d=0,e.m(e.name)):(!n&&!e.d&&(e.d=1,e.l(e.name)),void 0)})}function a(){var n=$(),o=qa(K).join(",");o&&(r(),L=W({timeout:j,a:n,b:function(n){h(n),L=t,X.time(i)},data:{uuid:F,auth:s},url:[M,"subscribe",g,encodeURIComponent(o),n,B],c:function(n){if(L=t,!n||"object"==typeof n&&"error"in n&&n.error)return h(n),setTimeout(e,I);m(n[1]),B=!B&&A&&Z.get(g)||n[1],c(function(n){n.f||(n.f=1,n.k(n.name))}),k&&(B=1e4,k=0),Z.set(g,n[1]);var o,r=(2<n.length?n[2]:pa(K,function(e){return pa(Array(n[0].length).join(",").split(","),function(){return e})}).join(",")).split(",");o=function(){var n=r.shift()||R;return[(K[n]||{}).a||T,n.split(G)[0]]};var i=J()-E-+n[1]/1e4;Q(n[0],function(e){var t=o();t[0](e,n,t[1],i)}),setTimeout(a,U)}}))}var u=n.channel,o=(o=o||n.callback)||n.message,s=n.auth_key||y,f=n.connect||x(),l=n.reconnect||x(),b=n.disconnect||x(),h=n.error||x(),m=n.idle||x(),v=n.presence||0,w=n.noheresync||0,k=n.backfill||0,S=n.timetoken||0,j=n.timeout||p,U=n.windowing||d;return A=n.restore,B=S,u?o?g?(Q((u.join?u.join(","):""+u).split(","),function(n){var e=K[n]||{};K[R=n]={name:n,f:e.f,d:e.d,j:1,a:T=o,k:f,l:b,m:l},v&&(X.subscribe({channel:n+G,callback:v}),!e.j&&!w&&X.here_now({channel:n,callback:function(e){Q("uuids"in e?e.uuids:[],function(t){v({action:"join",uuid:t,timestamp:J(),occupancy:e.occupancy||1},e,n)})}}))}),e=function(){r(),setTimeout(a,U)},C?(e(),void 0):ba.push(e)):H("Missing Subscribe Key"):H("Missing Callback"):H("Missing Channel")},here_now:function(n,e){var e=n.callback||e,t=n.error||x(),o=n.auth_key||y,r=n.channel,i=$(),o={uuid:F,auth:o};return r?e?g?("0"!=i&&(o.callback=i),W({a:i,data:o,c:function(n){"object"==typeof n&&n.error?t(n):e(n)},b:t,url:[_,"v2","presence","sub_key",g,"channel",encodeURIComponent(r)]}),void 0):H("Missing Subscribe Key"):H("Missing Callback"):H("Missing Channel")},grant:function(n,e){var e=n.callback||e,t=n.error||x(),o=n.channel,r=$(),i=n.ttl||-1,a=n.read?"1":"0",u=n.write?"1":"0",c=n.auth_key;if(!o)return H("Missing Channel");if(!e)return H("Missing Callback");if(!g)return H("Missing Subscribe Key");if(!m)return H("Missing Publish Key");if(!v)return H("Missing Secret Key");"0"!=r&&(s.callback=r);var s=Math.floor((new Date).getTime()/1e3),f=k(g+"\n"+m+"\ngrant\n"+(c&&0<encodeURIComponent(c).length?"auth="+encodeURIComponent(c)+"&":"")+"channel="+encodeURIComponent(o)+"&pnsdk="+encodeURIComponent(w)+"&r="+a+"&timestamp="+encodeURIComponent(s)+(i>-1?"&ttl="+i:"")+"&w="+u,v),f=f.replace(/\+/g,"-"),f=f.replace(/\//g,"_"),s={w:u,r:a,signature:f,channel:encodeURIComponent(o),timestamp:s};i>-1&&(s.ttl=i),c&&(s.auth=encodeURIComponent(c)),W({a:r,data:s,c:function(n){e(n)},b:t,url:[_,"v1","auth","grant","sub-key",g]})},audit:function(n,e){var e=n.callback||e,t=n.error||x(),o=n.channel,r=n.auth_key,i=$();if(!e)return H("Missing Callback");if(!g)return H("Missing Subscribe Key");if(!m)return H("Missing Publish Key");if(!v)return H("Missing Secret Key");"0"!=i&&(a.callback=i);var a=Math.floor((new Date).getTime()/1e3),u=g+"\n"+m+"\naudit\n";r&&(u+="auth="+encodeURIComponent(r)+"&"),o&&(u+="channel="+encodeURIComponent(o)+"&");var u=u+("pnsdk="+encodeURIComponent(w)+"&timestamp="+a),u=k(u,v),u=u.replace(/\+/g,"-"),u=u.replace(/\//g,"_"),a={signature:u,timestamp:a};o&&(a.channel=encodeURIComponent(o)),r&&(a.auth=encodeURIComponent(r)),W({a:i,data:a,c:function(n){e(n)},b:t,url:[_,"v1","auth","audit","sub-key",g]})},revoke:function(n,e){n.read=u,n.write=u,X.grant(n,e)},set_uuid:function(n){F=n,e()},get_uuid:function(){return F},xdr:W,ready:ra,db:Z,uuid:ja,map:pa,each:Q,"each-channel":c,grep:na,offline:function(){r(1)},supplant:oa,now:J,unique:ga,updater:la};return F||(F=X.uuid()),Z.set(g+"uuid",F),setTimeout(a,I),setTimeout(i,b),o(),l=X,l.css=ya,l.$=ta,l.create=Ba,l.bind=U,l.head=xa,l.search=va,l.attr=V,l.events=Y,l.init=La,U("beforeunload",window,function(){return l["each-channel"](function(n){l.LEAVE(n.name,0)}),j}),n.notest?l:(U("offline",window,l.offline),U("offline",document,l.offline),l)};"complete"===document.readyState?setTimeout(ra,0):U("load",window,function(){setTimeout(ra,0)});var $=Z||{};PUBNUB=La({notest:1,publish_key:V($,"pub-key"),subscribe_key:V($,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==V($,"ssl"),origin:V($,"origin"),uuid:V($,"uuid")}),window.jQuery&&(window.jQuery.PUBNUB=PUBNUB),"undefined"!=typeof module&&(module.exports=PUBNUB)&&ra();var Ia=ta("pubnubs")||0;Z&&(ya(Z,{position:"absolute",top:-I}),("opera"in window||V(Z,"flash"))&&(Z.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>"),PUBNUB.rdx=function(n,e){return e?(W[n].responseText=unescape(e),W[n].onload(),void 0):W[n].onerror()},W.id=I)}var Ma=PUBNUB.ws=function(n,e){if(!(this instanceof Ma))return new Ma(n,e);var t=this,n=t.url=n||"";t.protocol=e||"Sec-WebSocket-Protocol";var o=n.split("/"),o={ssl:"wss:"===o[0],origin:o[2],publish_key:o[3],subscribe_key:o[4],channel:o[5]};return t.CONNECTING=0,t.OPEN=1,t.CLOSING=2,t.CLOSED=3,t.CLOSE_NORMAL=1e3,t.CLOSE_GOING_AWAY=1001,t.CLOSE_PROTOCOL_ERROR=1002,t.CLOSE_UNSUPPORTED=1003,t.CLOSE_TOO_LARGE=1004,t.CLOSE_NO_STATUS=1005,t.CLOSE_ABNORMAL=1006,t.onclose=t.onerror=t.onmessage=t.onopen=t.onsend=x(),t.binaryType="",t.extensions="",t.bufferedAmount=0,t.trasnmitting=u,t.buffer=[],t.readyState=t.CONNECTING,n?(t.e=PUBNUB.init(o),t.e.i=o,t.i=o,t.e.subscribe({restore:u,channel:o.channel,disconnect:t.onerror,reconnect:t.onopen,error:function(){t.onclose({code:t.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(n){t.onmessage({data:n})},connect:function(){t.readyState=t.OPEN,t.onopen()}}),void 0):(t.readyState=t.CLOSED,t.onclose({code:t.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:j}),t)};Ma.prototype.send=function(n){var e=this;e.e.publish({channel:e.e.i.channel,message:n,callback:function(n){e.onsend({data:n})}})}}();
},{}]},{},[8])
(8)
});

//# sourceMappingURL=WebP2P.map