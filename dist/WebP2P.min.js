
function MessagePacker(e){var r=new RpcBuilder(packer);this.unpack=function(e){return r.decode(e)},this.cancel=function(e){r.cancel(e)},this.presence=function(){var n={from:e};return r.encode("presence",n)},this.offer=function(n,c,t,i){if(t instanceof Function){if(i)throw new SyntaxError("Nothing can be defined after the callback");i=t,t=void 0}var a={dest:n,from:e,sdp:c,ttl:Math.min(t||MAX_TTL_DEFAULT,MAX_TTL_DEFAULT)};return r.encode("offer",a,n,i)}}var RpcBuilder=require("rpc-builder"),packer=require("./packer");const MAX_TTL_DEFAULT=5;module.exports=MessagePacker;
},{"./packer":12,"rpc-builder":19}],2:[function(require,module,exports){
function WebP2P(e){function n(e){l.emit("error",new Error(e))}function o(e,n,o){var r=new RTCPeerConnection({iceServers:[{url:"stun:"+p}]},{optional:[{DtlsSrtpKeyAgreement:!0}]});return r.addEventListener("icecandidate",function(e){if(!e.candidate){var r=this.localDescription.type,s=this.localDescription.sdp;r==n?o(s):console.error(r+" SDP type is not equal to "+n+" callback type")}}),r.addEventListener("signalingstatechange",function(){if("stable"==r.signalingState){var n=r._channels||[];D.add(e,r,n);var o=w[e];if(o){delete w[e];var s=o.callback;s&&s(null,r,n)}l.emit("peerconnection",r,n)}}),Object.defineProperty(r,"sessionID",{value:e}),r}function r(e,o){o=[l.routingLabel].concat(v,o);for(var r,s=[],t=0;r=o[t];t++){var i=e.createDataChannel(r);s.push(i),i.addEventListener("close",function(){s.splice(s.indexOf(i),1)})}e._channels=s;var c={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};e.createOffer(function(o){e.setLocalDescription(o,null,n)},n,c)}function s(e,o){e.setRemoteDescription(new RTCSessionDescription({sdp:o,type:"offer"}),function(){e.createAnswer(function(o){e.setLocalDescription(o,null,n)},n)},n)}function t(e,n){var o=e.from,r=e.dest;if(o!=l.sessionID){if(r==l.sessionID)return console.error("Ignored answer send to us",e);if(--e.ttl<=0)return console.warn("TTL achieved:",e);var r=e.dest;e=e.pack();for(var s,t=0;s=D._connectors[t];t++)if(s.sessionID==r)return s.send(e);D.send(e,n),h.send(e,n)}}function i(e){var n=D.get(e);if(n){var o="["+l.sessionID+"] Already connected to "+e;console.log(o);var r={from:l.sessionID,code:-1,message:o};return r}var s=w[e];if(s){var o="["+l.sessionID+"] Already requested connection to "+e;if(console.log(o),l.sessionID<e){var r={from:l.sessionID,code:-2,message:o};return r}m.cancel(s.message),s.peerConnection.close(),delete w[e]}}function c(e,n){if(e!=l.sessionID){var o=D.get(e);if(!o){var s=u(e,n);s.addEventListener("signalingstatechange",function(){"stable"==s.signalingState&&n.increaseConnections()}),r(s)}}}function a(e,n){var r=e.from,c=e.dest;if(r!=l.sessionID)if(c==l.sessionID){console.log("["+c+"] Received connection request from "+r);var a=e,u=i(r);if(u){var f=a.reply(u);return n.send(f)}var d=o(r,"answer",function(e){var o={from:c,sdp:e,ttl:MAX_TTL_DEFAULT};o=a.reply(null,o),n.send(o)});s(d,e.sdp)}else t(e,n)}function u(e,n,r){var s=o(e,"offer",function(o){var t=r?5:1,i=m.offer(e,o,t,function(e,n){if(e){if(e.dest!=l.sessionID)return;return m.cancel(i),r?r(e):console.error(e),void 0}n.dest==l.sessionID&&(console.debug("["+l.sessionID+"] Received answer for connectTo from "+n.from),f(n))});w[e]={callback:r,message:i,peerConnection:s},n instanceof Array?n.forEach(function(e){e.send(i)}):n.send(i)});return s}function f(e){var o=e.from,r=e.dest;console.log("["+r+"] Received connection response from "+o);var s=w[o];s?s.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:e.sdp,type:"answer"}),function(){console.log("Successfuly generated RemoteDescription for "+o)},n):console.warn("["+r+"] Connection with peer '"+o+"' was not previously requested")}function d(e){e.on("connected",function(){h.status!=D.status&&l.emit("connected")}),e.on("disconnected",function(){h.status==D.status&&l.emit("disconnected")}),e.on("error",function(e){l.emit("error",e)}),e.on("offer",a),e.on("answer",t)}var l=this,e=e||{},v=e.commonLabels||[],g=e.handshake_servers,p=e.stun_server||"stun.l.google.com:19302";Object.defineProperty(this,"routingLabel",{value:e.routingLabel||"webp2p"}),Object.defineProperty(this,"sessionID",{value:e.sessionID||uuid.v4()});var m=new MessagePacker(this.sessionID),h=new HandshakeManager(m,g),D=new PeersManager(m,l.routingLabel);this.__defineGetter__("status",function(){return"connected"==D.status?"connected":h.status}),this.__defineGetter__("peers",function(){return D.peers});var w={};this.connectTo=function(e,n,o){if(n instanceof Function){if(o)throw new SyntaxError("Nothing can be defined after the callback");o=n,n=void 0}if(e==l.sessionID)return o(new Error("Connecting to ourself"));var s=D.get(e);return s?o(null,s):(s=u(e,[h,D],o),r(s,n),void 0)},h.on("connected",function(){l.emit("handshakeManager.connected",h)}),h.on("disconnected",function(){l.emit("handshakeManager.disconnected",h)}),D.on("connected",function(){l.emit("peersManager.connected",D)}),D.on("disconnected",function(){l.emit("peersManager.disconnected",D)}),d(h),d(D),h.on("presence",c),this.close=function(){h.close(),D.close()},process.on("exit",function(){l.close()})}var process=require("__browserify_process"),EventEmitter=require("events").EventEmitter,inherits=require("inherits"),RTCPeerConnection=require("wrtc").RTCPeerConnection,uuid=require("uuid");require("process-events-shim");var HandshakeManager=require("./managers/HandshakeManager"),PeersManager=require("./managers/PeersManager"),MessagePacker=require("./MessagePacker");const MAX_TTL_DEFAULT=5;inherits(WebP2P,EventEmitter),module.exports=WebP2P;
},{"./MessagePacker":1,"./managers/HandshakeManager":9,"./managers/PeersManager":11,"__browserify_process":15,"events":13,"inherits":16,"process-events-shim":17,"uuid":24,"wrtc":25}],3:[function(require,module,exports){
function Connector_PubNub(e,n,r){HandshakeConnector.call(this,r);var o=this,c=n.channel,t=PUBNUB.init(e);t.subscribe({channel:c,restore:!1,backfill:!1,connect:o._open,message:o._message,disconnect:o._close,error:function(e){o._error(new Error(e?e.error:"Undefined error"))}}),this.close=function(){t.unsubscribe({channel:c}),o._close()},this.send=function(e){t.publish({channel:c,message:e})}}var inherits=require("inherits"),HandshakeConnector=require("./core/HandshakeConnector"),PUBNUB=require("pubnub");inherits(Connector_PubNub,HandshakeConnector),Connector_PubNub.prototype.max_connections=50,Object.defineProperty(Connector_PubNub.prototype,"max_chars",{value:1800}),module.exports=Connector_PubNub;
},{"./core/HandshakeConnector":6,"inherits":16,"pubnub":26}],4:[function(require,module,exports){
function Connector(){EventEmitter.call(this);var e=this;this._open=function(){e.emit("open")},this._message=function(t){e.emit("message",t)},this._close=function(){e.emit("close")},this._error=function(t){e.emit("error",t)}}var inherits=require("inherits"),EventEmitter=require("events").EventEmitter;inherits(Connector,EventEmitter),Connector.prototype.close=function(){throw new TypeError("Connector.close should be defined in a child class")},Connector.prototype.send=function(){throw new TypeError("Connector.send should be defined in a child class")},module.exports=Connector;
},{"events":13,"inherits":16}],5:[function(require,module,exports){
function Connector_DataChannel(e){Connector.call(this);var n=this;e.addEventListener("open",n._open),e.addEventListener("message",function(e){n._message(e.data)}),e.addEventListener("close",n._close),e.addEventListener("error",n._error),this.close=function(){e.close()},this.send=function(n){e.send(n)}}var inherits=require("inherits"),Connector=require("./Connector");inherits(Connector_DataChannel,Connector),module.exports=Connector_DataChannel;
},{"./Connector":4,"inherits":16}],6:[function(require,module,exports){
function HandshakeConnector(n){Connector.call(this);var o=this;void 0!=n&&(this.max_connections=Math.min(n,this.max_connections)),this.shouldConnect=function(){return!0};var e=0;this.increaseConnections=function(){e++,e>=o.max_connections&&o.close()}}var inherits=require("inherits"),Connector=require("./Connector");inherits(HandshakeConnector,Connector),HandshakeConnector.prototype.max_connections=Number.POSITIVE_INFINITY,module.exports=HandshakeConnector;
},{"./Connector":4,"inherits":16}],7:[function(require,module,exports){
const ERROR_NETWORK_UNKNOWN={id:0,msg:"Unable to fetch handshake servers configuration"},ERROR_NETWORK_OFFLINE={id:1,msg:"There's no available network"},ERROR_REQUEST_FAILURE={id:2,msg:"Unable to fetch handshake servers configuration"},ERROR_REQUEST_EMPTY={id:3,msg:"Handshake servers configuration is empty"},ERROR_NO_PEERS={id:4,msg:"Not connected to any peer"};exports.ERROR_NETWORK_UNKNOWN=ERROR_NETWORK_UNKNOWN,exports.ERROR_NETWORK_OFFLINE=ERROR_NETWORK_OFFLINE,exports.ERROR_REQUEST_FAILURE=ERROR_REQUEST_FAILURE,exports.ERROR_REQUEST_EMPTY=ERROR_REQUEST_EMPTY,exports.ERROR_NO_PEERS=ERROR_NO_PEERS;
},{}],8:[function(require,module,exports){
var HandshakeConnector=require("./connectors/core/HandshakeConnector"),WebP2P=require("./WebP2P");module.exports=WebP2P,module.exports.HandshakeConnector=HandshakeConnector;
},{"./WebP2P":2,"./connectors/core/HandshakeConnector":6}],9:[function(require,module,exports){
function HandshakeManager(n,r){function e(r){var e=r.type,o=r.config_init,s=r.config_mess,i=r.max_connections,c=a[e];if(!c)throw Error("Invalid handshake server type '"+e+"'");var d=new c(o,s,i);t._initConnector(d),d.on("open",function(){d.send(n.presence())});var u=d._messageUnpacked;return d._messageUnpacked=function(n){"presence"==n.method?d.shouldConnect()&&t.emit("presence",n.params.from,d):u.call(d,n)},d}function o(){if(!s.length)throw Error("No handshake servers defined");for(;i<s.length;i++){var n=e(s[i]);return n.on("close",function(){i++,o()}),void 0}i=0}Manager.call(this,n);var t=this,a={};this.registerConnectorConstructor=function(n,r){a[n]=r},this.registerConnectorConstructor("PubNub",Connector_PubNub);var s=[],i=0,c=[];this.addConfigs_byObject=function(n){var r=a[n.type];return r?(r.prototype.max_connections!=Number.POSITIVE_INFINITY||n.max_connections?(s.push(n),"disconnected"==t.status&&o()):(c.push(n),e(n)),void 0):console.error("Invalid handshake server config: ",n)},r&&this.addConfigs(r)}var inherits=require("inherits"),Manager=require("./Manager"),errors=require("../errors"),Connector_PubNub=require("../connectors/PubNub");inherits(HandshakeManager,Manager),HandshakeManager.prototype.addConfigs=function(n){return"string"==typeof n?this.addConfigs_byUri(n):n instanceof Array?this.addConfigs_byArray(n):(this.addConfigs_byObject(n),void 0)},HandshakeManager.prototype.addConfigs_byArray=function(n){for(var r,e=0;r=n[e];e++)this.addConfigs_byObject(r)},HandshakeManager.prototype.addConfigs_byUri=function(n){function r(n){e.emit("error",n)}var e=this,o=new XMLHttpRequest;o.open("GET",n),o.onload=function(){if(200==this.status){var n=JSON.parse(o.response);n.length?e.addConfigs_byArray(n):r(errors.ERROR_REQUEST_EMPTY)}else r(errors.ERROR_REQUEST_FAILURE)},o.onerror=function(){r(navigator.onLine?errors.ERROR_NETWORK_UNKNOWN:errors.ERROR_NETWORK_OFFLINE)},o.send()},module.exports=HandshakeManager;
},{"../connectors/PubNub":3,"../errors":7,"./Manager":10,"inherits":16}],10:[function(require,module,exports){
function Manager(e){EventEmitter.call(this);var n=this;this._connectors=[],this.__defineGetter__("status",function(){return this._connectors.length?"connected":"disconnected"}),this._initConnector=function(t){t.on("open",function(){n._connectors.push(t),1==n._connectors.length&&n.emit("connected")}),t.on("close",function(){n._connectors.splice(n._connectors.indexOf(t),1),0==n._connectors.length&&n.emit("disconnected")}),t.on("error",function(e){t.close(),n.emit("error",e)}),t._messageUnpacked=function(e){var o=e.method,r=e.params;switch(o){case"offer":r.reply=function(n,t){return e.reply(n,t)};case"answer":r.pack=function(){return e.pack()},n.emit(o,r,t);break;case"error":break;default:console.error("Unknown message method '"+o+"'",e)}},t.on("message",function(n){n=e.unpack(n),n&&(n.stored?t.send(n):t._messageUnpacked(n))})}}var EventEmitter=require("events").EventEmitter,inherits=require("inherits");inherits(Manager,EventEmitter),Manager.prototype.close=function(){for(var e,n=0;e=this._connectors[n];n++)e.close()},Manager.prototype.send=function(e,n){for(var t,o=0;t=this._connectors[o];o++)t!==n&&t.send(e)},module.exports=Manager;
},{"events":13,"inherits":16}],11:[function(require,module,exports){
function PeersManager(e,n){function t(e){var n=new Connector_DataChannel(e);return r._initConnector(n),n}function a(e,a){if(e.label==n){var r=t(e);return r.sessionID=a,r}}Manager.call(this,e);var r=this,i={};this.__defineGetter__("peers",function(){return i}),this.add=function(e,n,t){function r(n){var t=n.channel,i=a(t,e);i&&n.target.removeEventListener("datachannel",r)}if(n.addEventListener("signalingstatechange",function(){"closed"==n.signalingState&&delete i[e]}),t.length)for(var s,o=0;(s=t[o])&&!a(s,e);o++);else n.addEventListener("datachannel",r);i[e]=n},this.get=function(e){return i[e]};var s=this.close;this.close=function(){for(var e in i)i[e].close();s.call(this)}}var inherits=require("inherits"),Manager=require("./Manager"),Connector_DataChannel=require("../connectors/core/DataChannel");inherits(PeersManager,Manager),module.exports=PeersManager;
},{"../connectors/core/DataChannel":5,"./Manager":10,"inherits":16}],12:[function(require,module,exports){
function pack(e,r){var s=new Array(6),a=e.params||{},o=e.method;switch(o){case"error":s[0]=ERROR;break;case"presence":s[0]=PRESENCE;break;case"offer":s[0]=OFFER;break;case"answer":s[0]=ANSWER;break;default:var t=new Error("Unknown message method '"+o+"'");throw t.message=e,t}return s[1]=a.from,"presence"!=o&&(s[2]=a.dest,s[3]=r,s[4]=a.ttl,s[5]=a.sdp||a.message),JSON.stringify(s)}function unpack(e){var r={},s={};e=JSON.parse(e);var a=e[0];switch(a){case ERROR:r.method="error";break;case PRESENCE:r.method="presence";break;case OFFER:r.method="offer";break;case ANSWER:r.method="answer";break;default:var o=Error("Unknown message method '"+a+"'");throw o.message=e,o}return s.from=e[1],a!=PRESENCE&&(s.dest=e[2],r.id=e[3],s.ttl=e[4],a==ERROR?s.message=e[5]:s.sdp=e[5]),r.params=s,r}const ERROR=0,PRESENCE=1,OFFER=2,ANSWER=3;var responseMethods={presence:"offer",offer:{error:"error",response:"answer"}};exports.pack=pack,exports.unpack=unpack,exports.responseMethods=responseMethods;
},{}],13:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};
},{}],14:[function(require,module,exports){
require=function t(e,n,r){function i(a,f){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!f&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=n[a]={exports:{}};e[a][0].call(s.exports,function(t){var n=e[a][1][t];return i(n?n:t)},s,s.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({PcZj9L:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i=typeof t;if("base64"===e&&"string"===i)for(t=S(t);0!==t.length%4;)t+="=";var o;if("number"===i)o=M(t);else if("string"===i)o=r.byteLength(t,e);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=M(t.length)}var a;Y?a=_(new Uint8Array(o)):(a=this,a.length=o);var f;if(r.isBuffer(t))a.set(t);else if(N(t))for(f=0;o>f;f++)a[f]=r.isBuffer(t)?t.readUInt8(f):t[f];else if("string"===i)a.write(t,0,e);else if("number"===i&&!Y&&!n)for(f=0;o>f;f++)a[f]=0;return a}function i(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var a=e.length;if(0!==a%2)throw new Error("Invalid hex string");i>a/2&&(i=a/2);for(var f=0;i>f;f++){var u=parseInt(e.substr(2*f,2),16);if(isNaN(u))throw new Error("Invalid hex string");t[n+f]=u}return r._charsWritten=2*f,f}function o(t,e,n,i){return r._charsWritten=q(x(e),t,n,i)}function a(t,e,n,i){return r._charsWritten=q(T(e),t,n,i)}function f(t,e,n,r){return a(t,e,n,r)}function u(t,e,n,i){return r._charsWritten=q(V(e),t,n,i)}function s(t,e,n){return 0===e&&n===t.length?R.fromByteArray(t):R.fromByteArray(t.slice(e,n))}function l(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=k(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+k(i)}function h(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function c(t,e,n){return h(t,e,n)}function g(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=C(t[o]);return i}function d(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(i>e+1)return t._dataview.getUint16(e,n);var o=new DataView(new ArrayBuffer(2));return o.setUint8(0,t[i-1]),o.getUint16(0,n)}var a;return n?(a=t[e],i>e+1&&(a|=t[e+1]<<8)):(a=t[e]<<8,i>e+1&&(a|=t[e+1])),a}}function w(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(i>e+3)return t._dataview.getUint32(e,n);for(var o=new DataView(new ArrayBuffer(4)),a=0;i>a+e;a++)o.setUint8(a,t[a+e]);return o.getUint32(0,n)}var f;return n?(i>e+2&&(f=t[e+2]<<16),i>e+1&&(f|=t[e+1]<<8),f|=t[e],i>e+3&&(f+=t[e+3]<<24>>>0)):(i>e+1&&(f=t[e+1]<<16),i>e+2&&(f|=t[e+2]<<8),i>e+3&&(f|=t[e+3]),f+=t[e]<<24>>>0),f}}function v(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(e+1===i){var o=new DataView(new ArrayBuffer(2));return o.setUint8(0,t[i-1]),o.getInt16(0,n)}return t._dataview.getInt16(e,n)}var a=d(t,e,n,!0),f=32768&a;return f?-1*(65535-a+1):a}}function p(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){if(Y){if(e+3>=i){for(var o=new DataView(new ArrayBuffer(4)),a=0;i>a+e;a++)o.setUint8(a,t[a+e]);return o.getInt32(0,n)}return t._dataview.getInt32(e,n)}var f=w(t,e,n,!0),u=2147483648&f;return u?-1*(4294967295-f+1):f}}function y(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+3<t.length,"Trying to read beyond buffer length")),Y?t._dataview.getFloat32(e,n):X.read(t,e,n,23,4)}function b(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+7<t.length,"Trying to read beyond buffer length")),Y?t._dataview.getFloat64(e,n):X.read(t,e,n,52,8)}function m(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"trying to write beyond buffer length"),O(e,65535));var o=t.length;if(!(n>=o))if(Y)if(n+1===o){var a=new DataView(new ArrayBuffer(2));a.setUint16(0,e,r),t[n]=a.getUint8(0)}else t._dataview.setUint16(n,e,r);else for(var f=0,u=Math.min(o-n,2);u>f;f++)t[n+f]=(e&255<<8*(r?f:1-f))>>>8*(r?f:1-f)}function E(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"trying to write beyond buffer length"),O(e,4294967295));var o=t.length;if(!(n>=o)){var a;if(Y)if(n+3>=o){var f=new DataView(new ArrayBuffer(4));for(f.setUint32(0,e,r),a=0;o>a+n;a++)t[a+n]=f.getUint8(a)}else t._dataview.setUint32(n,e,r);else for(a=0,j=Math.min(o-n,4);j>a;a++)t[n+a]=255&e>>>8*(r?a:3-a)}}function I(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"Trying to write beyond buffer length"),P(e,32767,-32768));var o=t.length;if(!(n>=o))if(Y)if(n+1===o){var a=new DataView(new ArrayBuffer(2));a.setInt16(0,e,r),t[n]=a.getUint8(0)}else t._dataview.setInt16(n,e,r);else e>=0?m(t,e,n,r,i):m(t,65535+e+1,n,r,i)}function B(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),P(e,2147483647,-2147483648));var o=t.length;if(!(n>=o))if(Y)if(n+3>=o){var a=new DataView(new ArrayBuffer(4));a.setInt32(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setInt32(n,e,r);else e>=0?E(t,e,n,r,i):E(t,4294967295+e+1,n,r,i)}function U(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),W(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;if(!(n>=o))if(Y)if(n+3>=o){var a=new DataView(new ArrayBuffer(4));a.setFloat32(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setFloat32(n,e,r);else X.write(t,e,n,r,23,4)}function A(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+7<t.length,"Trying to write beyond buffer length"),W(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;if(!(n>=o))if(Y)if(n+7>=o){var a=new DataView(new ArrayBuffer(8));a.setFloat64(0,e,r);for(var f=0;o>f+n;f++)t[f+n]=a.getUint8(f)}else t._dataview.setFloat64(n,e,r);else X.write(t,e,n,r,52,8)}function L(){return new r(this).buffer}function S(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function _(t){return t._isBuffer=!0,t.write=Z.write,t.toString=Z.toString,t.toLocaleString=Z.toString,t.toJSON=Z.toJSON,t.copy=Z.copy,t.slice=Z.slice,t.readUInt8=Z.readUInt8,t.readUInt16LE=Z.readUInt16LE,t.readUInt16BE=Z.readUInt16BE,t.readUInt32LE=Z.readUInt32LE,t.readUInt32BE=Z.readUInt32BE,t.readInt8=Z.readInt8,t.readInt16LE=Z.readInt16LE,t.readInt16BE=Z.readInt16BE,t.readInt32LE=Z.readInt32LE,t.readInt32BE=Z.readInt32BE,t.readFloatLE=Z.readFloatLE,t.readFloatBE=Z.readFloatBE,t.readDoubleLE=Z.readDoubleLE,t.readDoubleBE=Z.readDoubleBE,t.writeUInt8=Z.writeUInt8,t.writeUInt16LE=Z.writeUInt16LE,t.writeUInt16BE=Z.writeUInt16BE,t.writeUInt32LE=Z.writeUInt32LE,t.writeUInt32BE=Z.writeUInt32BE,t.writeInt8=Z.writeInt8,t.writeInt16LE=Z.writeInt16LE,t.writeInt16BE=Z.writeInt16BE,t.writeInt32LE=Z.writeInt32LE,t.writeInt32BE=Z.writeInt32BE,t.writeFloatLE=Z.writeFloatLE,t.writeFloatBE=Z.writeFloatBE,t.writeDoubleLE=Z.writeDoubleLE,t.writeDoubleBE=Z.writeDoubleBE,t.fill=Z.fill,t.inspect=Z.inspect,t.toArrayBuffer=L,0!==t.byteLength&&(t._dataview=new DataView(t.buffer,t.byteOffset,t.byteLength)),t}function D(t,e,n){return"number"!=typeof t?n:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function M(t){return t=~~Math.ceil(+t),0>t?0:t}function F(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function N(t){return F(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function C(t){return 16>t?"0"+t.toString(16):t.toString(16)}function x(t){for(var e=[],n=0;n<t.length;n++)if(t.charCodeAt(n)<=127)e.push(t.charCodeAt(n));else for(var r=encodeURIComponent(t.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)e.push(parseInt(r[i],16));return e}function T(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function V(t){return R.toByteArray(t)}function q(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function k(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function O(t,e){J("number"==typeof t,"cannot write a non-number as a number"),J(t>=0,"specified a negative value for writing an unsigned value"),J(e>=t,"value is larger than maximum value for type"),J(Math.floor(t)===t,"value has a fractional component")}function P(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value"),J(Math.floor(t)===t,"value has a fractional component")}function W(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value")}function J(t,e){if(!t)throw new Error(e||"Failed assertion")}var R=t("base64-js"),X=t("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var Y=function(){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer||"undefined"==typeof DataView)return!1;try{var t=new Uint8Array(0);return t.foo=function(){return 42},42===t.foo()}catch(e){return!1}}();r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":return!0;default:return!1}},r.isBuffer=function(t){return t&&t._isBuffer},r.byteLength=function(t,e){switch(e||"utf8"){case"hex":return t.length/2;case"utf8":case"utf-8":return x(t).length;case"ascii":case"binary":return t.length;case"base64":return V(t).length;default:throw new Error("Unknown encoding")}},r.concat=function(t,e){if(!F(t))throw new Error("Usage: Buffer.concat(list, [totalLength])\nlist should be an Array.");if(0===t.length)return new r(0);if(1===t.length)return t[0];var n;if("number"!=typeof e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var a=t[n];a.copy(i,o),o+=a.length}return i},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var s=r;r=e,e=n,n=s}e=Number(e)||0;var l=this.length-e;switch(n?(n=Number(n),n>l&&(n=l)):n=l,r=String(r||"utf8").toLowerCase()){case"hex":return i(this,t,e,n);case"utf8":case"utf-8":return o(this,t,e,n);case"ascii":return a(this,t,e,n);case"binary":return f(this,t,e,n);case"base64":return u(this,t,e,n);default:throw new Error("Unknown encoding")}},r.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0!==n?Number(n):n=r.length,n===e)return"";switch(t){case"hex":return g(r,e,n);case"utf8":case"utf-8":return l(r,e,n);case"ascii":return h(r,e,n);case"binary":return c(r,e,n);case"base64":return s(r,e,n);default:throw new Error("Unknown encoding")}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(t,e,n,r){var i=this;if(n||(n=0),r||0===r||(r=this.length),e||(e=0),r!==n&&0!==t.length&&0!==i.length){if(n>r)throw new Error("sourceEnd < sourceStart");if(0>e||e>=t.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);for(var o=0;r-n>o;o++)t[o+e]=this[o+n]}},r.prototype.slice=function(t,e){var n=this.length;if(t=D(t,n,0),e=D(e,n,n),Y)return _(this.subarray(t,e));for(var i=e-t,o=new r(i,void 0,!0),a=0;i>a;a++)o[a]=this[a+t];return o},r.prototype.readUInt8=function(t,e){var n=this;return e||(J(void 0!==t&&null!==t,"missing offset"),J(t<n.length,"Trying to read beyond buffer length")),t>=n.length?void 0:n[t]},r.prototype.readUInt16LE=function(t,e){return d(this,t,!0,e)},r.prototype.readUInt16BE=function(t,e){return d(this,t,!1,e)},r.prototype.readUInt32LE=function(t,e){return w(this,t,!0,e)},r.prototype.readUInt32BE=function(t,e){return w(this,t,!1,e)},r.prototype.readInt8=function(t,e){var n=this;if(e||(J(void 0!==t&&null!==t,"missing offset"),J(t<n.length,"Trying to read beyond buffer length")),!(t>=n.length)){if(Y)return n._dataview.getInt8(t);var r=128&n[t];return r?-1*(255-n[t]+1):n[t]}},r.prototype.readInt16LE=function(t,e){return v(this,t,!0,e)},r.prototype.readInt16BE=function(t,e){return v(this,t,!1,e)},r.prototype.readInt32LE=function(t,e){return p(this,t,!0,e)},r.prototype.readInt32BE=function(t,e){return p(this,t,!1,e)},r.prototype.readFloatLE=function(t,e){return y(this,t,!0,e)},r.prototype.readFloatBE=function(t,e){return y(this,t,!1,e)},r.prototype.readDoubleLE=function(t,e){return b(this,t,!0,e)},r.prototype.readDoubleBE=function(t,e){return b(this,t,!1,e)},r.prototype.writeUInt8=function(t,e,n){var r=this;n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<r.length,"trying to write beyond buffer length"),O(t,255)),e>=r.length||(r[e]=t)},r.prototype.writeUInt16LE=function(t,e,n){m(this,t,e,!0,n)},r.prototype.writeUInt16BE=function(t,e,n){m(this,t,e,!1,n)},r.prototype.writeUInt32LE=function(t,e,n){E(this,t,e,!0,n)},r.prototype.writeUInt32BE=function(t,e,n){E(this,t,e,!1,n)},r.prototype.writeInt8=function(t,e,n){var r=this;n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<r.length,"Trying to write beyond buffer length"),P(t,127,-128)),e>=r.length||(Y?r._dataview.setInt8(e,t):t>=0?r.writeUInt8(t,e,n):r.writeUInt8(255+t+1,e,n))},r.prototype.writeInt16LE=function(t,e,n){I(this,t,e,!0,n)},r.prototype.writeInt16BE=function(t,e,n){I(this,t,e,!1,n)},r.prototype.writeInt32LE=function(t,e,n){B(this,t,e,!0,n)},r.prototype.writeInt32BE=function(t,e,n){B(this,t,e,!1,n)},r.prototype.writeFloatLE=function(t,e,n){U(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){U(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){A(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){A(this,t,e,!1,n)},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),"number"!=typeof t||isNaN(t))throw new Error("value is not a number");if(e>n)throw new Error("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");for(var r=e;n>r;r++)this[r]=t}},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=C(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"};var Z=r.prototype},{"base64-js":3,ieee754:4}],"native-buffer-browserify":[function(t,e){e.exports=t("PcZj9L")},{}],3:[function(t,e){function n(t,e){var n=t.length,r=Number(arguments[1])||0;for(r=0>r?Math.ceil(r):Math.floor(r),0>r&&(r+=n);n>r;r++)if("string"==typeof t&&t.charAt(r)===e||"string"!=typeof t&&t[r]===e)return r;return-1}!function(){"use strict";function t(t){var e,r,o,a,f,u;if(t.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(f=n(t,"="),f=f>0?t.length-f:0,u=[],o=f>0?t.length-4:t.length,e=0,r=0;o>e;e+=4,r+=3)a=n(i,t.charAt(e))<<18|n(i,t.charAt(e+1))<<12|n(i,t.charAt(e+2))<<6|n(i,t.charAt(e+3)),u.push((16711680&a)>>16),u.push((65280&a)>>8),u.push(255&a);return 2===f?(a=n(i,t.charAt(e))<<2|n(i,t.charAt(e+1))>>4,u.push(255&a)):1===f&&(a=n(i,t.charAt(e))<<10|n(i,t.charAt(e+1))<<4|n(i,t.charAt(e+2))>>2,u.push(255&a>>8),u.push(255&a)),u}function r(t){function e(t){return i.charAt(63&t>>18)+i.charAt(63&t>>12)+i.charAt(63&t>>6)+i.charAt(63&t)}var n,r,o,a=t.length%3,f="";for(n=0,o=t.length-a;o>n;n+=3)r=(t[n]<<16)+(t[n+1]<<8)+t[n+2],f+=e(r);switch(a){case 1:r=t[t.length-1],f+=i.charAt(r>>2),f+=i.charAt(63&r<<4),f+="==";break;case 2:r=(t[t.length-2]<<8)+t[t.length-1],f+=i.charAt(r>>10),f+=i.charAt(63&r>>4),f+=i.charAt(63&r<<2),f+="="}return f}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.exports.toByteArray=t,e.exports.fromByteArray=r}()},{}],4:[function(t,e,n){n.read=function(t,e,n,r,i){var o,a,f=8*i-r-1,u=(1<<f)-1,s=u>>1,l=-7,h=n?i-1:0,c=n?-1:1,g=t[e+h];for(h+=c,o=g&(1<<-l)-1,g>>=-l,l+=f;l>0;o=256*o+t[e+h],h+=c,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=c,l-=8);if(0===o)o=1-s;else{if(o===u)return a?0/0:1/0*(g?-1:1);a+=Math.pow(2,r),o-=s}return(g?-1:1)*a*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var a,f,u,s=8*o-i-1,l=(1<<s)-1,h=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:o-1,d=r?1:-1,w=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(f=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+h>=1?c/u:c*Math.pow(2,1-h),e*u>=2&&(a++,u/=2),a+h>=l?(f=0,a=l):a+h>=1?(f=(e*u-1)*Math.pow(2,i),a+=h):(f=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+g]=255&f,g+=d,f/=256,i-=8);for(a=a<<i|f,s+=i;s>0;t[n+g]=255&a,g+=d,a/=256,s-=8);t[n+g-d]|=128*w}},{}]},{},[]),module.exports=require("native-buffer-browserify").Buffer;
},{}],15:[function(require,module,exports){
var process=module.exports={};process.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(n){var o=[];return window.addEventListener("message",function(e){var n=e.source;if((n===window||null===n)&&"process-tick"===e.data&&(e.stopPropagation(),o.length>0)){var r=o.shift();r()}},!0),function(e){o.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")};
},{}],16:[function(require,module,exports){
module.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],17:[function(require,module,exports){
var process=require("__browserify_process"),global="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};!function(){var e,n,o,r,i;if(e=require("events").EventEmitter,o=function(){var n,o,r;r=e.prototype;for(n in r)if(o=r[n],null!=process[n])return!1;return!0},"undefined"!=typeof window&&null!==window&&window.document&&window.navigator&&"undefined"!=typeof process&&null!==process&&"undefined"!=typeof global&&null!==global&&window===global&&null===window.onerror&&o()){i=e.prototype;for(n in i)r=i[n],process[n]=r;window.onerror=function(e,n,o){return process.emit("uncaughtException",new Error(""+e+" ("+n+":"+o+")"))},window.addEventListener("unload",function(){return process.emit("exit")})}}.call(this);
},{"__browserify_process":15,"events":13}],18:[function(require,module,exports){
function Mapper(){var e={};this.get=function(t,o){var i=e[o];return void 0==i?void 0:i[t]},this.remove=function(t,o){var i=e[o];void 0!=i&&(delete i[t],Object.keys(i).length||delete e[o])},this.set=function(t,o,i){if(void 0==t)return this.remove(o,i);var r=e[i];void 0==r&&(e[i]=r={}),r[o]=t}}Mapper.prototype.pop=function(e,t){var o=this.get(e,t);return void 0==o?void 0:(this.remove(e,t),o)},module.exports=Mapper;
},{}],19:[function(require,module,exports){
function unifyResponseMethods(e){if(!e)return{};for(var r in e){var t=e[r];"string"==typeof t&&(e[r]={response:t})}return e}function RpcNotification(e,r){Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:r,enumerable:!0})}function RpcBuilder(e){function r(e,r,t){var i={message:e,timeout:setTimeout(function(){c.remove(r,t)},BASE_TIMEOUT)};c.set(i,r,t)}function t(t,n,o,a){RpcNotification.call(this,t,n);var s=c.get(o,a);Object.defineProperty(this,"duplicated",{value:Boolean(s)});var u=i[t];this.pack=function(){return e.pack(this,o)},this.reply=function(t,i){s&&clearTimeout(s.timeout),void 0!=a&&(t&&(t.dest=a),i&&(i.dest=a));var n;return u?void 0==u.error&&t?n=e.pack({error:t},o):(u=t?u.error:u.response,n=e.pack({method:u,params:t||i},o)):n=t||i?e.pack({error:t,result:i},o):s?s.message:e.pack({result:null},o),r(n,o,a),n}}if(!e)throw new SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw new SyntaxError("Packer is invalid");var i=unifyResponseMethods(e.responseMethods),n=this,o=0,a=new Mapper,c=new Mapper,s={};inherits(t,RpcNotification),this.cancel=function(e){var r=s[e];if(r){delete s[e];var t=a.pop(r.id,r.dest);t&&clearTimeout(t.timeout)}},this.encode=function(r,t,c,u){function p(e,r){n.cancel(f),u(e,r)}if(t instanceof Function){if(void 0!=c)throw new SyntaxError("There can't be parameters after callback");u=t,c=void 0,t=void 0}else if(c instanceof Function){if(void 0!=u)throw new SyntaxError("There can't be parameters after callback");u=c,c=void 0}var f={method:r,params:t};if(u){var d=o++;f=e.pack(f,d);var l={message:f,callback:p,responseMethods:i[r]||{},timeout:setTimeout(function(){var e=new Error("Request has timed out");e.request=l.message,p(e)},BASE_TIMEOUT)};s[f]={id:d,dest:c},a.set(l,d,c)}else f=e.pack(f);return f},this.decode=function(r){if(!r)throw new TypeError("Message is not defined");r=e.unpack(r);var i=r.id,n=r.method,o=r.params||{},c=o.from;if(void 0==i)return new RpcNotification(n,o);if(n){var s=a.get(i,c);if(s){var u=s.responseMethods;if(n==u.error)return s.callback(o),a.remove(i,c);if(n==u.response)return s.callback(null,o),a.remove(i,c)}return r.pack=function(){return e.pack(r,i)},new t(n,o,i,c)}var s=a.get(i,c);return void 0==s?console.warn("No callback was defined for this message",r):(s.callback(r.error,r.result),void 0)}}var inherits=require("inherits"),packers=require("./packers"),Mapper=require("./Mapper");const BASE_TIMEOUT=5e3;RpcBuilder.RpcNotification=RpcNotification,module.exports=RpcBuilder,RpcBuilder.packers=packers;
},{"./Mapper":18,"./packers":22,"inherits":16}],20:[function(require,module,exports){
function pack(r,e){var o={jsonrpc:"2.0"};if(r.method)o.method=r.method,r.params&&(o.params=r.params),void 0!=e&&(o.id=e);else if(void 0!=e){if(r.error){if(void 0!==r.result)throw new TypeError("Both result and error are defined");o.error=r.error}else{if(void 0===r.result)throw new TypeError("No result or error is defined");o.result=r.result}o.id=e}return JSON.stringify(o)}function unpack(r){("string"==typeof r||r instanceof String)&&(r=JSON.parse(r));var e=r.jsonrpc;if("2.0"!=e)throw new TypeError("Invalid JsonRPC version '"+e+"': "+JSON.stringify(r));if(void 0==r.method){if(void 0==r.id)throw new TypeError("Invalid message: "+JSON.stringify(r));var o=void 0!==r.result,i=void 0!==r.error;if(o&&i)throw new TypeError("Both result and error are defined: "+JSON.stringify(r));if(!o&&!i)throw new TypeError("No result or error is defined: "+JSON.stringify(r))}return r}exports.pack=pack,exports.unpack=unpack;
},{}],21:[function(require,module,exports){
function pack(){throw new TypeError("Not yet implemented")}function unpack(){throw new TypeError("Not yet implemented")}exports.pack=pack,exports.unpack=unpack;
},{}],22:[function(require,module,exports){
var JsonRPC=require("./JsonRPC"),XmlRPC=require("./XmlRPC");exports.JsonRPC=JsonRPC,exports.XmlRPC=XmlRPC;
},{"./JsonRPC":20,"./XmlRPC":21}],23:[function(require,module,exports){
var global="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var n,r=0;16>r;r++)0===(3&r)&&(n=4294967296*Math.random()),_rnds[r]=255&n>>>((3&r)<<3);return _rnds}}module.exports=rng;
},{}],24:[function(require,module,exports){
function parse(e,s,r){var t=s&&r||0,u=0;for(s=s||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>u&&(s[t+u++]=_hexToByte[e])});16>u;)s[t+u++]=0;return s}function unparse(e,s){var r=s||0,t=_byteToHex;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]}function v1(e,s,r){var t=s&&r||0,u=s||[];e=e||{};var n=void 0!==e.clockseq?e.clockseq:_clockseq,o=void 0!==e.msecs?e.msecs:(new Date).getTime(),a=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,i=o-_lastMSecs+(a-_lastNSecs)/1e4;if(0>i&&void 0===e.clockseq&&(n=16383&n+1),(0>i||o>_lastMSecs)&&void 0===e.nsecs&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=o,_lastNSecs=a,_clockseq=n,o+=122192928e5;var _=(1e4*(268435455&o)+a)%4294967296;u[t++]=255&_>>>24,u[t++]=255&_>>>16,u[t++]=255&_>>>8,u[t++]=255&_;var c=268435455&1e4*(o/4294967296);u[t++]=255&c>>>8,u[t++]=255&c,u[t++]=16|15&c>>>24,u[t++]=255&c>>>16,u[t++]=128|n>>>8,u[t++]=255&n;for(var f=e.node||_nodeId,d=0;6>d;d++)u[t+d]=f[d];return s?s:unparse(u)}function v4(e,s,r){var t=s&&r||0;"string"==typeof e&&(s="binary"==e?new BufferClass(16):null,e=null),e=e||{};var u=e.random||(e.rng||_rng)();if(u[6]=64|15&u[6],u[8]=128|63&u[8],s)for(var n=0;16>n;n++)s[t+n]=u[n];return s||unparse(u)}for(var Buffer=require("__browserify_Buffer"),_rng=require("./rng"),BufferClass="function"==typeof Buffer?Buffer:Array,_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,uuid.BufferClass=BufferClass,module.exports=uuid;
},{"./rng":23,"__browserify_Buffer":14}],25:[function(require,module,exports){
var RTCIceCandidate=window.mozRTCIceCandidate||window.webkitRTCIceCandidate||window.RTCIceCandidate,RTCPeerConnection=window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection,RTCSessionDescription=window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.RTCSessionDescription;exports.RTCIceCandidate=RTCIceCandidate,exports.RTCPeerConnection=RTCPeerConnection,exports.RTCSessionDescription=RTCSessionDescription;
},{}],26:[function(require,module,exports){
function unique(){return"x"+ ++NOW+ +new Date}function rnow(){return+new Date}function build_url(e,n){var t=e.join(URLBIT),r=[];return n?(each(n,function(e,n){var t="object"==typeof n?JSON.stringify(n):n;"undefined"!=typeof n&&null!=n&&encode(t).length>0&&r.push(e+"="+encode(t))}),t+="?"+r.join(PARAMSBIT)):t}function updater(e,n){var t,r=0,c=function(){r+n>rnow()?(clearTimeout(t),t=setTimeout(c,n)):(r=rnow(),e())};return c}function grep(e,n){var t=[];return each(e||[],function(e){n(e)&&t.push(e)}),t}function supplant(e,n){return e.replace(REPL,function(e,t){return n[t]||e})}function timeout(e,n){return setTimeout(e,n)}function uuid(e){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=0|16*Math.random(),t="x"==e?n:8|3&n;return t.toString(16)});return e&&e(n),n}function isArray(e){var n=Object.prototype.toString.call(e);return"[object Array]"===n||"[object NodeList]"===n||"[object ScriptBridgingArrayProxyObject]"===n}function each(e,n,t){if(e&&n)if(isArray(e)||t&&"undefined"!=typeof e[0])for(var r=0,c=e.length;c>r;)n.call(e[r],e[r],r++);else for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&n.call(e[r],r,e[r])}function map(e,n){var t=[];return each(e||[],function(e,r){t.push(n(e,r))}),t}function encode(e){return encodeURIComponent(e)}function generate_channel_list(e,n){var t=[];return each(e,function(e,r){n?e.search("-pnpres")<0&&r.subscribed&&t.push(e):r.subscribed&&t.push(e)}),t.sort()}function ready(){timeout(function(){READY||(READY=1,each(READY_BUFFER,function(e){e()}))},SECOND)}function PN_API(e){function n(e,n,t){var r=!1;if("number"==typeof e)r=e>PRESENCE_HB_THRESHOLD||0==e?!1:!0;else{if("boolean"==typeof e)return e?PRESENCE_HB_DEFAULT:0;r=!0}return r?(t&&t("Presence Heartbeat value invalid. Valid range ( x > "+PRESENCE_HB_THRESHOLD+" or x = 0). Current Value : "+(n||PRESENCE_HB_THRESHOLD)),n||PRESENCE_HB_THRESHOLD):e}function t(e,n){return $.encrypt(e,n||Q)||e}function r(e,n){return $.decrypt(e,n||Q)||$.decrypt(e,Q)||e}function c(){return clearTimeout(H),!K||K>=500||1>K||!generate_channel_list(U,!0).length?(J=!1,void 0):(J=!0,en.presence_heartbeat({callback:function(){H=timeout(c,K*SECOND)},error:function(e){W&&W("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),H=timeout(c,K*SECOND)}}),void 0)}function i(){!J&&c()}function a(e){if(G){if(!A.length)return}else{if(e&&(A.sending=0),A.sending||!A.length)return;A.sending=1}V(A.shift())}function o(e){var n=0;return each(generate_channel_list(U),function(t){var r=U[t];r&&(n++,(e||function(){})(r))}),n}function u(e,n,t){if("object"==typeof e){if(e.error&&e.message&&e.payload)return t({message:e.message,payload:e.payload}),void 0;if(e.payload)return n(e.payload),void 0}n(e)}function f(e,n){"object"==typeof e&&e.error&&e.message&&e.payload?n({message:e.message,payload:e.payload}):n(e)}function s(){X()||d(1,{error:"Offline. Please check your network settings. "}),timeout(s,SECOND)}function l(){en.time(function(e){h(function(){},e),e||d(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),timeout(l,y)})}function d(e,n){P&&P(e,n),P=null}function b(e){var n=rnow()-M;return n-e/1e4}function h(e,n){function t(n){if(n){var t=n/1e4,c=(rnow()-r)/2;M=rnow()-(t+c),e&&e(M)}}var r=rnow();n&&t(n)||en.time(t)}var p=+e.windowing||DEF_WINDOWING,g=(+e.timeout||DEF_SUB_TIMEOUT)*SECOND,y=(+e.keepalive||DEF_KEEPALIVE)*SECOND,v=e.noleave||0,E=e.publish_key||"demo",S=e.subscribe_key||"demo",_=e.auth_key||"",m=e.secret_key||"",k=e.PNSDK||"",C=e.hmac_SHA256,O=e.ssl?"s":"",N="http"+O+"://"+(e.origin||"pubsub.pubnub.com"),w=nextorigin(N),x=nextorigin(N),D=function(){},A=[],M=0,L=0,R=0,P=0,F=0,T=0,B=!1,U={},I={},H=null,j=n(e.heartbeat||e.pnexpires||0,e.error),K=e.heartbeat_interval||j-3,J=!1,G=e.no_wait_for_pending,Y=e["compatible_3.5"]||!1,V=e.xdr,W=e.error||function(){},X=e._is_online||function(){return 1},q=e.jsonp_cb||function(){return 0},z=e.db||{get:function(){},set:function(){}},Q=e.cipher_key,Z=e.uuid||z&&z.get(S+"uuid")||"",$=e.crypto_obj||{encrypt:function(e){return e},decrypt:function(e){return e}},en={LEAVE:function(e,n,t,r){var c={uuid:Z,auth:_},i=nextorigin(N),t=t||function(){},a=r||function(){},o=q();if(e.indexOf(PRESENCE_SUFFIX)>0)return!0;if(Y){if(!O)return!1;if("0"==o)return!1}return v?!1:("0"!=o&&(c.callback=o),V({blocking:n||O,timeout:2e3,callback:o,data:c,success:function(e){u(e,t,a)},fail:function(e){f(e,a)},url:[i,"v2","presence","sub_key",S,"channel",encode(e),"leave"]}),!0)},set_resumed:function(e){B=e},get_cipher_key:function(){return Q},set_cipher_key:function(e){Q=e},raw_encrypt:function(e,n){return t(e,n)},raw_decrypt:function(e,n){return r(e,n)},get_heartbeat:function(){return j},set_heartbeat:function(e){j=n(e,K,W),K=j-3>=1?j-3:1,D(),c()},get_heartbeat_interval:function(){return K},set_heartbeat_interval:function(e){K=e,c()},get_version:function(){return SDK_VER},history:function(e,n){var n=e.callback||n,t=e.count||e.limit||100,c=e.reverse||"false",i=e.error||function(){},a=e.auth_key||_,o=e.cipher_key,u=e.channel,s=e.start,l=e.end,d=e.include_token,b={},h=q();return u?n?S?(b.stringtoken="true",b.count=t,b.reverse=c,b.auth=a,h&&(b.callback=h),s&&(b.start=s),l&&(b.end=l),d&&(b.include_token="true"),V({callback:h,data:b,success:function(e){if("object"==typeof e&&e.error)return i({message:e.message,payload:e.payload}),void 0;for(var t=e[0],c=[],a=0;a<t.length;a++){var u=r(t[a],o);try{c.push(JSON.parse(u))}catch(f){c.push(u)}}n([c,e[1],e[2]])},fail:function(e){f(e,i)},url:[w,"v2","history","sub-key",S,"channel",encode(u)]}),void 0):W("Missing Subscribe Key"):W("Missing Callback"):W("Missing Channel")},replay:function(e,n){var t,n=n||e.callback||function(){},r=e.auth_key||_,c=e.source,i=e.destination,a=e.stop,o=e.start,f=e.end,s=e.reverse,l=e.limit,d=q(),b={};return c?i?E?S?("0"!=d&&(b.callback=d),a&&(b.stop="all"),s&&(b.reverse="true"),o&&(b.start=o),f&&(b.end=f),l&&(b.count=l),b.auth=r,t=[w,"v1","replay",E,S,c,i],V({callback:d,success:function(e){u(e,n,err)},fail:function(){n([0,"Disconnected"])},url:t,data:b}),void 0):W("Missing Subscribe Key"):W("Missing Publish Key"):W("Missing Destination Channel"):W("Missing Source Channel")},auth:function(e){_=e,D()},time:function(e){var n=q();V({callback:n,data:{uuid:Z,auth:_},timeout:5*SECOND,url:[w,"time",n],success:function(n){e(n[0])},fail:function(){e(0)}})},publish:function(e,n){var r,n=n||e.callback||function(){},c=e.message,i=e.channel,o=e.auth_key||_,s=e.cipher_key,l=e.error||function(){},d=q(),b="push";return e.prepend&&(b="unshift"),c?i?E?S?(c=JSON.stringify(t(c,s)),r=[w,"publish",E,S,0,encode(i),d,encode(c)],A[b]({callback:d,timeout:5*SECOND,url:r,data:{uuid:Z,auth:o},fail:function(e){f(e,l),a(1)},success:function(e){u(e,n,l),a(1)}}),a(),void 0):W("Missing Subscribe Key"):W("Missing Publish Key"):W("Missing Channel"):W("Missing Message")},unsubscribe:function(e,n){var t=e.channel,n=n||e.callback||function(){},r=e.error||function(){};T=0,F=1,t=map((t.join?t.join(","):""+t).split(","),function(e){return U[e]?e+","+e+PRESENCE_SUFFIX:void 0}).join(","),each(t.split(","),function(e){var t=!0;e&&(READY&&(t=en.LEAVE(e,0,n,r)),t||n({action:"leave"}),U[e]=0,e in I&&delete I[e])}),D()},subscribe:function(e,n){function t(e){e?timeout(D,SECOND):(w=nextorigin(N,1),x=nextorigin(N,1),timeout(function(){en.time(t)},SECOND)),o(function(n){return e&&n.disconnected?(n.disconnected=0,n.reconnect(n.name)):(e||n.disconnected||(n.disconnected=1,n.disconnect(n.name)),void 0)})}function c(){var e=q(),n=generate_channel_list(U).join(",");if(n){d();var a={uuid:Z,auth:u},s=JSON.stringify(I);s.length>2&&(a.state=JSON.stringify(I)),j&&(a.heartbeat=j),i(),P=V({timeout:O,callback:e,fail:function(e){f(e,y),en.time(t)},data:a,url:[x,"subscribe",S,encode(n),e,T],success:function(e){if(!e||"object"==typeof e&&"error"in e&&e.error)return y(e.error),timeout(D,SECOND);if(v(e[1]),T=!T&&F&&z.get(S)||e[1],o(function(e){e.connected||(e.connected=1,e.connect(e.name))}),B&&!F)return T=0,B=!1,z.set(S,0),timeout(c,A),void 0;k&&(T=1e4,k=0),z.set(S,e[1]);var n=function(){var n=e.length>2?e[2]:map(generate_channel_list(U),function(n){return map(Array(e[0].length).join(",").split(","),function(){return n})}).join(","),t=n.split(",");return function(){var e=t.shift()||R;return[(U[e]||{}).callback||L,e.split(PRESENCE_SUFFIX)[0]]}}(),t=b(+e[1]);each(e[0],function(c){var i=n(),a=r(c,U[i[1]].cipher_key);i[0](a,e,i[1],t)}),timeout(c,A)}})}}var a=e.channel,n=n||e.callback,n=n||e.message,u=e.auth_key||_,s=e.connect||function(){},l=e.reconnect||function(){},h=e.disconnect||function(){},y=e.error||function(){},v=e.idle||function(){},E=e.presence||0,m=e.noheresync||0,k=e.backfill||0,C=e.timetoken||0,O=e.timeout||g,A=e.windowing||p,M=e.state,H=e.heartbeat||e.pnexpires,K=e.restore;return F=K,T=C,a?n?S?((H||0===H)&&en.set_heartbeat(H),each((a.join?a.join(","):""+a).split(","),function(t){var r=U[t]||{};U[R=t]={name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:L=n,cipher_key:e.cipher_key,connect:s,disconnect:h,reconnect:l},M&&(I[t]=t in M?M[t]:M),E&&(en.subscribe({channel:t+PRESENCE_SUFFIX,callback:E,restore:K}),r.subscribed||m||en.here_now({channel:t,callback:function(e){each("uuids"in e?e.uuids:[],function(n){E({action:"join",uuid:n,timestamp:rnow(),occupancy:e.occupancy||1},e,t)})}}))}),D=function(){d(),timeout(c,A)},READY?(D(),void 0):READY_BUFFER.push(D)):W("Missing Subscribe Key"):W("Missing Callback"):W("Missing Channel")},here_now:function(e,n){var n=e.callback||n,t=e.error||function(){},r=e.auth_key||_,c=e.channel,i=q(),a="uuids"in e?e.uuids:!0,o=e.state,s={uuid:Z,auth:r};if(a||(s.disable_uuids=1),o&&(s.state=1),!n)return W("Missing Callback");if(!S)return W("Missing Subscribe Key");var l=[w,"v2","presence","sub_key",S];c&&l.push("channel")&&l.push(encode(c)),"0"!=i&&(s.callback=i),V({callback:i,data:s,success:function(e){u(e,n,t)},fail:function(e){f(e,t)},url:l})},where_now:function(e,n){var n=e.callback||n,t=e.error||function(){},r=e.auth_key||_,c=q(),i=e.uuid||Z,a={auth:r};return n?S?("0"!=c&&(a.callback=c),V({callback:c,data:a,success:function(e){u(e,n,t)},fail:function(e){f(e,t)},url:[w,"v2","presence","sub_key",S,"uuid",encode(i)]}),void 0):W("Missing Subscribe Key"):W("Missing Callback")},state:function(e,n){var t,n=e.callback||n||function(){},r=e.error||function(){},c=e.auth_key||_,i=q(),a=e.state,o=e.uuid||Z,s=e.channel,l={auth:c};return S?o?s?("0"!=i&&(l.callback=i),U[s]&&U[s].subscribed&&(I[s]=a),l.state=JSON.stringify(a),t=a?[w,"v2","presence","sub-key",S,"channel",encode(s),"uuid",o,"data"]:[w,"v2","presence","sub-key",S,"channel",encode(s),"uuid",encode(o)],V({callback:i,data:l,success:function(e){u(e,n,r)},fail:function(e){f(e,r)},url:t}),void 0):W("Missing Channel"):W("Missing UUID"):W("Missing Subscribe Key")},grant:function(e,n){var n=e.callback||n,t=e.error||function(){},r=e.channel,c=q(),i=e.ttl,a=e.read?"1":"0",o=e.write?"1":"0",s=e.auth_key;if(!r)return W("Missing Channel");if(!n)return W("Missing Callback");if(!S)return W("Missing Subscribe Key");if(!E)return W("Missing Publish Key");if(!m)return W("Missing Secret Key");var l=Math.floor((new Date).getTime()/1e3),d=S+"\n"+E+"\n"+"grant"+"\n";s&&(d+="auth="+encode(s)+"&"),"0"!=c&&(d+="callback="+encode(c)+"&"),r&&(d+="channel="+encode(r)+"&"),d+="pnsdk="+encode(k)+"&"+"r="+a+"&"+"timestamp="+encode(l),(i||0===i)&&(d+="&ttl="+i),d+="&w="+o;var b=C(d,m);b=b.replace(/\+/g,"-"),b=b.replace(/\//g,"_");var h={w:o,r:a,signature:b,channel:r,timestamp:l};"0"!=c&&(h.callback=c),(i||0===i)&&(h.ttl=i),s&&(h.auth=s),V({callback:c,data:h,success:function(e){u(e,n,t)},fail:function(e){f(e,t)},url:[w,"v1","auth","grant","sub-key",S]})},audit:function(e,n){var n=e.callback||n,t=e.error||function(){},r=e.channel,c=e.auth_key,i=q();if(!n)return W("Missing Callback");if(!S)return W("Missing Subscribe Key");if(!E)return W("Missing Publish Key");if(!m)return W("Missing Secret Key");var a=Math.floor((new Date).getTime()/1e3),o=S+"\n"+E+"\n"+"audit"+"\n";c&&(o+="auth="+encode(c)+"&"),"0"!=i&&(o+="callback="+encode(i)+"&"),r&&(o+="channel="+encode(r)+"&"),o+="pnsdk="+encode(k)+"&"+"timestamp="+a;var s=C(o,m);s=s.replace(/\+/g,"-"),s=s.replace(/\//g,"_");var l={signature:s,timestamp:a};"0"!=i&&(l.callback=i),r&&(l.channel=r),c&&(l.auth=c),V({callback:i,data:l,success:function(e){u(e,n,t)},fail:function(e){f(e,t)},url:[w,"v1","auth","audit","sub-key",S]})},revoke:function(e,n){e.read=!1,e.write=!1,en.grant(e,n)},set_uuid:function(e){Z=e,D()},get_uuid:function(){return Z},presence_heartbeat:function(e){var n=e.callback||function(){},t=e.error||function(){},r=q(),c={uuid:Z,auth:_},i=JSON.stringify(I);i.length>2&&(c.state=JSON.stringify(I)),j>0&&320>j&&(c.heartbeat=j),V({callback:r,data:c,timeout:5*SECOND,url:[w,"v2","presence","sub-key",S,"channel",encode(generate_channel_list(U,!0).join(",")),"heartbeat"],success:function(e){u(e,n,t)},fail:function(e){f(e,t)}})},xdr:V,ready:ready,db:z,uuid:uuid,map:map,each:each,"each-channel":o,grep:grep,offline:function(){d(1,{message:"Offline. Please check your network settings."})},supplant:supplant,now:rnow,unique:unique,updater:updater};return Z||(Z=en.uuid()),z.set(S+"uuid",Z),timeout(s,SECOND),timeout(l,y),H=timeout(i,(K-3)*SECOND),h(),en}function crypto_obj(){function e(e){function n(e,n){var t=(65535&e)+(65535&n),r=(e>>16)+(n>>16)+(t>>16);return r<<16|65535&t}function t(e,n){return e>>>n|e<<32-n}function r(e,n){return e>>>n}function c(e,n,t){return e&n^~e&t}function i(e,n,t){return e&n^e&t^n&t}function a(e){return t(e,2)^t(e,13)^t(e,22)}function o(e){return t(e,6)^t(e,11)^t(e,25)}function u(e){return t(e,7)^t(e,18)^r(e,3)}function f(e){return t(e,17)^t(e,19)^r(e,10)}function s(e,t){var r,s,l,d,b,h,p,g,y,v,E,S,_=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),m=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),k=new Array(64);e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var y=0;y<e.length;y+=16){r=m[0],s=m[1],l=m[2],d=m[3],b=m[4],h=m[5],p=m[6],g=m[7];for(var v=0;64>v;v++)k[v]=16>v?e[v+y]:n(n(n(f(k[v-2]),k[v-7]),u(k[v-15])),k[v-16]),E=n(n(n(n(g,o(b)),c(b,h,p)),_[v]),k[v]),S=n(a(r),i(r,s,l)),g=p,p=h,h=b,b=n(d,E),d=l,l=s,s=r,r=n(E,S);m[0]=n(r,m[0]),m[1]=n(s,m[1]),m[2]=n(l,m[2]),m[3]=n(d,m[3]),m[4]=n(b,m[4]),m[5]=n(h,m[5]),m[6]=n(p,m[6]),m[7]=n(g,m[7])}return m}function l(e){for(var n=Array(),t=(1<<h)-1,r=0;r<e.length*h;r+=h)n[r>>5]|=(e.charCodeAt(r/h)&t)<<24-r%32;return n}function d(e){e=e.replace(/\r\n/g,"\n");for(var n="",t=0;t<e.length;t++){var r=e.charCodeAt(t);128>r?n+=String.fromCharCode(r):r>127&&2048>r?(n+=String.fromCharCode(192|r>>6),n+=String.fromCharCode(128|63&r)):(n+=String.fromCharCode(224|r>>12),n+=String.fromCharCode(128|63&r>>6),n+=String.fromCharCode(128|63&r))}return n}function b(e){for(var n=p?"0123456789ABCDEF":"0123456789abcdef",t="",r=0;r<4*e.length;r++)t+=n.charAt(15&e[r>>2]>>8*(3-r%4)+4)+n.charAt(15&e[r>>2]>>8*(3-r%4));return t}var h=8,p=0;return e=d(e),b(s(l(e),e.length*h))}var n=CRYPTO;n.size(256);var t=n.s2a("0123456789012345");return{encrypt:function(r,c){if(!c)return r;var i=n.s2a(e(c).slice(0,32)),a=n.s2a(JSON.stringify(r)),o=n.rawEncrypt(a,i,t),u=n.Base64.encode(o);return u||r},decrypt:function(r,c){if(!c)return r;var i=n.s2a(e(c).slice(0,32));try{var a=n.Base64.decode(r),o=n.rawDecrypt(a,i,t,!1),u=JSON.parse(o);return u}catch(f){return void 0}}}}var NOW=1,READY=!1,READY_BUFFER=[],PRESENCE_SUFFIX="-pnpres",DEF_WINDOWING=10,DEF_TIMEOUT=1e4,DEF_SUB_TIMEOUT=310,DEF_KEEPALIVE=60,SECOND=1e3,URLBIT="/",PARAMSBIT="&",PRESENCE_HB_THRESHOLD=5,PRESENCE_HB_DEFAULT=30,SDK_VER="3.6.2",REPL=/{([\w\-]+)}/g,nextorigin=function(){var e=20,n=Math.floor(Math.random()*e);return function(t,r){return t.indexOf("pubsub.")>0&&t.replace("pubsub","ps"+(r?uuid().split("-")[0]:++n<e?n:n=1))||t}}(),CRYPTO=function(){var e=14,n=8,t=!1,r=function(e){try{return unescape(encodeURIComponent(e))}catch(n){throw"Error on UTF-8 encode"}},c=function(e){try{return decodeURIComponent(escape(e))}catch(n){throw"Bad Key"}},a=function(e){var n,t,r=[];for(e.length<16&&(n=16-e.length,r=[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n]),t=0;t<e.length;t++)r[t]=e[t];return r},o=function(e,n){var t,r,c="";if(n){if(t=e[15],t>16)throw"Decryption error: Maybe bad key";if(16==t)return"";for(r=0;16-t>r;r++)c+=String.fromCharCode(e[r])}else for(r=0;16>r;r++)c+=String.fromCharCode(e[r]);return c},u=function(e){var n,t="";for(n=0;n<e.length;n++)t+=(e[n]<16?"0":"")+e[n].toString(16);return t},f=function(e){var n=[];return e.replace(/(..)/g,function(e){n.push(parseInt(e,16))}),n},s=function(e,n){var t,c=[];for(n||(e=r(e)),t=0;t<e.length;t++)c[t]=e.charCodeAt(t);return c},l=function(t){switch(t){case 128:e=10,n=4;break;case 192:e=12,n=6;break;case 256:e=14,n=8;break;default:throw"Invalid Key Size Specified:"+t}},d=function(e){var n,t=[];for(n=0;e>n;n++)t=t.concat(Math.floor(256*Math.random()));return t},b=function(t,r){var c,i=e>=12?3:2,a=[],o=[],u=[],f=[],s=t.concat(r);for(u[0]=GibberishAES.Hash.MD5(s),f=u[0],c=1;i>c;c++)u[c]=GibberishAES.Hash.MD5(u[c-1].concat(s)),f=f.concat(u[c]);return a=f.slice(0,4*n),o=f.slice(4*n,4*n+16),{key:a,iv:o}},h=function(e,n,t){n=k(n);var r,c=Math.ceil(e.length/16),i=[],o=[];for(r=0;c>r;r++)i[r]=a(e.slice(16*r,16*r+16));for(0===e.length%16&&(i.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),c++),r=0;r<i.length;r++)i[r]=0===r?m(i[r],t):m(i[r],o[r-1]),o[r]=g(i[r],n);return o},p=function(e,n,t,r){n=k(n);var i,a=e.length/16,u=[],f=[],s="";for(i=0;a>i;i++)u.push(e.slice(16*i,16*(i+1)));for(i=u.length-1;i>=0;i--)f[i]=y(u[i],n),f[i]=0===i?m(f[i],t):m(f[i],u[i-1]);for(i=0;a-1>i;i++)s+=o(f[i]);return s+=o(f[i],!0),r?s:c(s)},g=function(n,r){t=!1;var c,i=_(n,r,0);for(c=1;e+1>c;c++)i=v(i),i=E(i),e>c&&(i=S(i)),i=_(i,r,c);return i},y=function(n,r){t=!0;var c,i=_(n,r,e);for(c=e-1;c>-1;c--)i=E(i),i=v(i),i=_(i,r,c),c>0&&(i=S(i));return i},v=function(e){var n,r=t?M:A,c=[];for(n=0;16>n;n++)c[n]=r[e[n]];return c},E=function(e){var n,r=[],c=t?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11];for(n=0;16>n;n++)r[n]=e[c[n]];return r},S=function(e){var n,r=[];if(t)for(n=0;4>n;n++)r[4*n]=U[e[4*n]]^T[e[1+4*n]]^B[e[2+4*n]]^F[e[3+4*n]],r[1+4*n]=F[e[4*n]]^U[e[1+4*n]]^T[e[2+4*n]]^B[e[3+4*n]],r[2+4*n]=B[e[4*n]]^F[e[1+4*n]]^U[e[2+4*n]]^T[e[3+4*n]],r[3+4*n]=T[e[4*n]]^B[e[1+4*n]]^F[e[2+4*n]]^U[e[3+4*n]];else for(n=0;4>n;n++)r[4*n]=R[e[4*n]]^P[e[1+4*n]]^e[2+4*n]^e[3+4*n],r[1+4*n]=e[4*n]^R[e[1+4*n]]^P[e[2+4*n]]^e[3+4*n],r[2+4*n]=e[4*n]^e[1+4*n]^R[e[2+4*n]]^P[e[3+4*n]],r[3+4*n]=P[e[4*n]]^e[1+4*n]^e[2+4*n]^R[e[3+4*n]];return r},_=function(e,n,t){var r,c=[];for(r=0;16>r;r++)c[r]=e[r]^n[t][r];return c},m=function(e,n){var t,r=[];for(t=0;16>t;t++)r[t]=e[t]^n[t];return r},k=function(t){var r,c,i,a,o=[],u=[],f=[];for(r=0;n>r;r++)c=[t[4*r],t[4*r+1],t[4*r+2],t[4*r+3]],o[r]=c;for(r=n;4*(e+1)>r;r++){for(o[r]=[],i=0;4>i;i++)u[i]=o[r-1][i];for(0===r%n?(u=C(O(u)),u[0]^=L[r/n-1]):n>6&&4==r%n&&(u=C(u)),i=0;4>i;i++)o[r][i]=o[r-n][i]^u[i]}for(r=0;e+1>r;r++)for(f[r]=[],a=0;4>a;a++)f[r].push(o[4*r+a][0],o[4*r+a][1],o[4*r+a][2],o[4*r+a][3]);return f},C=function(e){for(var n=0;4>n;n++)e[n]=A[e[n]];return e},O=function(e){var n,t=e[0];for(n=0;4>n;n++)e[n]=e[n+1];return e[3]=t,e},N=function(e,n){var t=[];for(i=0;i<e.length;i+=n)t[i/n]=parseInt(e.substr(i,n),16);return t},w=function(e){var n=[];for(i=0;i<e.length;i++)n[e[i]]=i;return n},x=function(e,n){var t,r;for(r=0,t=0;8>t;t++)r=1==(1&n)?r^e:r,e=e>127?283^e<<1:e<<1,n>>>=1;return r},D=function(e){for(var n=[],t=0;256>t;t++)n[t]=x(e,t);return n},A=N("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",2),M=w(A),L=N("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),R=D(2),P=D(3),F=D(9),T=D(11),B=D(13),U=D(14),I=function(e,n,t){var r,c=d(8),i=b(s(n,t),c),a=i.key,o=i.iv,u=[[83,97,108,116,101,100,95,95].concat(c)];return e=s(e,t),r=h(e,a,o),r=u.concat(r),K.encode(r)},H=function(e,n,t){var r=K.decode(e),c=r.slice(8,16),i=b(s(n,t),c),a=i.key,o=i.iv;return r=r.slice(16,r.length),e=p(r,a,o,t)},j=function(e){function n(e,n){return e<<n|e>>>32-n}function t(e,n){var t,r,c,i,a;return c=2147483648&e,i=2147483648&n,t=1073741824&e,r=1073741824&n,a=(1073741823&e)+(1073741823&n),t&r?2147483648^a^c^i:t|r?1073741824&a?3221225472^a^c^i:1073741824^a^c^i:a^c^i}function r(e,n,t){return e&n|~e&t}function c(e,n,t){return e&t|n&~t}function i(e,n,t){return e^n^t}function a(e,n,t){return n^(e|~t)}function o(e,c,i,a,o,u,f){return e=t(e,t(t(r(c,i,a),o),f)),t(n(e,u),c)}function u(e,r,i,a,o,u,f){return e=t(e,t(t(c(r,i,a),o),f)),t(n(e,u),r)}function f(e,r,c,a,o,u,f){return e=t(e,t(t(i(r,c,a),o),f)),t(n(e,u),r)}function s(e,r,c,i,o,u,f){return e=t(e,t(t(a(r,c,i),o),f)),t(n(e,u),r)}function l(e){for(var n,t=e.length,r=t+8,c=(r-r%64)/64,i=16*(c+1),a=[],o=0,u=0;t>u;)n=(u-u%4)/4,o=8*(u%4),a[n]=a[n]|e[u]<<o,u++;return n=(u-u%4)/4,o=8*(u%4),a[n]=a[n]|128<<o,a[i-2]=t<<3,a[i-1]=t>>>29,a}function d(e){var n,t,r=[];for(t=0;3>=t;t++)n=255&e>>>8*t,r=r.concat(n);return r}var b,h,p,g,y,v,E,S,_,m=[],k=N("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",8);for(m=l(e),v=k[0],E=k[1],S=k[2],_=k[3],b=0;b<m.length;b+=16)h=v,p=E,g=S,y=_,v=o(v,E,S,_,m[b+0],7,k[4]),_=o(_,v,E,S,m[b+1],12,k[5]),S=o(S,_,v,E,m[b+2],17,k[6]),E=o(E,S,_,v,m[b+3],22,k[7]),v=o(v,E,S,_,m[b+4],7,k[8]),_=o(_,v,E,S,m[b+5],12,k[9]),S=o(S,_,v,E,m[b+6],17,k[10]),E=o(E,S,_,v,m[b+7],22,k[11]),v=o(v,E,S,_,m[b+8],7,k[12]),_=o(_,v,E,S,m[b+9],12,k[13]),S=o(S,_,v,E,m[b+10],17,k[14]),E=o(E,S,_,v,m[b+11],22,k[15]),v=o(v,E,S,_,m[b+12],7,k[16]),_=o(_,v,E,S,m[b+13],12,k[17]),S=o(S,_,v,E,m[b+14],17,k[18]),E=o(E,S,_,v,m[b+15],22,k[19]),v=u(v,E,S,_,m[b+1],5,k[20]),_=u(_,v,E,S,m[b+6],9,k[21]),S=u(S,_,v,E,m[b+11],14,k[22]),E=u(E,S,_,v,m[b+0],20,k[23]),v=u(v,E,S,_,m[b+5],5,k[24]),_=u(_,v,E,S,m[b+10],9,k[25]),S=u(S,_,v,E,m[b+15],14,k[26]),E=u(E,S,_,v,m[b+4],20,k[27]),v=u(v,E,S,_,m[b+9],5,k[28]),_=u(_,v,E,S,m[b+14],9,k[29]),S=u(S,_,v,E,m[b+3],14,k[30]),E=u(E,S,_,v,m[b+8],20,k[31]),v=u(v,E,S,_,m[b+13],5,k[32]),_=u(_,v,E,S,m[b+2],9,k[33]),S=u(S,_,v,E,m[b+7],14,k[34]),E=u(E,S,_,v,m[b+12],20,k[35]),v=f(v,E,S,_,m[b+5],4,k[36]),_=f(_,v,E,S,m[b+8],11,k[37]),S=f(S,_,v,E,m[b+11],16,k[38]),E=f(E,S,_,v,m[b+14],23,k[39]),v=f(v,E,S,_,m[b+1],4,k[40]),_=f(_,v,E,S,m[b+4],11,k[41]),S=f(S,_,v,E,m[b+7],16,k[42]),E=f(E,S,_,v,m[b+10],23,k[43]),v=f(v,E,S,_,m[b+13],4,k[44]),_=f(_,v,E,S,m[b+0],11,k[45]),S=f(S,_,v,E,m[b+3],16,k[46]),E=f(E,S,_,v,m[b+6],23,k[47]),v=f(v,E,S,_,m[b+9],4,k[48]),_=f(_,v,E,S,m[b+12],11,k[49]),S=f(S,_,v,E,m[b+15],16,k[50]),E=f(E,S,_,v,m[b+2],23,k[51]),v=s(v,E,S,_,m[b+0],6,k[52]),_=s(_,v,E,S,m[b+7],10,k[53]),S=s(S,_,v,E,m[b+14],15,k[54]),E=s(E,S,_,v,m[b+5],21,k[55]),v=s(v,E,S,_,m[b+12],6,k[56]),_=s(_,v,E,S,m[b+3],10,k[57]),S=s(S,_,v,E,m[b+10],15,k[58]),E=s(E,S,_,v,m[b+1],21,k[59]),v=s(v,E,S,_,m[b+8],6,k[60]),_=s(_,v,E,S,m[b+15],10,k[61]),S=s(S,_,v,E,m[b+6],15,k[62]),E=s(E,S,_,v,m[b+13],21,k[63]),v=s(v,E,S,_,m[b+4],6,k[64]),_=s(_,v,E,S,m[b+11],10,k[65]),S=s(S,_,v,E,m[b+2],15,k[66]),E=s(E,S,_,v,m[b+9],21,k[67]),v=t(v,h),E=t(E,p),S=t(S,g),_=t(_,y);return d(v).concat(d(E),d(S),d(_))},K=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=e.split(""),t=function(e){var t,r,c=[],i="";for(Math.floor(16*e.length/3),t=0;t<16*e.length;t++)c.push(e[Math.floor(t/16)][t%16]);for(t=0;t<c.length;t+=3)i+=n[c[t]>>2],i+=n[(3&c[t])<<4|c[t+1]>>4],i+=void 0!==c[t+1]?n[(15&c[t+1])<<2|c[t+2]>>6]:"=",i+=void 0!==c[t+2]?n[63&c[t+2]]:"=";for(r=i.slice(0,64),t=1;t<Math.ceil(i.length/64);t++)r+=i.slice(64*t,64*t+64)+(Math.ceil(i.length/64)==t+1?"":"\n");return r},r=function(n){n=n.replace(/\n/g,"");var t,r=[],c=[],i=[];for(t=0;t<n.length;t+=4)c[0]=e.indexOf(n.charAt(t)),c[1]=e.indexOf(n.charAt(t+1)),c[2]=e.indexOf(n.charAt(t+2)),c[3]=e.indexOf(n.charAt(t+3)),i[0]=c[0]<<2|c[1]>>4,i[1]=(15&c[1])<<4|c[2]>>2,i[2]=(3&c[2])<<6|c[3],r.push(i[0],i[1],i[2]);return r=r.slice(0,r.length-r.length%16)};return"function"==typeof Array.indexOf&&(e=n),{encode:t,decode:r}}();return{size:l,h2a:f,expandKey:k,encryptBlock:g,decryptBlock:y,Decrypt:t,s2a:s,rawEncrypt:h,rawDecrypt:p,dec:H,openSSLKey:b,a2h:u,enc:I,Hash:{MD5:j},Base64:K}}();!function(){function e(n){var t,r=function(){if(!i){i=1,clearTimeout(a);try{response=JSON.parse(t.responseText)}catch(e){return b(1)}f(response)}},c=0,i=0,a=timeout(function(){b(1)},l),o=n.data||{},u=n.fail||function(){},f=n.success||function(){},d="undefined"==typeof n.blocking,b=function(e,n){c||(c=1,clearTimeout(a),t&&(t.onerror=t.onload=null,t.abort&&t.abort(),t=null),e&&u(n))};try{t="undefined"!=typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest,t.onerror=t.onabort=function(){b(1,t.responseText||{error:"Network Connection Error"})},t.onload=t.onloadend=r,t.onreadystatechange=function(){if(4==t.readyState)switch(t.status){case 401:case 402:case 403:try{response=JSON.parse(t.responseText),b(1,response)}catch(e){return b(1,t.responseText)}}},d&&(t.timeout=l),o.pnsdk=s,url=build_url(n.url,o),t.open("GET",url,d),t.send()}catch(h){return b(0),e(n)}return b}function n(e,n,t){each(e.split(","),function(e){var r=function(e){e||(e=window.event),t(e)||(e.cancelBubble=!0,e.returnValue=!1,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())};n.addEventListener?n.addEventListener(e,r,!1):n.attachEvent?n.attachEvent("on"+e,r):n["on"+e]=r})}function t(e){console.error(e)}function r(e,n,t){return t?(e.setAttribute(n,t),void 0):e&&e.getAttribute&&e.getAttribute(n)}function c(e){return document.getElementById(e)}function i(e,n){var t=[];return each(e.split(/\s+/),function(e){each((n||document).getElementsByTagName(e),function(e){t.push(e)})}),t}function a(e,n){for(var t in n)if(n.hasOwnProperty(t))try{e.style[t]=n[t]+("|width|height|top|left|".indexOf(t)>0&&"number"==typeof n[t]?"px":"")}catch(r){}}function o(e){return document.createElement(e)}function u(e,n){var t=CryptoJS.HmacSHA256(e,n);return t.toString(CryptoJS.enc.Base64)}function f(l){l.db=d,l.xdr=e,l.error=l.error||t,l.PNSDK=s,l.hmac_SHA256=u,l.crypto_obj=crypto_obj(),SELF=function(e){return f(e)};var b=PN_API(l);for(var h in b)b.hasOwnProperty(h)&&(SELF[h]=b[h]);return SELF.init=SELF,SELF.$=c,SELF.attr=r,SELF.search=i,SELF.bind=n,SELF.css=a,SELF.create=o,"undefined"!=typeof window&&n("beforeunload",window,function(){return SELF["each-channel"](function(e){SELF.LEAVE(e.name,1)}),!0}),l.notest?SELF:("undefined"!=typeof window&&n("offline",window,SELF._reset_offline),"undefined"!=typeof document&&n("offline",document,SELF._reset_offline),SELF.ready(),SELF)}var s="PubNub-JS-Modern/3.6.2",l=31e4,d=function(){var e="undefined"!=typeof localStorage&&localStorage;return{get:function(n){try{return e?e.getItem(n):-1==document.cookie.indexOf(n)?null:((document.cookie||"").match(RegExp(n+"=([^;]+)"))||[])[1]||null}catch(t){return}},set:function(n,t){try{if(e)return e.setItem(n,t)&&0;document.cookie=n+"="+t+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(r){return}}}}();f.init=f,f.secure=f,PUBNUB=f({}),"undefined"!=typeof module&&(module.exports=f)||"undefined"!=typeof exports&&(exports.PUBNUB=f)||(PUBNUB=f)}(),function(){var e=PUBNUB.ws=function(n,t){if(!(this instanceof e))return new e(n,t);var r=this,n=r.url=n||"",c=(r.protocol=t||"Sec-WebSocket-Protocol",n.split("/")),i={ssl:"wss:"===c[0],origin:c[2],publish_key:c[3],subscribe_key:c[4],channel:c[5]};return r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.CLOSED=3,r.CLOSE_NORMAL=1e3,r.CLOSE_GOING_AWAY=1001,r.CLOSE_PROTOCOL_ERROR=1002,r.CLOSE_UNSUPPORTED=1003,r.CLOSE_TOO_LARGE=1004,r.CLOSE_NO_STATUS=1005,r.CLOSE_ABNORMAL=1006,r.onclose=r.onerror=r.onmessage=r.onopen=r.onsend=function(){},r.binaryType="",r.extensions="",r.bufferedAmount=0,r.trasnmitting=!1,r.buffer=[],r.readyState=r.CONNECTING,n?(r.pubnub=PUBNUB.init(i),r.pubnub.setup=i,r.setup=i,r.pubnub.subscribe({restore:!1,channel:i.channel,disconnect:r.onerror,reconnect:r.onopen,error:function(){r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(e){r.onmessage({data:e})},connect:function(){r.readyState=r.OPEN,r.onopen()}}),void 0):(r.readyState=r.CLOSED,r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),r)};e.prototype.send=function(e){var n=this;n.pubnub.publish({channel:n.pubnub.setup.channel,message:e,callback:function(e){n.onsend({data:e})}})},e.prototype.close=function(){var e=this;e.pubnub.unsubscribe({channel:e.pubnub.setup.channel}),e.readyState=e.CLOSED,e.onclose({})}}();
},{}]},{},[8])
(8)
});

//# sourceMappingURL=WebP2P.map