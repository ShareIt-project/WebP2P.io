!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.WebP2Pio=e():"undefined"!=typeof global?global.WebP2Pio=e():"undefined"!=typeof self&&(self.WebP2Pio=e())}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function WebP2P(n){function e(){"disconnected"==o.status&&o.dispatchEvent(new Event("disconnected"))}function t(n,e,t,o){var c=!1,a=s.get(n);a||(c=!0,a=s.create(n,e,this.routingLabel)),t=r.concat(t);for(var i,d=0;i=t[d];d++){var f=a.channels[i];if(!f){c=!0,a.channels[i]=f=a.createDataChannel(i);var u=new Event("datachannel");u.channel=f,a.dispatchEvent(u)}}if(c){var l={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};a.createOffer(function(e){a.setLocalDescription(e,function(){console.log("Generated Offer LocalDescription for UID "+n),o&&o(null,a)},o)},o,l)}else o&&o(null,a)}var o=this,c=function d(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,d)},n=n||{},r=n.commonLabels||[],a=n.handshake_servers;n.stun_server||"stun.l.google.com:19302",Object.defineProperty(this,"routingLabel",{value:n.routingLabel||"webp2p"}),Object.defineProperty(this,"uid",{value:n.uid||c()}),this.__defineGetter__("status",function(){return"connected"==s.status?"connected":i.status}),this.connectTo=function(e,o,c){if("function"==typeof o){if(c)throw SyntaxError("Nothing can be defined after the callback");c=n,o=[]}t(e,null,o,c)};var i=new HandshakeManager(this.uid);a&&(a instanceof Array?i.addConfigs_byArray(a):i.addConfigs_byUri(a)),i.onconnected=function(n){n.connector;var e=new Event("connected");e.uid=o.uid,o.dispatchEvent(e)},i.onpresence=function(n){var e=n.from,o=n.connector;t(e,o,[],function(n){n?console.error(e,o,n):(o.connections++,o.connections==o.max_connections&&o.close())})},i.onforward=function(n){s.forward(n.message,n.connector)},i.ondisconnected=function(){var n=document.createEvent("Event");n.initEvent("handshakeManager.disconnected",!0,!0),n.handshakeManager=i,o.dispatchEvent(n),e()},i.onerror=function(n){o.dispatchEvent(n)};var s=new PeersManager;s.onconnected=function(){},s.onforward=function(){},s.ondisconnected=function(){},s.onerror=function(n){o.dispatchEvent(n)},this.close=function(){i.close(),s.close()},window&&window.addEventListener("beforeunload",function(){o.close()})}WebP2P.prototype.__proto__=EventTarget.prototype,WebP2P.prototype.constructor=WebP2P,exports.WebP2P=WebP2P;
},{}]},{},[1])
(1)
});
;
//# sourceMappingURL=WebP2P.io.map